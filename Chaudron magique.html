<!DOCTYPE html>
<html class="init-no-js">
<head>
<meta charset="UTF-8" />
<title>Chaudron magique</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!--

SugarCube (v2.10.0): A free (gratis and libre) story format, based on TiddlyWiki.

Copyright © 2013–2016 Thomas Michael Edwards <tmedwards@motoslave.net>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<script id="script-libraries" type="text/javascript">
if(document.head&&document.addEventListener&&document.querySelector&&Object.create&&Object.freeze&&JSON){document.documentElement.className="init-loading";
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */
if("document" in self){if(!("classList" in document.createElement("_"))){(function(j){"use strict";if(!("Element" in j)){return}var a="classList",f="prototype",m=j.Element[f],b=Object,k=String[f].trim||function(){return this.replace(/^\s+|\s+$/g,"")},c=Array[f].indexOf||function(q){var p=0,o=this.length;for(;p<o;p++){if(p in this&&this[p]===q){return p}}return -1},n=function(o,p){this.name=o;this.code=DOMException[o];this.message=p},g=function(p,o){if(o===""){throw new n("SYNTAX_ERR","An invalid or illegal string was specified")}if(/\s/.test(o)){throw new n("INVALID_CHARACTER_ERR","String contains an invalid character")}return c.call(p,o)},d=function(s){var r=k.call(s.getAttribute("class")||""),q=r?r.split(/\s+/):[],p=0,o=q.length;for(;p<o;p++){this.push(q[p])}this._updateClassName=function(){s.setAttribute("class",this.toString())}},e=d[f]=[],i=function(){return new d(this)};n[f]=Error[f];e.item=function(o){return this[o]||null};e.contains=function(o){o+="";return g(this,o)!==-1};e.add=function(){var s=arguments,r=0,p=s.length,q,o=false;do{q=s[r]+"";if(g(this,q)===-1){this.push(q);o=true}}while(++r<p);if(o){this._updateClassName()}};e.remove=function(){var t=arguments,s=0,p=t.length,r,o=false,q;do{r=t[s]+"";q=g(this,r);while(q!==-1){this.splice(q,1);o=true;q=g(this,r)}}while(++s<p);if(o){this._updateClassName()}};e.toggle=function(p,q){p+="";var o=this.contains(p),r=o?q!==true&&"remove":q!==false&&"add";if(r){this[r](p)}if(q===true||q===false){return q}else{return !o}};e.toString=function(){return this.join(" ")};if(b.defineProperty){var l={get:i,enumerable:true,configurable:true};try{b.defineProperty(m,a,l)}catch(h){if(h.number===-2146823252){l.enumerable=false;b.defineProperty(m,a,l)}}}else{if(b[f].__defineGetter__){m.__defineGetter__(a,i)}}}(self))}else{(function(){var b=document.createElement("_");b.classList.add("c1","c2");if(!b.classList.contains("c2")){var c=function(e){var d=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(h){var g,f=arguments.length;for(g=0;g<f;g++){h=arguments[g];d.call(this,h)}}};c("add");c("remove")}b.classList.toggle("c3",false);if(b.classList.contains("c3")){var a=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(d,e){if(1 in arguments&&!this.contains(d)===!e){return e}else{return a.call(this,d)}}}b=null}())}};
/*!
 * https://github.com/es-shims/es5-shim
 * @license es5-shim Copyright 2009-2015 by contributors, MIT License
 * see https://github.com/es-shims/es5-shim/blob/v4.5.9/LICENSE
 */
(function(t,r){"use strict";if(typeof define==="function"&&define.amd){define(r)}else if(typeof exports==="object"){module.exports=r()}else{t.returnExports=r()}})(this,function(){var t=Array;var r=t.prototype;var e=Object;var n=e.prototype;var i=Function;var a=i.prototype;var o=String;var f=o.prototype;var u=Number;var l=u.prototype;var s=r.slice;var c=r.splice;var v=r.push;var h=r.unshift;var p=r.concat;var y=r.join;var d=a.call;var g=a.apply;var w=Math.max;var b=Math.min;var T=n.toString;var m=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";var D;var S=Function.prototype.toString,x=/^\s*class /,O=function isES6ClassFn(t){try{var r=S.call(t);var e=r.replace(/\/\/.*\n/g,"");var n=e.replace(/\/\*[.\s\S]*\*\//g,"");var i=n.replace(/\n/gm," ").replace(/ {2}/g," ");return x.test(i)}catch(a){return false}},j=function tryFunctionObject(t){try{if(O(t)){return false}S.call(t);return true}catch(r){return false}},E="[object Function]",I="[object GeneratorFunction]",D=function isCallable(t){if(!t){return false}if(typeof t!=="function"&&typeof t!=="object"){return false}if(m){return j(t)}if(O(t)){return false}var r=T.call(t);return r===E||r===I};var M;var U=RegExp.prototype.exec,F=function tryRegexExec(t){try{U.call(t);return true}catch(r){return false}},N="[object RegExp]";M=function isRegex(t){if(typeof t!=="object"){return false}return m?F(t):T.call(t)===N};var C;var k=String.prototype.valueOf,A=function tryStringObject(t){try{k.call(t);return true}catch(r){return false}},R="[object String]";C=function isString(t){if(typeof t==="string"){return true}if(typeof t!=="object"){return false}return m?A(t):T.call(t)===R};var P=e.defineProperty&&function(){try{var t={};e.defineProperty(t,"x",{enumerable:false,value:t});for(var r in t){return false}return t.x===t}catch(n){return false}}();var $=function(t){var r;if(P){r=function(t,r,n,i){if(!i&&r in t){return}e.defineProperty(t,r,{configurable:true,enumerable:false,writable:true,value:n})}}else{r=function(t,r,e,n){if(!n&&r in t){return}t[r]=e}}return function defineProperties(e,n,i){for(var a in n){if(t.call(n,a)){r(e,a,n[a],i)}}}}(n.hasOwnProperty);var J=function isPrimitive(t){var r=typeof t;return t===null||r!=="object"&&r!=="function"};var Y=u.isNaN||function isActualNaN(t){return t!==t};var Z={ToInteger:function ToInteger(t){var r=+t;if(Y(r)){r=0}else if(r!==0&&r!==1/0&&r!==-(1/0)){r=(r>0||-1)*Math.floor(Math.abs(r))}return r},ToPrimitive:function ToPrimitive(t){var r,e,n;if(J(t)){return t}e=t.valueOf;if(D(e)){r=e.call(t);if(J(r)){return r}}n=t.toString;if(D(n)){r=n.call(t);if(J(r)){return r}}throw new TypeError},ToObject:function(t){if(t==null){throw new TypeError("can't convert "+t+" to object")}return e(t)},ToUint32:function ToUint32(t){return t>>>0}};var z=function Empty(){};$(a,{bind:function bind(t){var r=this;if(!D(r)){throw new TypeError("Function.prototype.bind called on incompatible "+r)}var n=s.call(arguments,1);var a;var o=function(){if(this instanceof a){var i=g.call(r,this,p.call(n,s.call(arguments)));if(e(i)===i){return i}return this}else{return g.call(r,t,p.call(n,s.call(arguments)))}};var f=w(0,r.length-n.length);var u=[];for(var l=0;l<f;l++){v.call(u,"$"+l)}a=i("binder","return function ("+y.call(u,",")+"){ return binder.apply(this, arguments); }")(o);if(r.prototype){z.prototype=r.prototype;a.prototype=new z;z.prototype=null}return a}});var G=d.bind(n.hasOwnProperty);var B=d.bind(n.toString);var H=d.bind(s);var W=g.bind(s);var L=d.bind(f.slice);var X=d.bind(f.split);var q=d.bind(f.indexOf);var K=d.bind(v);var Q=d.bind(n.propertyIsEnumerable);var V=d.bind(r.sort);var _=t.isArray||function isArray(t){return B(t)==="[object Array]"};var tt=[].unshift(0)!==1;$(r,{unshift:function(){h.apply(this,arguments);return this.length}},tt);$(t,{isArray:_});var rt=e("a");var et=rt[0]!=="a"||!(0 in rt);var nt=function properlyBoxed(t){var r=true;var e=true;var n=false;if(t){try{t.call("foo",function(t,e,n){if(typeof n!=="object"){r=false}});t.call([1],function(){"use strict";e=typeof this==="string"},"x")}catch(i){n=true}}return!!t&&!n&&r&&e};$(r,{forEach:function forEach(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=-1;var i=Z.ToUint32(e.length);var a;if(arguments.length>1){a=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.forEach callback must be a function")}while(++n<i){if(n in e){if(typeof a==="undefined"){t(e[n],n,r)}else{t.call(a,e[n],n,r)}}}}},!nt(r.forEach));$(r,{map:function map(r){var e=Z.ToObject(this);var n=et&&C(this)?X(this,""):e;var i=Z.ToUint32(n.length);var a=t(i);var o;if(arguments.length>1){o=arguments[1]}if(!D(r)){throw new TypeError("Array.prototype.map callback must be a function")}for(var f=0;f<i;f++){if(f in n){if(typeof o==="undefined"){a[f]=r(n[f],f,e)}else{a[f]=r.call(o,n[f],f,e)}}}return a}},!nt(r.map));$(r,{filter:function filter(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=Z.ToUint32(e.length);var i=[];var a;var o;if(arguments.length>1){o=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.filter callback must be a function")}for(var f=0;f<n;f++){if(f in e){a=e[f];if(typeof o==="undefined"?t(a,f,r):t.call(o,a,f,r)){K(i,a)}}}return i}},!nt(r.filter));$(r,{every:function every(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=Z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.every callback must be a function")}for(var a=0;a<n;a++){if(a in e&&!(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return false}}return true}},!nt(r.every));$(r,{some:function some(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=Z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.some callback must be a function")}for(var a=0;a<n;a++){if(a in e&&(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return true}}return false}},!nt(r.some));var it=false;if(r.reduce){it=typeof r.reduce.call("es5",function(t,r,e,n){return n})==="object"}$(r,{reduce:function reduce(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=Z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduce callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduce of empty array with no initial value")}var i=0;var a;if(arguments.length>=2){a=arguments[1]}else{do{if(i in e){a=e[i++];break}if(++i>=n){throw new TypeError("reduce of empty array with no initial value")}}while(true)}for(;i<n;i++){if(i in e){a=t(a,e[i],i,r)}}return a}},!it);var at=false;if(r.reduceRight){at=typeof r.reduceRight.call("es5",function(t,r,e,n){return n})==="object"}$(r,{reduceRight:function reduceRight(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=Z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduceRight callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduceRight of empty array with no initial value")}var i;var a=n-1;if(arguments.length>=2){i=arguments[1]}else{do{if(a in e){i=e[a--];break}if(--a<0){throw new TypeError("reduceRight of empty array with no initial value")}}while(true)}if(a<0){return i}do{if(a in e){i=t(i,e[a],a,r)}}while(a--);return i}},!at);var ot=r.indexOf&&[0,1].indexOf(1,2)!==-1;$(r,{indexOf:function indexOf(t){var r=et&&C(this)?X(this,""):Z.ToObject(this);var e=Z.ToUint32(r.length);if(e===0){return-1}var n=0;if(arguments.length>1){n=Z.ToInteger(arguments[1])}n=n>=0?n:w(0,e+n);for(;n<e;n++){if(n in r&&r[n]===t){return n}}return-1}},ot);var ft=r.lastIndexOf&&[0,1].lastIndexOf(0,-3)!==-1;$(r,{lastIndexOf:function lastIndexOf(t){var r=et&&C(this)?X(this,""):Z.ToObject(this);var e=Z.ToUint32(r.length);if(e===0){return-1}var n=e-1;if(arguments.length>1){n=b(n,Z.ToInteger(arguments[1]))}n=n>=0?n:e-Math.abs(n);for(;n>=0;n--){if(n in r&&t===r[n]){return n}}return-1}},ft);var ut=function(){var t=[1,2];var r=t.splice();return t.length===2&&_(r)&&r.length===0}();$(r,{splice:function splice(t,r){if(arguments.length===0){return[]}else{return c.apply(this,arguments)}}},!ut);var lt=function(){var t={};r.splice.call(t,0,0,1);return t.length===1}();$(r,{splice:function splice(t,r){if(arguments.length===0){return[]}var e=arguments;this.length=w(Z.ToInteger(this.length),0);if(arguments.length>0&&typeof r!=="number"){e=H(arguments);if(e.length<2){K(e,this.length-t)}else{e[1]=Z.ToInteger(r)}}return c.apply(this,e)}},!lt);var st=function(){var r=new t(1e5);r[8]="x";r.splice(1,1);return r.indexOf("x")===7}();var ct=function(){var t=256;var r=[];r[t]="a";r.splice(t+1,0,"b");return r[t]==="a"}();$(r,{splice:function splice(t,r){var e=Z.ToObject(this);var n=[];var i=Z.ToUint32(e.length);var a=Z.ToInteger(t);var f=a<0?w(i+a,0):b(a,i);var u=b(w(Z.ToInteger(r),0),i-f);var l=0;var s;while(l<u){s=o(f+l);if(G(e,s)){n[l]=e[s]}l+=1}var c=H(arguments,2);var v=c.length;var h;if(v<u){l=f;var p=i-u;while(l<p){s=o(l+u);h=o(l+v);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l+=1}l=i;var y=i-u+v;while(l>y){delete e[l-1];l-=1}}else if(v>u){l=i-u;while(l>f){s=o(l+u-1);h=o(l+v-1);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l-=1}}l=f;for(var d=0;d<c.length;++d){e[l]=c[d];l+=1}e.length=i-u+v;return n}},!st||!ct);var vt=r.join;var ht;try{ht=Array.prototype.join.call("123",",")!=="1,2,3"}catch(pt){ht=true}if(ht){$(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return vt.call(C(this)?X(this,""):this,r)}},ht)}var yt=[1,2].join(undefined)!=="1,2";if(yt){$(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return vt.call(this,r)}},yt)}var dt=function push(t){var r=Z.ToObject(this);var e=Z.ToUint32(r.length);var n=0;while(n<arguments.length){r[e+n]=arguments[n];n+=1}r.length=e+n;return e+n};var gt=function(){var t={};var r=Array.prototype.push.call(t,undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();$(r,{push:function push(t){if(_(this)){return v.apply(this,arguments)}return dt.apply(this,arguments)}},gt);var wt=function(){var t=[];var r=t.push(undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();$(r,{push:dt},wt);$(r,{slice:function(t,r){var e=C(this)?X(this,""):this;return W(e,arguments)}},et);var bt=function(){try{[1,2].sort(null);[1,2].sort({});return true}catch(t){}return false}();var Tt=function(){try{[1,2].sort(/a/);return false}catch(t){}return true}();var mt=function(){try{[1,2].sort(undefined);return true}catch(t){}return false}();$(r,{sort:function sort(t){if(typeof t==="undefined"){return V(this)}if(!D(t)){throw new TypeError("Array.prototype.sort callback must be a function")}return V(this,t)}},bt||!mt||!Tt);var Dt=!Q({toString:null},"toString");var St=Q(function(){},"prototype");var xt=!G("x","0");var Ot=function(t){var r=t.constructor;return r&&r.prototype===t};var jt={$window:true,$console:true,$parent:true,$self:true,$frame:true,$frames:true,$frameElement:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$external:true};var Et=function(){if(typeof window==="undefined"){return false}for(var t in window){try{if(!jt["$"+t]&&G(window,t)&&window[t]!==null&&typeof window[t]==="object"){Ot(window[t])}}catch(r){return true}}return false}();var It=function(t){if(typeof window==="undefined"||!Et){return Ot(t)}try{return Ot(t)}catch(r){return false}};var Mt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var Ut=Mt.length;var Ft=function isArguments(t){return B(t)==="[object Arguments]"};var Nt=function isArguments(t){return t!==null&&typeof t==="object"&&typeof t.length==="number"&&t.length>=0&&!_(t)&&D(t.callee)};var Ct=Ft(arguments)?Ft:Nt;$(e,{keys:function keys(t){var r=D(t);var e=Ct(t);var n=t!==null&&typeof t==="object";var i=n&&C(t);if(!n&&!r&&!e){throw new TypeError("Object.keys called on a non-object")}var a=[];var f=St&&r;if(i&&xt||e){for(var u=0;u<t.length;++u){K(a,o(u))}}if(!e){for(var l in t){if(!(f&&l==="prototype")&&G(t,l)){K(a,o(l))}}}if(Dt){var s=It(t);for(var c=0;c<Ut;c++){var v=Mt[c];if(!(s&&v==="constructor")&&G(t,v)){K(a,v)}}}return a}});var kt=e.keys&&function(){return e.keys(arguments).length===2}(1,2);var At=e.keys&&function(){var t=e.keys(arguments);return arguments.length!==1||t.length!==1||t[0]!==1}(1);var Rt=e.keys;$(e,{keys:function keys(t){if(Ct(t)){return Rt(H(t))}else{return Rt(t)}}},!kt||At);var Pt=new Date(-0xc782b5b342b24).getUTCMonth()!==0;var $t=new Date(-0x55d318d56a724);var Jt=new Date(14496624e5);var Yt=$t.toUTCString()!=="Mon, 01 Jan -45875 11:59:59 GMT";var Zt;var zt;var Gt=$t.getTimezoneOffset();if(Gt<-720){Zt=$t.toDateString()!=="Tue Jan 02 -45875";zt=!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-\+]\d\d\d\d(?: |$)/.test(Jt.toString())}else{Zt=$t.toDateString()!=="Mon Jan 01 -45875";zt=!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-\+]\d\d\d\d(?: |$)/.test(Jt.toString())}var Bt=d.bind(Date.prototype.getFullYear);var Ht=d.bind(Date.prototype.getMonth);var Wt=d.bind(Date.prototype.getDate);var Lt=d.bind(Date.prototype.getUTCFullYear);var Xt=d.bind(Date.prototype.getUTCMonth);var qt=d.bind(Date.prototype.getUTCDate);var Kt=d.bind(Date.prototype.getUTCDay);var Qt=d.bind(Date.prototype.getUTCHours);var Vt=d.bind(Date.prototype.getUTCMinutes);var _t=d.bind(Date.prototype.getUTCSeconds);var tr=d.bind(Date.prototype.getUTCMilliseconds);var rr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var er=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var nr=function daysInMonth(t,r){return Wt(new Date(r,t,0))};$(Date.prototype,{getFullYear:function getFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);if(t<0&&Ht(this)>11){return t+1}return t},getMonth:function getMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Ht(this);if(t<0&&r>11){return 0}return r},getDate:function getDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Ht(this);var e=Wt(this);if(t<0&&r>11){if(r===12){return e}var n=nr(0,t+1);return n-e+1}return e},getUTCFullYear:function getUTCFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Lt(this);if(t<0&&Xt(this)>11){return t+1}return t},getUTCMonth:function getUTCMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Lt(this);var r=Xt(this);if(t<0&&r>11){return 0}return r},getUTCDate:function getUTCDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Lt(this);var r=Xt(this);var e=qt(this);if(t<0&&r>11){if(r===12){return e}var n=nr(0,t+1);return n-e+1}return e}},Pt);$(Date.prototype,{toUTCString:function toUTCString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Kt(this);var r=qt(this);var e=Xt(this);var n=Lt(this);var i=Qt(this);var a=Vt(this);var o=_t(this);return rr[t]+", "+(r<10?"0"+r:r)+" "+er[e]+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"}},Pt||Yt);$(Date.prototype,{toDateString:function toDateString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();return rr[t]+" "+er[e]+" "+(r<10?"0"+r:r)+" "+n}},Pt||Zt);if(Pt||zt){Date.prototype.toString=function toString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();var i=this.getHours();var a=this.getMinutes();var o=this.getSeconds();var f=this.getTimezoneOffset();var u=Math.floor(Math.abs(f)/60);var l=Math.floor(Math.abs(f)%60);return rr[t]+" "+er[e]+" "+(r<10?"0"+r:r)+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"+(f>0?"-":"+")+(u<10?"0"+u:u)+(l<10?"0"+l:l)};if(P){e.defineProperty(Date.prototype,"toString",{configurable:true,enumerable:false,writable:true})}}var ir=-621987552e5;var ar="-000001";var or=Date.prototype.toISOString&&new Date(ir).toISOString().indexOf(ar)===-1;var fr=Date.prototype.toISOString&&new Date(-1).toISOString()!=="1969-12-31T23:59:59.999Z";var ur=d.bind(Date.prototype.getTime);$(Date.prototype,{toISOString:function toISOString(){if(!isFinite(this)||!isFinite(ur(this))){throw new RangeError("Date.prototype.toISOString called on non-finite value.")}var t=Lt(this);var r=Xt(this);t+=Math.floor(r/12);r=(r%12+12)%12;var e=[r+1,qt(this),Qt(this),Vt(this),_t(this)];t=(t<0?"-":t>9999?"+":"")+L("00000"+Math.abs(t),0<=t&&t<=9999?-4:-6);for(var n=0;n<e.length;++n){e[n]=L("00"+e[n],-2)}return t+"-"+H(e,0,2).join("-")+"T"+H(e,2).join(":")+"."+L("000"+tr(this),-3)+"Z"}},or||fr);var lr=function(){try{return Date.prototype.toJSON&&new Date(NaN).toJSON()===null&&new Date(ir).toJSON().indexOf(ar)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return true}})}catch(t){return false}}();if(!lr){Date.prototype.toJSON=function toJSON(t){var r=e(this);var n=Z.ToPrimitive(r);if(typeof n==="number"&&!isFinite(n)){return null}var i=r.toISOString;if(!D(i)){throw new TypeError("toISOString property is not callable")}return i.call(r)}}var sr=Date.parse("+033658-09-27T01:46:40.000Z")===1e15;var cr=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));var vr=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(vr||cr||!sr){var hr=Math.pow(2,31)-1;var pr=Y(new Date(1970,0,1,0,0,0,hr+1).getTime());Date=function(t){var r=function Date(e,n,i,a,f,u,l){var s=arguments.length;var c;if(this instanceof t){var v=u;var h=l;if(pr&&s>=7&&l>hr){var p=Math.floor(l/hr)*hr;var y=Math.floor(p/1e3);v+=y;h-=y*1e3}c=s===1&&o(e)===e?new t(r.parse(e)):s>=7?new t(e,n,i,a,f,v,h):s>=6?new t(e,n,i,a,f,v):s>=5?new t(e,n,i,a,f):s>=4?new t(e,n,i,a):s>=3?new t(e,n,i):s>=2?new t(e,n):s>=1?new t(e instanceof t?+e:e):new t}else{c=t.apply(this,arguments)}if(!J(c)){$(c,{constructor:r},true)}return c};var e=new RegExp("^"+"(\\d{4}|[+-]\\d{6})"+"(?:-(\\d{2})"+"(?:-(\\d{2})"+"(?:"+"T(\\d{2})"+":(\\d{2})"+"(?:"+":(\\d{2})"+"(?:(\\.\\d{1,}))?"+")?"+"("+"Z|"+"(?:"+"([-+])"+"(\\d{2})"+":(\\d{2})"+")"+")?)?)?)?"+"$");var n=[0,31,59,90,120,151,181,212,243,273,304,334,365];var i=function dayFromMonth(t,r){var e=r>1?1:0;return n[r]+Math.floor((t-1969+e)/4)-Math.floor((t-1901+e)/100)+Math.floor((t-1601+e)/400)+365*(t-1970)};var a=function toUTC(r){var e=0;var n=r;if(pr&&n>hr){var i=Math.floor(n/hr)*hr;var a=Math.floor(i/1e3);e+=a;n-=a*1e3}return u(new t(1970,0,1,0,0,e,n))};for(var f in t){if(G(t,f)){r[f]=t[f]}}$(r,{now:t.now,UTC:t.UTC},true);r.prototype=t.prototype;$(r.prototype,{constructor:r},true);var l=function parse(r){var n=e.exec(r);if(n){var o=u(n[1]),f=u(n[2]||1)-1,l=u(n[3]||1)-1,s=u(n[4]||0),c=u(n[5]||0),v=u(n[6]||0),h=Math.floor(u(n[7]||0)*1e3),p=Boolean(n[4]&&!n[8]),y=n[9]==="-"?1:-1,d=u(n[10]||0),g=u(n[11]||0),w;var b=c>0||v>0||h>0;if(s<(b?24:25)&&c<60&&v<60&&h<1e3&&f>-1&&f<12&&d<24&&g<60&&l>-1&&l<i(o,f+1)-i(o,f)){w=((i(o,f)+l)*24+s+d*y)*60;w=((w+c+g*y)*60+v)*1e3+h;if(p){w=a(w)}if(-864e13<=w&&w<=864e13){return w}}return NaN}return t.parse.apply(this,arguments)};$(r,{parse:l});return r}(Date)}if(!Date.now){Date.now=function now(){return(new Date).getTime()}}var yr=l.toFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||0xde0b6b3a7640080.toFixed(0)!=="1000000000000000128");var dr={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function multiply(t,r){var e=-1;var n=r;while(++e<dr.size){n+=t*dr.data[e];dr.data[e]=n%dr.base;n=Math.floor(n/dr.base)}},divide:function divide(t){var r=dr.size;var e=0;while(--r>=0){e+=dr.data[r];dr.data[r]=Math.floor(e/t);e=e%t*dr.base}},numToString:function numToString(){var t=dr.size;var r="";while(--t>=0){if(r!==""||t===0||dr.data[t]!==0){var e=o(dr.data[t]);if(r===""){r=e}else{r+=L("0000000",0,7-e.length)+e}}}return r},pow:function pow(t,r,e){return r===0?e:r%2===1?pow(t,r-1,e*t):pow(t*t,r/2,e)},log:function log(t){var r=0;var e=t;while(e>=4096){r+=12;e/=4096}while(e>=2){r+=1;e/=2}return r}};var gr=function toFixed(t){var r,e,n,i,a,f,l,s;r=u(t);r=Y(r)?0:Math.floor(r);if(r<0||r>20){throw new RangeError("Number.toFixed called with invalid number of decimals")}e=u(this);if(Y(e)){return"NaN"}if(e<=-1e21||e>=1e21){return o(e)}n="";if(e<0){n="-";e=-e}i="0";if(e>1e-21){a=dr.log(e*dr.pow(2,69,1))-69;f=a<0?e*dr.pow(2,-a,1):e/dr.pow(2,a,1);f*=4503599627370496;a=52-a;if(a>0){dr.multiply(0,f);l=r;while(l>=7){dr.multiply(1e7,0);l-=7}dr.multiply(dr.pow(10,l,1),0);l=a-1;while(l>=23){dr.divide(1<<23);l-=23}dr.divide(1<<l);dr.multiply(1,1);dr.divide(2);i=dr.numToString()}else{dr.multiply(0,f);dr.multiply(1<<-a,0);i=dr.numToString()+L("0.00000000000000000000",2,2+r)}}if(r>0){s=i.length;if(s<=r){i=n+L("0.0000000000000000000",0,r-s+2)+i}else{i=n+L(i,0,s-r)+"."+L(i,s-r)}}else{i=n+i}return i};$(l,{toFixed:gr},yr);var wr=function(){try{return 1..toPrecision(undefined)==="1"}catch(t){return true}}();var br=l.toPrecision;$(l,{toPrecision:function toPrecision(t){return typeof t==="undefined"?br.call(this):br.call(this,t)}},wr);if("ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1){(function(){var t=typeof/()??/.exec("")[1]==="undefined";var r=Math.pow(2,32)-1;f.split=function(e,n){var i=String(this);if(typeof e==="undefined"&&n===0){return[]}if(!M(e)){return X(this,e,n)}var a=[];var o=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,u,l,s,c;var h=new RegExp(e.source,o+"g");if(!t){u=new RegExp("^"+h.source+"$(?!\\s)",o)}var p=typeof n==="undefined"?r:Z.ToUint32(n);l=h.exec(i);while(l){s=l.index+l[0].length;if(s>f){K(a,L(i,f,l.index));if(!t&&l.length>1){l[0].replace(u,function(){for(var t=1;t<arguments.length-2;t++){if(typeof arguments[t]==="undefined"){l[t]=void 0}}})}if(l.length>1&&l.index<i.length){v.apply(a,H(l,1))}c=l[0].length;f=s;if(a.length>=p){break}}if(h.lastIndex===l.index){h.lastIndex++}l=h.exec(i)}if(f===i.length){if(c||!h.test("")){K(a,"")}}else{K(a,L(i,f))}return a.length>p?H(a,0,p):a}})()}else if("0".split(void 0,0).length){f.split=function split(t,r){if(typeof t==="undefined"&&r===0){return[]}return X(this,t,r)}}var Tr=f.replace;var mr=function(){var t=[];"x".replace(/x(.)?/g,function(r,e){K(t,e)});return t.length===1&&typeof t[0]==="undefined"}();if(!mr){f.replace=function replace(t,r){var e=D(r);var n=M(t)&&/\)[*?]/.test(t.source);if(!e||!n){return Tr.call(this,t,r)}else{var i=function(e){var n=arguments.length;var i=t.lastIndex;t.lastIndex=0;var a=t.exec(e)||[];t.lastIndex=i;K(a,arguments[n-2],arguments[n-1]);return r.apply(this,a)};return Tr.call(this,t,i)}}}var Dr=f.substr;var Sr="".substr&&"0b".substr(-1)!=="b";$(f,{substr:function substr(t,r){var e=t;if(t<0){e=w(this.length+t,0)}return Dr.call(this,e,r)}},Sr);var xr="	\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003"+"\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028"+"\u2029\ufeff";var Or="\u200b";var jr="["+xr+"]";var Er=new RegExp("^"+jr+jr+"*");var Ir=new RegExp(jr+jr+"*$");var Mr=f.trim&&(xr.trim()||!Or.trim());$(f,{trim:function trim(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}return o(this).replace(Er,"").replace(Ir,"")}},Mr);var Ur=d.bind(String.prototype.trim);var Fr=f.lastIndexOf&&"abc\u3042\u3044".lastIndexOf("\u3042\u3044",2)!==-1;$(f,{lastIndexOf:function lastIndexOf(t){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var r=o(this);var e=o(t);var n=arguments.length>1?u(arguments[1]):NaN;var i=Y(n)?Infinity:Z.ToInteger(n);var a=b(w(i,0),r.length);var f=e.length;var l=a+f;while(l>0){l=w(0,l-f);var s=q(L(r,l,a+f),e);if(s!==-1){return l+s}}return-1}},Fr);var Nr=f.lastIndexOf;$(f,{lastIndexOf:function lastIndexOf(t){return Nr.apply(this,arguments)}},f.lastIndexOf.length!==1);if(parseInt(xr+"08")!==8||parseInt(xr+"0x16")!==22){parseInt=function(t){var r=/^[\-+]?0[xX]/;return function parseInt(e,n){var i=Ur(String(e));var a=u(n)||(r.test(i)?16:10);return t(i,a)}}(parseInt)}if(1/parseFloat("-0")!==-Infinity){parseFloat=function(t){return function parseFloat(r){var e=Ur(String(r));var n=t(e);return n===0&&L(e,0,1)==="-"?-0:n}}(parseFloat)}if(String(new RangeError("test"))!=="RangeError: test"){var Cr=function toString(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var t=this.name;if(typeof t==="undefined"){t="Error"}else if(typeof t!=="string"){t=o(t)}var r=this.message;if(typeof r==="undefined"){r=""}else if(typeof r!=="string"){r=o(r)}if(!t){return r}if(!r){return t}return t+": "+r};Error.prototype.toString=Cr}if(P){var kr=function(t,r){if(Q(t,r)){var e=Object.getOwnPropertyDescriptor(t,r);if(e.configurable){e.enumerable=false;Object.defineProperty(t,r,e)}}};kr(Error.prototype,"message");if(Error.prototype.message!==""){Error.prototype.message=""}kr(Error.prototype,"name")}if(String(/a/gim)!=="/a/gim"){var Ar=function toString(){var t="/"+this.source+"/";if(this.global){t+="g"}if(this.ignoreCase){t+="i"}if(this.multiline){t+="m"}return t};RegExp.prototype.toString=Ar}});
//# sourceMappingURL=es5-shim.map
/*!
  * https://github.com/paulmillr/es6-shim
  * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
  *   and contributors,  MIT License
  * es6-shim: v0.35.1
  * see https://github.com/paulmillr/es6-shim/blob/0.35.1/LICENSE
  * Details and documentation:
  * https://github.com/paulmillr/es6-shim/
  */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(t){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var u=o(i);var f=function(){return!i(function(){Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var O={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var m=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){O.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=m(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.shift);var A=Math.max;var R=Math.min;var _=Math.floor;var k=Math.abs;var F=Math.exp;var L=Math.log;var D=Math.sqrt;var z=Function.call.bind(Object.prototype.hasOwnProperty);var q;var W=function(){};var G=S.Symbol||{};var H=G.species||"@@species";var V=Number.isNaN||function isNaN(e){return e!==e};var B=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var $=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(V(t)){return t}return t<0?-1:1};var U=function isArguments(e){return g(e)==="[object Arguments]"};var J=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var X=U(arguments)?U:J;var K={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var Z=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);O.preserveToString(e[t],n)};var Y=typeof G==="function"&&typeof G["for"]==="function"&&K.symbol(G());var Q=K.symbol(G.iterator)?G.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){Q="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ee=S.Reflect;var te=String;var re={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!re.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(e==null){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"},ToObject:function(e,t){return Object(re.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return re.IsCallable(e)},ToInt32:function(e){return re.ToNumber(e)>>0},ToUint32:function(e){return re.ToNumber(e)>>>0},ToNumber:function(e){if(g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=re.ToNumber(e);if(V(t)){return 0}if(t===0||!B(t)){return t}return(t>0?1:-1)*_(k(t))},ToLength:function(e){var t=re.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return V(e)&&V(t)},SameValueZero:function(e,t){return e===t||V(e)&&V(t)},IsIterable:function(e){return re.TypeIsObject(e)&&(typeof e[Q]!=="undefined"||X(e))},GetIterator:function(e){if(X(e)){return new q(e,"value")}var t=re.GetMethod(e,Q);if(!re.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=re.Call(t,e);if(!re.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=re.ToObject(e)[t];if(r===void 0||r===null){return void 0}if(!re.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=re.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=re.Call(r,e)}catch(i){o=i}if(t){return}if(o){throw o}if(!re.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!re.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=re.IteratorNext(e);var r=re.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ee.construct){return ee.construct(e,t,o)}var i=o.prototype;if(!re.TypeIsObject(i)){i=Object.prototype}var a=m(i);var u=re.Call(e,a,t);return re.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!re.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[H];if(n===void 0||n===null){return t}if(!re.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=re.ToString(e);var i="<"+t;if(r!==""){var a=re.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!re.TypeIsObject(e)){return false}var t=e[G.match];if(typeof t!=="undefined"){return!!t}return K.regex(e)},ToString:function ToString(e){return te(e)}};if(s&&Y){var ne=function defineWellKnownSymbol(e){if(K.symbol(G[e])){return G[e]}var t=G["for"]("Symbol."+e);Object.defineProperty(G,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!K.symbol(G.search)){var oe=ne("search");var ie=String.prototype.search;h(RegExp.prototype,oe,function search(e){return re.Call(ie,e,[this])});var ae=function search(e){var t=re.RequireObjectCoercible(this);if(e!==null&&typeof e!=="undefined"){var r=re.GetMethod(e,oe);if(typeof r!=="undefined"){return re.Call(r,e,[t])}}return re.Call(ie,t,[re.ToString(e)])};Z(String.prototype,"search",ae)}if(!K.symbol(G.replace)){var ue=ne("replace");var fe=String.prototype.replace;h(RegExp.prototype,ue,function replace(e,t){return re.Call(fe,e,[this,t])});var se=function replace(e,t){var r=re.RequireObjectCoercible(this);if(e!==null&&typeof e!=="undefined"){var n=re.GetMethod(e,ue);if(typeof n!=="undefined"){return re.Call(n,e,[r,t])}}return re.Call(fe,r,[re.ToString(e),t])};Z(String.prototype,"replace",se)}if(!K.symbol(G.split)){var ce=ne("split");var le=String.prototype.split;h(RegExp.prototype,ce,function split(e,t){return re.Call(le,e,[this,t])});var pe=function split(e,t){var r=re.RequireObjectCoercible(this);if(e!==null&&typeof e!=="undefined"){var n=re.GetMethod(e,ce);if(typeof n!=="undefined"){return re.Call(n,e,[r,t])}}return re.Call(le,r,[re.ToString(e),t])};Z(String.prototype,"split",pe)}var ve=K.symbol(G.match);var ye=ve&&function(){var e={};e[G.match]=function(){return 42};return"a".match(e)!==42}();if(!ve||ye){var he=ne("match");var be=String.prototype.match;h(RegExp.prototype,he,function match(e){return re.Call(be,e,[this])});var ge=function match(e){var t=re.RequireObjectCoercible(this);if(e!==null&&typeof e!=="undefined"){var r=re.GetMethod(e,he);if(typeof r!=="undefined"){return re.Call(r,e,[t])}}return re.Call(be,t,[re.ToString(e)])};Z(String.prototype,"match",ge)}}var de=function wrapConstructor(e,t,r){O.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in W||r[n]){return}O.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in W||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;O.redefine(e.prototype,"constructor",t)};var Oe=function(){return this};var me=function(e){if(s&&!z(e,H)){O.getter(e,H,Oe)}};var we=function(e,t){var r=t||function iterator(){return this};h(e,Q,r);if(!e[Q]&&K.symbol(Q)){e[Q]=r}};var je=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var Se=function createDataPropertyOrThrow(e,t,r){je(e,t,r);if(!re.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var Te=function(e,t,r,n){if(!re.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!re.TypeIsObject(o)){o=r}var i=m(o);for(var a in n){if(z(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var Ie=String.fromCodePoint;Z(String,"fromCodePoint",function fromCodePoint(e){return re.Call(Ie,this,arguments)})}var Ee={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!re.SameValue(r,re.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return t.join("")},raw:function raw(e){var t=re.ToObject(e,"bad callSite");var r=re.ToObject(t.raw,"bad raw value");var n=r.length;var o=re.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=re.ToString(a);s=re.ToString(r[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=re.ToString(f);M(i,c);a+=1}return i.join("")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){Z(String,"raw",Ee.raw)}b(String,Ee);var Pe=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var Ce=Infinity;var Me={repeat:function repeat(e){var t=re.ToString(re.RequireObjectCoercible(this));var r=re.ToInteger(e);if(r<0||r>=Ce){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return Pe(t,r)},startsWith:function startsWith(e){var t=re.ToString(re.RequireObjectCoercible(this));if(re.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=re.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=A(re.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=re.ToString(re.RequireObjectCoercible(this));if(re.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=re.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:re.ToInteger(o);var a=R(A(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(re.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=re.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=re.ToString(re.RequireObjectCoercible(this));var r=re.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){Z(String.prototype,"includes",Me.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var xe=i(function(){"/a/".startsWith(/a/)});var Ne=a(function(){return"abc".startsWith("a",Infinity)===false});if(!xe||!Ne){Z(String.prototype,"startsWith",Me.startsWith);Z(String.prototype,"endsWith",Me.endsWith)}}if(Y){var Ae=a(function(){var e=/a/;e[G.match]=false;return"/a/".startsWith(e)});if(!Ae){Z(String.prototype,"startsWith",Me.startsWith)}var Re=a(function(){var e=/a/;e[G.match]=false;return"/a/".endsWith(e)});if(!Re){Z(String.prototype,"endsWith",Me.endsWith)}var _e=a(function(){var e=/a/;e[G.match]=false;return"/a/".includes(e)});if(!_e){Z(String.prototype,"includes",Me.includes)}}b(String.prototype,Me);var ke=["	\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var Fe=new RegExp("(^["+ke+"]+)|(["+ke+"]+$)","g");var Le=function trim(){return re.ToString(re.RequireObjectCoercible(this)).replace(Fe,"")};var De=["\x85","\u200b","\ufffe"].join("");var ze=new RegExp("["+De+"]","g");var qe=/^[\-+]0x[0-9a-f]+$/i;var We=De.trim().length!==De.length;h(String.prototype,"trim",Le,We);var Ge=function(e){return{value:e,done:arguments.length===0}};var He=function(e){re.RequireObjectCoercible(e);this._s=re.ToString(e);this._i=0};He.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Ge()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Ge(e.substr(t,o))};we(He.prototype);we(String.prototype,function(){return new He(this)});var Ve={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!re.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(X(e)||re.GetMethod(e,Q))!=="undefined";var u,f,s;if(a){f=re.IsConstructor(r)?Object(new r):[];var c=re.GetIterator(e);var l,p;s=0;while(true){l=re.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(v){re.IteratorClose(c,true);throw v}s+=1}u=s}else{var y=re.ToObject(e);u=re.ToLength(y.length);f=re.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(s=0;s<u;++s){h=y[s];if(o){h=typeof i==="undefined"?n(h,s):t(n,i,h,s)}Se(f,s,h)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!re.IsCallable(t)?new Array(e):re.Construct(t,[e]);for(var o=0;o<e;++o){Se(n,o,arguments[o])}n.length=e;return n}};b(Array,Ve);me(Array);q=function(e,t){this.i=0;this.array=e;this.kind=t};b(q.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof q)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=re.ToLength(t.length);for(;e<r;e++){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Ge(o)}}this.array=void 0;return Ge()}});we(q.prototype);var Be=Array.of===Ve.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!Be){Z(Array,"of",Ve.of)}var $e={copyWithin:function copyWithin(e,t){var r=re.ToObject(this);var n=re.ToLength(r.length);var o=re.ToInteger(e);var i=re.ToInteger(t);var a=o<0?A(n+o,0):R(o,n);var u=i<0?A(n+i,0):R(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:re.ToInteger(f);var c=s<0?A(n+s,0):R(s,n);var l=R(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=re.ToObject(this);var o=re.ToLength(n.length);t=re.ToInteger(typeof t==="undefined"?0:t);r=re.ToInteger(typeof r==="undefined"?o:r);var i=t<0?A(o+t,0):R(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=re.ToObject(this);var n=re.ToLength(r.length);if(!re.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=re.ToObject(this);var n=re.ToLength(r.length);if(!re.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new q(this,"key")},values:function values(){return new q(this,"value")},entries:function entries(){return new q(this,"entry")}};if(Array.prototype.keys&&!re.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!re.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[Q]){b(Array.prototype,{values:Array.prototype[Q]});if(K.symbol(G.unscopables)){Array.prototype[G.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var Ue=Array.prototype.values;Z(Array.prototype,"values",function values(){return re.Call(Ue,this,arguments)});h(Array.prototype,Q,Array.prototype.values,true)}b(Array.prototype,$e);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}we(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){we(Object.getPrototypeOf([].values()))}var Je=function(){return a(function(){return Array.from({length:-1}).length===0})}();var Xe=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!Je||!Xe){Z(Array,"from",Ve.from)}var Ke=function(){return a(function(){return Array.from([0],void 0)})}();if(!Ke){var Ze=Array.from;Z(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return re.Call(Ze,this,arguments)}else{return t(Ze,this,e)}})}var Ye=-(Math.pow(2,32)-1);var Qe=function(e,r){var n={length:Ye};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!Qe(Array.prototype.forEach)){var et=Array.prototype.forEach;Z(Array.prototype,"forEach",function forEach(e){return re.Call(et,this.length>=0?this:[],arguments)},true)}if(!Qe(Array.prototype.map)){var tt=Array.prototype.map;Z(Array.prototype,"map",function map(e){return re.Call(tt,this.length>=0?this:[],arguments)},true)}if(!Qe(Array.prototype.filter)){var rt=Array.prototype.filter;Z(Array.prototype,"filter",function filter(e){return re.Call(rt,this.length>=0?this:[],arguments)},true)}if(!Qe(Array.prototype.some)){var nt=Array.prototype.some;Z(Array.prototype,"some",function some(e){return re.Call(nt,this.length>=0?this:[],arguments)},true)}if(!Qe(Array.prototype.every)){var ot=Array.prototype.every;Z(Array.prototype,"every",function every(e){return re.Call(ot,this.length>=0?this:[],arguments)},true)}if(!Qe(Array.prototype.reduce)){var it=Array.prototype.reduce;Z(Array.prototype,"reduce",function reduce(e){return re.Call(it,this.length>=0?this:[],arguments)},true)}if(!Qe(Array.prototype.reduceRight,true)){var at=Array.prototype.reduceRight;Z(Array.prototype,"reduceRight",function reduceRight(e){return re.Call(at,this.length>=0?this:[],arguments)},true)}var ut=Number("0o10")!==8;var ft=Number("0b10")!==2;var st=y(De,function(e){return Number(e+0+e)===0});if(ut||ft||st){var ct=Number;var lt=/^0b[01]+$/i;var pt=/^0o[0-7]+$/i;var vt=lt.test.bind(lt);var yt=pt.test.bind(pt);var ht=function(e){var t;if(typeof e.valueOf==="function"){t=e.valueOf();if(K.primitive(t)){return t}}if(typeof e.toString==="function"){t=e.toString();if(K.primitive(t)){return t}}throw new TypeError("No default value")};var bt=ze.test.bind(ze);var gt=qe.test.bind(qe);var dt=function(){var e=function Number(t){var r;if(arguments.length>0){r=K.primitive(t)?t:ht(t,"number")}else{r=0}if(typeof r==="string"){r=re.Call(Le,r);if(vt(r)){r=parseInt(C(r,2),2)}else if(yt(r)){r=parseInt(C(r,2),8)}else if(bt(r)||gt(r)){r=NaN}}var n=this;var o=a(function(){ct.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new ct(r)}return ct(r)};return e}();de(ct,dt,{});b(dt,{NaN:ct.NaN,MAX_VALUE:ct.MAX_VALUE,MIN_VALUE:ct.MIN_VALUE,NEGATIVE_INFINITY:ct.NEGATIVE_INFINITY,POSITIVE_INFINITY:ct.POSITIVE_INFINITY});Number=dt;O.redefine(S,"Number",dt)}var Ot=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Ot,MIN_SAFE_INTEGER:-Ot,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:B,isInteger:function isInteger(e){return B(e)&&re.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&k(e)<=Number.MAX_SAFE_INTEGER},isNaN:V});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if(![,1].find(function(e,t){return t===0})){Z(Array.prototype,"find",$e.find)}if([,1].findIndex(function(e,t){return t===0})!==0){Z(Array.prototype,"findIndex",$e.findIndex)}var mt=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var wt=function ensureEnumerable(e,t){if(s&&mt(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var jt=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var St=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var Tt=function(e,t){var r=n(Object(t));var o;if(re.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),mt(t))}return p(P(r,o||[]),St(t),e)};var It={assign:function(e,t){var r=re.ToObject(e,"Cannot convert undefined or null to object");return p(re.Call(jt,1,arguments),Tt,r)},is:function is(e,t){return re.SameValue(e,t)}};var Et=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(Et){Z(Object,"assign",It.assign)}b(Object,It);if(s){var Pt={setPrototypeOf:function(e,r){var n;var o=function(e,t){if(!re.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||re.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var i=function(e,r){o(e,r);t(n,e,r);return e};try{n=e.getOwnPropertyDescriptor(e.prototype,r).set;t(n,{},null)}catch(a){if(e.prototype!=={}[r]){return}n=function(e){this[r]=e};i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};b(Object,Pt)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Ct=!i(function(){Object.keys("foo")});if(!Ct){var Mt=Object.keys;Z(Object,"keys",function keys(e){return Mt(re.ToObject(e))});n=Object.keys}var xt=i(function(){Object.keys(/a/g)});if(xt){var Nt=Object.keys;Z(Object,"keys",function keys(e){if(K.regex(e)){var t=[];for(var r in e){if(z(e,r)){M(t,r)}}return t}return Nt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var At=!i(function(){Object.getOwnPropertyNames("foo")});if(!At){var Rt=typeof window==="object"?Object.getOwnPropertyNames(window):[];var _t=Object.getOwnPropertyNames;Z(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=re.ToObject(e);if(g(t)==="[object Window]"){try{return _t(t)}catch(r){return P([],Rt)}}return _t(t)})}}if(Object.getOwnPropertyDescriptor){var kt=!i(function(){Object.getOwnPropertyDescriptor("foo","bar")});if(!kt){var Ft=Object.getOwnPropertyDescriptor;Z(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Ft(re.ToObject(e),t)})}}if(Object.seal){var Lt=!i(function(){Object.seal("foo")});if(!Lt){var Dt=Object.seal;Z(Object,"seal",function seal(e){if(!re.TypeIsObject(e)){return e}return Dt(e)})}}if(Object.isSealed){var zt=!i(function(){Object.isSealed("foo")});if(!zt){var qt=Object.isSealed;Z(Object,"isSealed",function isSealed(e){if(!re.TypeIsObject(e)){return true}return qt(e)})}}if(Object.freeze){var Wt=!i(function(){Object.freeze("foo")});if(!Wt){var Gt=Object.freeze;Z(Object,"freeze",function freeze(e){if(!re.TypeIsObject(e)){return e}return Gt(e)})}}if(Object.isFrozen){var Ht=!i(function(){Object.isFrozen("foo")});if(!Ht){var Vt=Object.isFrozen;Z(Object,"isFrozen",function isFrozen(e){if(!re.TypeIsObject(e)){return true}return Vt(e)})}}if(Object.preventExtensions){var Bt=!i(function(){Object.preventExtensions("foo")});if(!Bt){var $t=Object.preventExtensions;Z(Object,"preventExtensions",function preventExtensions(e){if(!re.TypeIsObject(e)){return e}return $t(e)})}}if(Object.isExtensible){var Ut=!i(function(){Object.isExtensible("foo")});if(!Ut){var Jt=Object.isExtensible;Z(Object,"isExtensible",function isExtensible(e){if(!re.TypeIsObject(e)){return false}return Jt(e)})}}if(Object.getPrototypeOf){var Xt=!i(function(){Object.getPrototypeOf("foo")});if(!Xt){var Kt=Object.getPrototypeOf;Z(Object,"getPrototypeOf",function getPrototypeOf(e){return Kt(re.ToObject(e))})}}var Zt=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&re.IsCallable(e.get)}();if(s&&!Zt){var Yt=function flags(){if(!re.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};O.getter(RegExp.prototype,"flags",Yt)}var Qt=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var er=Y&&s&&function(){var e=/./;e[G.match]=false;return RegExp(e)===e}();var tr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var rr=tr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!tr||!rr){var nr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=re.RequireObjectCoercible(this);if(K.regex(e)){return t(nr,e)}var r=te(e.source);var n=te(e.flags);return"/"+r+"/"+n},true);O.preserveToString(RegExp.prototype.toString,nr)}if(s&&(!Qt||er)){var or=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var ir=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var ar=function(){return this.source};var ur=re.IsCallable(ir.get)?ir.get:ar;var fr=RegExp;var sr=function(){return function RegExp(e,t){var r=re.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(K.regex(e)){o=re.Call(ur,e);i=typeof t==="undefined"?re.Call(or,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new fr(e,t)}}();de(fr,sr,{$input:true});RegExp=sr;O.redefine(S,"RegExp",sr)}if(s){var cr={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(cr),function(e){if(e in RegExp&&!(cr[e]in RegExp)){O.getter(RegExp,cr[e],function get(){return RegExp[e]})}})}me(RegExp);var lr=1/Number.EPSILON;var pr=function roundTiesToEven(e){return e+lr-lr};var vr=Math.pow(2,-23);var yr=Math.pow(2,127)*(2-vr);var hr=Math.pow(2,-126);var br=Math.E;var gr=Math.LOG2E;var dr=Math.LOG10E;var Or=Number.prototype.clz;delete Number.prototype.clz;var mr={acosh:function acosh(e){var t=Number(e);if(V(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}return L(t/br+D(t+1)*D(t-1)/br)+1},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}return t<0?-asinh(-t):L(t+D(t*t+1))},atanh:function atanh(e){var t=Number(e);if(V(t)||t<-1||t>1){return NaN}if(t===-1){return-Infinity}if(t===1){return Infinity}if(t===0){return t}return.5*L((1+t)/(1-t))},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=F(L(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=re.ToUint32(t);if(r===0){return 32}return Or?re.Call(Or,r):31-_(L(r+.5)*gr)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(V(t)){return NaN}if(!T(t)){return Infinity}if(t<0){t=-t}if(t>21){return F(t)/2}return(F(t)+F(-t))/2},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(k(t)>.5){return F(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=k(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*D(r)},log2:function log2(e){return L(e)*gr},log10:function log10(e){return L(e)*dr},log1p:function log1p(e){var t=Number(e);if(t<-1||V(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(L(1+t)/(1+t-1))},sign:$,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}if(k(t)<1){return(Math.expm1(t)-Math.expm1(-t))/2}return(F(t-1)-F(-t-1))*br/2},tanh:function tanh(e){var t=Number(e);if(V(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(F(t)+F(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-_(-t):_(t)},imul:function imul(e,t){var r=re.ToUint32(e);var n=re.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||V(t)){return t}var r=$(t);var n=k(t);if(n<hr){return r*pr(n/hr/vr)*hr*vr}var o=(1+vr/Number.EPSILON)*n;var i=o-(o-n);if(i>yr||V(i)){return r*Infinity}return r*i}};b(Math,mr);h(Math,"log1p",mr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",mr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));h(Math,"tanh",mr.tanh,Math.tanh(-2e-17)!==-2e-17);h(Math,"acosh",mr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"cbrt",mr.cbrt,Math.abs(1-Math.cbrt(1e-300)/1e-100)/Number.EPSILON>8);h(Math,"sinh",mr.sinh,Math.sinh(-2e-17)!==-2e-17);var wr=Math.expm1(10);h(Math,"expm1",mr.expm1,wr>22025.465794806718||wr<22025.465794806718);var jr=Math.round;var Sr=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var Tr=lr+1;var Ir=2*lr-1;var Er=[Tr,Ir].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=_(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!Sr||!Er);O.preserveToString(Math.round,jr);var Pr=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=mr.imul;O.preserveToString(Math.imul,Pr)}if(Math.imul.length!==2){Z(Math,"imul",function imul(e,t){return re.Call(Pr,Math,arguments);
})}var Cr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}re.IsPromise=function(e){if(!re.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!re.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(re.IsCallable(t.resolve)&&re.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&re.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=N(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=re.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(re.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(i){n=i;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var O=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var m=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return O(e,new TypeError("Self resolution"))}if(!re.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(o){return O(e,o)}if(!re.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return O(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=m(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(a){i(a)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!re.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=Te(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=m(r);var o=n.reject;try{t(n.resolve,o)}catch(i){o(i)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=re.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(s){e.done=true;throw s}o[f]=void 0;var c=t.resolve(u);var l=P(f,o,r,i);i.count+=1;w(c.then,c,l,r.reject);f+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=re.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!re.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=re.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{re.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},race:function race(e){var t=this;if(!re.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=re.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{re.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},reject:function reject(e){var t=this;if(!re.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!re.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(re.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{"catch":function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!re.IsPromise(n)){throw new TypeError("not a promise")}var o=re.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=re.IsCallable(e)?e:a;var d=re.IsCallable(t)?t:u;var O=n._promise;var m;if(O.state===f){if(O.reactionLength===0){O.fulfillReactionHandler0=g;O.rejectReactionHandler0=d;O.reactionCapability0=i}else{var w=3*(O.reactionLength-1);O[w+l]=g;O[w+p]=d;O[w+v]=i}O.reactionLength+=1}else if(O.state===s){m=O.result;h(g,i,m)}else if(O.state===c){m=O.result;h(d,i,m)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof Cr==="function"){b(S,{Promise:Cr});var Mr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var xr=!i(function(){S.Promise.reject(42).then(null,5).then(null,W)});var Nr=i(function(){S.Promise.call(3,W)});var Ar=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,W).then(null,W)}catch(n){return true}return t===r}(S.Promise);var Rr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var _r=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};_r.prototype=Promise.prototype;_r.all=Promise.all;var kr=a(function(){return!!_r.all([1,2])});if(!Mr||!xr||!Nr||Ar||!Rr||kr){Promise=Cr;Z(S,"Promise",Cr)}if(Promise.all.length!==1){var Fr=Promise.all;Z(Promise,"all",function all(e){return re.Call(Fr,this,arguments)})}if(Promise.race.length!==1){var Lr=Promise.race;Z(Promise,"race",function race(e){return re.Call(Lr,this,arguments)})}if(Promise.resolve.length!==1){var Dr=Promise.resolve;Z(Promise,"resolve",function resolve(e){return re.Call(Dr,this,arguments)})}if(Promise.reject.length!==1){var zr=Promise.reject;Z(Promise,"reject",function reject(e){return re.Call(zr,this,arguments)})}wt(Promise,"all");wt(Promise,"race");wt(Promise,"resolve");wt(Promise,"reject");me(Promise)}var qr=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Wr=qr(["z","a","bb"]);var Gr=qr(["z",1,"a","3",2]);if(s){var Hr=function fastkey(e){if(!Wr){return null}if(typeof e==="undefined"||e===null){return"^"+re.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Gr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var Vr=function emptyObject(){return Object.create?Object.create(null):{}};var Br=function addIterableToMap(e,n,o){if(r(o)||K.string(o)){l(o,function(e){if(!re.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(o!==null&&typeof o!=="undefined"){a=n.set;if(!re.IsCallable(a)){throw new TypeError("bad map")}i=re.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=re.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!re.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(s){re.IteratorClose(i,true);throw s}}}}};var $r=function addIterableToSet(e,n,o){if(r(o)||K.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(o!==null&&typeof o!=="undefined"){a=n.add;if(!re.IsCallable(a)){throw new TypeError("bad set")}i=re.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=re.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(s){re.IteratorClose(i,true);throw s}}}}};var Ur={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!re.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+re.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");this.head=e._head;this.i=this.head;this.kind=t};i.prototype={next:function next(){var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Ge()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Ge(n)}}this.i=void 0;return Ge()}};we(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=Te(this,Map,a,{_es6map:true,_head:null,_storage:Vr(),_size:0});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){Br(Map,e,arguments[0])}return e};a=u.prototype;O.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t=Hr(e);if(t!==null){var r=this._storage[t];if(r){return r.value}else{return}}var n=this._head;var i=n;while((i=i.next)!==n){if(re.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=Hr(e);if(t!==null){return typeof this._storage[t]!=="undefined"}var r=this._head;var n=r;while((n=n.next)!==r){if(re.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=Hr(e);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}else{a=this._storage[u]=new r(e,t);i=n.prev}}while((i=i.next)!==n){if(re.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(re.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head;var n=r;var i=Hr(t);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}while((n=n.next)!==r){if(re.SameValueZero(n.key,t)){n.key=n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._size=0;this._storage=Vr();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});we(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!re.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+re.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=Te(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:Vr()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){$r(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}else{var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=e["[[SetData]]"]=new Ur.Map;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};O.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=Hr(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=Hr(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=Hr(e))!==null){var n=z(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=Vr()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return this["[[SetData]]"].values()},entries:function entries(){r(this,"entries");u(this);return this["[[SetData]]"].entries()},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);we(i.prototype,i.prototype.values);return i}()};if(S.Map||S.Set){var Jr=a(function(){return new Map([[1,2]]).get(1)===2});if(!Jr){var Xr=S.Map;S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new Xr;if(arguments.length>0){Br(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=m(Xr.prototype);h(S.Map.prototype,"constructor",S.Map,true);O.preserveToString(S.Map,Xr)}var Kr=new Map;var Zr=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var Yr=Kr.set(1,2)===Kr;if(!Zr||!Yr){var Qr=Map.prototype.set;Z(Map.prototype,"set",function set(e,r){t(Qr,this,e===0?0:e,r);return this})}if(!Zr){var en=Map.prototype.get;var tn=Map.prototype.has;b(Map.prototype,{get:function get(e){return t(en,this,e===0?0:e)},has:function has(e){return t(tn,this,e===0?0:e)}},true);O.preserveToString(Map.prototype.get,en);O.preserveToString(Map.prototype.has,tn)}var rn=new Set;var nn=function(e){e["delete"](0);e.add(-0);return!e.has(0)}(rn);var on=rn.add(1)===rn;if(!nn||!on){var an=Set.prototype.add;Set.prototype.add=function add(e){t(an,this,e===0?0:e);return this};O.preserveToString(Set.prototype.add,an)}if(!nn){var un=Set.prototype.has;Set.prototype.has=function has(e){return t(un,this,e===0?0:e)};O.preserveToString(Set.prototype.has,un);var fn=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(fn,this,e===0?0:e)};O.preserveToString(Set.prototype["delete"],fn)}var sn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var cn=Object.setPrototypeOf&&!sn;var ln=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||cn||!ln){var pn=S.Map;S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new pn;if(arguments.length>0){Br(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=pn.prototype;h(S.Map.prototype,"constructor",S.Map,true);O.preserveToString(S.Map,pn)}var vn=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var yn=Object.setPrototypeOf&&!vn;var hn=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||yn||!hn){var bn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new bn;if(arguments.length>0){$r(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=bn.prototype;h(S.Set.prototype,"constructor",S.Set,true);O.preserveToString(S.Set,bn)}var gn=new S.Map;var dn=!a(function(){return gn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||gn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof gn.keys().next!=="function"||dn||!sn){b(S,{Map:Ur.Map,Set:Ur.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}we(Object.getPrototypeOf((new S.Map).keys()));we(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var On=S.Set.prototype.has;Z(S.Set.prototype,"has",function has(e){return t(On,this,e)})}}b(S,Ur);me(S.Map);me(S.Set)}var mn=function throwUnlessTargetIsObject(e){if(!re.TypeIsObject(e)){throw new TypeError("target must be an object")}};var wn={apply:function apply(){return re.Call(re.Call,null,arguments)},construct:function construct(e,t){if(!re.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!re.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return re.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){mn(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){mn(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(wn,{ownKeys:function ownKeys(e){mn(e);var t=Object.getOwnPropertyNames(e);if(re.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var jn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(wn,{isExtensible:function isExtensible(e){mn(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){mn(e);return jn(function(){Object.preventExtensions(e)})}})}if(s){var Sn=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return Sn(o,t,r)}if("value"in n){return n.value}if(n.get){return re.Call(n.get,r)}return void 0};var Tn=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return Tn(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!re.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ee.defineProperty(o,r,{value:n})}else{return ee.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}}if(i.set){t(i.set,o,n);return true}return false};Object.assign(wn,{defineProperty:function defineProperty(e,t,r){mn(e);return jn(function(){Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){mn(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){mn(e);var r=arguments.length>2?arguments[2]:e;return Sn(e,t,r)},set:function set(e,t,r){mn(e);var n=arguments.length>3?arguments[3]:e;return Tn(e,t,r,n)}})}if(Object.getPrototypeOf){var In=Object.getPrototypeOf;wn.getPrototypeOf=function getPrototypeOf(e){mn(e);return In(e)}}if(Object.setPrototypeOf&&wn.getPrototypeOf){var En=function(e,t){var r=t;while(r){if(e===r){return true}r=wn.getPrototypeOf(r)}return false};Object.assign(wn,{setPrototypeOf:function setPrototypeOf(e,t){mn(e);if(t!==null&&!re.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ee.getPrototypeOf(e)){return true}if(ee.isExtensible&&!ee.isExtensible(e)){return false}if(En(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var Pn=function(e,t){if(!re.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){Z(S.Reflect,e,t)}}};Object.keys(wn).forEach(function(e){Pn(e,wn[e])});var Cn=S.Reflect.getPrototypeOf;if(c&&Cn&&Cn.name!=="getPrototypeOf"){Z(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(Cn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){Z(S.Reflect,"setPrototypeOf",wn.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){Z(S.Reflect,"defineProperty",wn.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){Z(S.Reflect,"construct",wn.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var Mn=Date.prototype.toString;var xn=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return re.Call(Mn,this)};Z(Date.prototype,"toString",xn)}var Nn={anchor:function anchor(e){return re.CreateHTML(this,"a","name",e)},big:function big(){return re.CreateHTML(this,"big","","")},blink:function blink(){return re.CreateHTML(this,"blink","","")},bold:function bold(){return re.CreateHTML(this,"b","","")},fixed:function fixed(){return re.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return re.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return re.CreateHTML(this,"font","size",e)},italics:function italics(){return re.CreateHTML(this,"i","","")},link:function link(e){return re.CreateHTML(this,"a","href",e)},small:function small(){return re.CreateHTML(this,"small","","")},strike:function strike(){return re.CreateHTML(this,"strike","","")},sub:function sub(){return re.CreateHTML(this,"sub","","")},sup:function sub(){return re.CreateHTML(this,"sup","","")}};l(Object.keys(Nn),function(e){var r=String.prototype[e];var n=false;if(re.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){Z(String.prototype,e,Nn[e])}});var An=function(){if(!Y){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e(G())!=="undefined"){return true}if(e([G()])!=="[null]"){return true}var t={a:G()};t[G()]=true;if(e(t)!=="{}"){return true}return false}();var Rn=a(function(){if(!Y){return true}return JSON.stringify(Object(G()))==="{}"&&JSON.stringify([Object(G())])==="[{}]"});if(An||!Rn){var _n=JSON.stringify;Z(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=re.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(K.symbol(n)){return St({})(n)}else{return n}}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return _n.apply(this,o)})}return S});
//# sourceMappingURL=es6-shim.map
/*! jQuery v3.1.0 | (c) jQuery Foundation | jquery.org/license */
!function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";var c=[],d=a.document,e=Object.getPrototypeOf,f=c.slice,g=c.concat,h=c.push,i=c.indexOf,j={},k=j.toString,l=j.hasOwnProperty,m=l.toString,n=m.call(Object),o={};function p(a,b){b=b||d;var c=b.createElement("script");c.text=a,b.head.appendChild(c).parentNode.removeChild(c)}var q="3.1.0",r=function(a,b){return new r.fn.init(a,b)},s=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,t=/^-ms-/,u=/-([a-z])/g,v=function(a,b){return b.toUpperCase()};r.fn=r.prototype={jquery:q,constructor:r,length:0,toArray:function(){return f.call(this)},get:function(a){return null!=a?a<0?this[a+this.length]:this[a]:f.call(this)},pushStack:function(a){var b=r.merge(this.constructor(),a);return b.prevObject=this,b},each:function(a){return r.each(this,a)},map:function(a){return this.pushStack(r.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(f.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:c.sort,splice:c.splice},r.extend=r.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||r.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(r.isPlainObject(d)||(e=r.isArray(d)))?(e?(e=!1,f=c&&r.isArray(c)?c:[]):f=c&&r.isPlainObject(c)?c:{},g[b]=r.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},r.extend({expando:"jQuery"+(q+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===r.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=r.type(a);return("number"===b||"string"===b)&&!isNaN(a-parseFloat(a))},isPlainObject:function(a){var b,c;return!(!a||"[object Object]"!==k.call(a))&&(!(b=e(a))||(c=l.call(b,"constructor")&&b.constructor,"function"==typeof c&&m.call(c)===n))},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?j[k.call(a)]||"object":typeof a},globalEval:function(a){p(a)},camelCase:function(a){return a.replace(t,"ms-").replace(u,v)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b){var c,d=0;if(w(a)){for(c=a.length;d<c;d++)if(b.call(a[d],d,a[d])===!1)break}else for(d in a)if(b.call(a[d],d,a[d])===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(s,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(w(Object(a))?r.merge(c,"string"==typeof a?[a]:a):h.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:i.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;f<g;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,e,f=0,h=[];if(w(a))for(d=a.length;f<d;f++)e=b(a[f],f,c),null!=e&&h.push(e);else for(f in a)e=b(a[f],f,c),null!=e&&h.push(e);return g.apply([],h)},guid:1,proxy:function(a,b){var c,d,e;if("string"==typeof b&&(c=a[b],b=a,a=c),r.isFunction(a))return d=f.call(arguments,2),e=function(){return a.apply(b||this,d.concat(f.call(arguments)))},e.guid=a.guid=a.guid||r.guid++,e},now:Date.now,support:o}),"function"==typeof Symbol&&(r.fn[Symbol.iterator]=c[Symbol.iterator]),r.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){j["[object "+b+"]"]=b.toLowerCase()});function w(a){var b=!!a&&"length"in a&&a.length,c=r.type(a);return"function"!==c&&!r.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a)}var x=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",L="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",M="\\["+K+"*("+L+")(?:"+K+"*([*^$|!~]?=)"+K+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+L+"))|)"+K+"*\\]",N=":("+L+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+M+")*)|.*)\\)|)",O=new RegExp(K+"+","g"),P=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),Q=new RegExp("^"+K+"*,"+K+"*"),R=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),S=new RegExp("="+K+"*([^\\]'\"]*?)"+K+"*\\]","g"),T=new RegExp(N),U=new RegExp("^"+L+"$"),V={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L+"|[*])"),ATTR:new RegExp("^"+M),PSEUDO:new RegExp("^"+N),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,_=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),aa=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ba=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,ca=function(a,b){return b?"\0"===a?"\ufffd":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a},da=function(){m()},ea=ta(function(a){return a.disabled===!0},{dir:"parentNode",next:"legend"});try{G.apply(D=H.call(v.childNodes),v.childNodes),D[v.childNodes.length].nodeType}catch(fa){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s=b&&b.ownerDocument,w=b?b.nodeType:9;if(d=d||[],"string"!=typeof a||!a||1!==w&&9!==w&&11!==w)return d;if(!e&&((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,p)){if(11!==w&&(l=Z.exec(a)))if(f=l[1]){if(9===w){if(!(j=b.getElementById(f)))return d;if(j.id===f)return d.push(j),d}else if(s&&(j=s.getElementById(f))&&t(b,j)&&j.id===f)return d.push(j),d}else{if(l[2])return G.apply(d,b.getElementsByTagName(a)),d;if((f=l[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(f)),d}if(c.qsa&&!A[a+" "]&&(!q||!q.test(a))){if(1!==w)s=b,r=a;else if("object"!==b.nodeName.toLowerCase()){(k=b.getAttribute("id"))?k=k.replace(ba,ca):b.setAttribute("id",k=u),o=g(a),h=o.length;while(h--)o[h]="#"+k+" "+sa(o[h]);r=o.join(","),s=$.test(a)&&qa(b.parentNode)||b}if(r)try{return G.apply(d,s.querySelectorAll(r)),d}catch(x){}finally{k===u&&b.removeAttribute("id")}}}return i(a.replace(P,"$1"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("fieldset");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split("|"),e=c.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return function(b){return"label"in b&&b.disabled===a||"form"in b&&b.disabled===a||"form"in b&&b.disabled===!1&&(b.isDisabled===a||b.isDisabled!==!a&&("label"in b||!ea(b))!==a)}}function pa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function qa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=n.documentElement,p=!f(n),v!==n&&(e=n.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",da,!1):e.attachEvent&&e.attachEvent("onunload",da)),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(n.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Y.test(n.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!n.getElementsByName||!n.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c?[c]:[]}},d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){if("undefined"!=typeof b.getElementsByClassName&&p)return b.getElementsByClassName(a)},r=[],q=[],(c.qsa=Y.test(n.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+K+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+K+"*(?:value|"+J+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){a.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var b=n.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+K+"*[*^$|!~]?="),2!==a.querySelectorAll(":enabled").length&&q.push(":enabled",":disabled"),o.appendChild(a).disabled=!0,2!==a.querySelectorAll(":disabled").length&&q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=Y.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"*"),s.call(a,"[s!='']:x"),r.push("!=",N)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=Y.test(o.compareDocumentPosition),t=b||Y.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===n||a.ownerDocument===v&&t(v,a)?-1:b===n||b.ownerDocument===v&&t(v,b)?1:k?I(k,a)-I(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,g=[a],h=[b];if(!e||!f)return a===n?-1:b===n?1:e?-1:f?1:k?I(k,a)-I(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)g.unshift(c);c=b;while(c=c.parentNode)h.unshift(c);while(g[d]===h[d])d++;return d?la(g[d],h[d]):g[d]===v?-1:h[d]===v?1:0},n):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(S,"='$1']"),c.matchesSelector&&p&&!A[b+" "]&&(!r||!r.test(b))&&(!q||!q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.escape=function(a){return(a+"").replace(ba,ca)},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(_,aa),a[3]=(a[3]||a[4]||a[5]||"").replace(_,aa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return V.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&T.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(_,aa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+K+")"+a+"("+K+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(O," ")+" ").indexOf(c)>-1:"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){while(p){m=b;while(m=m[p])if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){m=q,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n&&j[2],m=n&&q.childNodes[n];while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if(1===m.nodeType&&++t&&m===b){k[a]=[w,n,t];break}}else if(s&&(m=b,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n),t===!1)while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if((h?m.nodeName.toLowerCase()===r:1===m.nodeType)&&++t&&(s&&(l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[w,t]),m===b))break;return t-=e,t===d||t%d===0&&t/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(P,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(_,aa),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return U.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(_,aa).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:oa(!1),disabled:oa(!0),checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:pa(function(){return[0]}),last:pa(function(a,b){return[b-1]}),eq:pa(function(a,b,c){return[c<0?c+b:c]}),even:pa(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:pa(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:pa(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:pa(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function ra(){}ra.prototype=d.filters=d.pseudos,d.setFilters=new ra,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){c&&!(e=Q.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P," ")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function sa(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function ta(a,b,c){var d=b.dir,e=b.next,f=e||d,g=c&&"parentNode"===f,h=x++;return b.first?function(b,c,e){while(b=b[d])if(1===b.nodeType||g)return a(b,c,e)}:function(b,c,i){var j,k,l,m=[w,h];if(i){while(b=b[d])if((1===b.nodeType||g)&&a(b,c,i))return!0}else while(b=b[d])if(1===b.nodeType||g)if(l=b[u]||(b[u]={}),k=l[b.uniqueID]||(l[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[d]||b;else{if((j=k[f])&&j[0]===w&&j[1]===h)return m[2]=j[2];if(k[f]=m,m[2]=a(b,c,i))return!0}}}function ua(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function va(a,b,c){for(var d=0,e=b.length;d<e;d++)ga(a,b[d],c);return c}function wa(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function xa(a,b,c,d,e,f){return d&&!d[u]&&(d=xa(d)),e&&!e[u]&&(e=xa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||va(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:wa(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=wa(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=wa(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ya(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=ta(function(a){return a===b},h,!0),l=ta(function(a){return I(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];i<f;i++)if(c=d.relative[a[i].type])m=[ta(ua(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;e<f;e++)if(d.relative[a[e].type])break;return xa(i>1&&ua(m),i>1&&sa(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(P,"$1"),c,i<e&&ya(a.slice(i,e)),e<f&&ya(a=a.slice(e)),e<f&&sa(a))}m.push(c)}return ua(m)}function za(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,o,q,r=0,s="0",t=f&&[],u=[],v=j,x=f||e&&d.find.TAG("*",k),y=w+=null==v?1:Math.random()||.1,z=x.length;for(k&&(j=g===n||g||k);s!==z&&null!=(l=x[s]);s++){if(e&&l){o=0,g||l.ownerDocument===n||(m(l),h=!p);while(q=a[o++])if(q(l,g||n,h)){i.push(l);break}k&&(w=y)}c&&((l=!q&&l)&&r--,f&&t.push(l))}if(r+=s,c&&s!==r){o=0;while(q=b[o++])q(t,u,g,h);if(f){if(r>0)while(s--)t[s]||u[s]||(u[s]=E.call(i));u=wa(u)}G.apply(i,u),k&&!f&&u.length>0&&r+b.length>1&&ga.uniqueSort(i)}return k&&(w=y,j=v),t};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=ya(b[c]),f[u]?d.push(f):e.push(f);f=A(a,za(e,d)),f.selector=a}return f},i=ga.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(_,aa),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=V.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(_,aa),$.test(j[0].type)&&qa(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&sa(j),!a)return G.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,!b||$.test(a)&&qa(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("fieldset"))}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(J,function(a,b,c){var d;if(!c)return a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);r.find=x,r.expr=x.selectors,r.expr[":"]=r.expr.pseudos,r.uniqueSort=r.unique=x.uniqueSort,r.text=x.getText,r.isXMLDoc=x.isXML,r.contains=x.contains,r.escapeSelector=x.escape;var y=function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&r(a).is(c))break;d.push(a)}return d},z=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},A=r.expr.match.needsContext,B=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,C=/^.[^:#\[\.,]*$/;function D(a,b,c){if(r.isFunction(b))return r.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return r.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(C.test(b))return r.filter(b,a,c);b=r.filter(b,a)}return r.grep(a,function(a){return i.call(b,a)>-1!==c&&1===a.nodeType})}r.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?r.find.matchesSelector(d,a)?[d]:[]:r.find.matches(a,r.grep(b,function(a){return 1===a.nodeType}))},r.fn.extend({find:function(a){var b,c,d=this.length,e=this;if("string"!=typeof a)return this.pushStack(r(a).filter(function(){for(b=0;b<d;b++)if(r.contains(e[b],this))return!0}));for(c=this.pushStack([]),b=0;b<d;b++)r.find(a,e[b],c);return d>1?r.uniqueSort(c):c},filter:function(a){return this.pushStack(D(this,a||[],!1))},not:function(a){return this.pushStack(D(this,a||[],!0))},is:function(a){return!!D(this,"string"==typeof a&&A.test(a)?r(a):a||[],!1).length}});var E,F=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,G=r.fn.init=function(a,b,c){var e,f;if(!a)return this;if(c=c||E,"string"==typeof a){if(e="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:F.exec(a),!e||!e[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(e[1]){if(b=b instanceof r?b[0]:b,r.merge(this,r.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:d,!0)),B.test(e[1])&&r.isPlainObject(b))for(e in b)r.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e]);return this}return f=d.getElementById(e[2]),f&&(this[0]=f,this.length=1),this}return a.nodeType?(this[0]=a,this.length=1,this):r.isFunction(a)?void 0!==c.ready?c.ready(a):a(r):r.makeArray(a,this)};G.prototype=r.fn,E=r(d);var H=/^(?:parents|prev(?:Until|All))/,I={children:!0,contents:!0,next:!0,prev:!0};r.fn.extend({has:function(a){var b=r(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(r.contains(this,b[a]))return!0})},closest:function(a,b){var c,d=0,e=this.length,f=[],g="string"!=typeof a&&r(a);if(!A.test(a))for(;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&r.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?r.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?i.call(r(a),this[0]):i.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(r.uniqueSort(r.merge(this.get(),r(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function J(a,b){while((a=a[b])&&1!==a.nodeType);return a}r.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return y(a,"parentNode")},parentsUntil:function(a,b,c){return y(a,"parentNode",c)},next:function(a){return J(a,"nextSibling")},prev:function(a){return J(a,"previousSibling")},nextAll:function(a){return y(a,"nextSibling")},prevAll:function(a){return y(a,"previousSibling")},nextUntil:function(a,b,c){return y(a,"nextSibling",c)},prevUntil:function(a,b,c){return y(a,"previousSibling",c)},siblings:function(a){return z((a.parentNode||{}).firstChild,a)},children:function(a){return z(a.firstChild)},contents:function(a){return a.contentDocument||r.merge([],a.childNodes)}},function(a,b){r.fn[a]=function(c,d){var e=r.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=r.filter(d,e)),this.length>1&&(I[a]||r.uniqueSort(e),H.test(a)&&e.reverse()),this.pushStack(e)}});var K=/\S+/g;function L(a){var b={};return r.each(a.match(K)||[],function(a,c){b[c]=!0}),b}r.Callbacks=function(a){a="string"==typeof a?L(a):r.extend({},a);var b,c,d,e,f=[],g=[],h=-1,i=function(){for(e=a.once,d=b=!0;g.length;h=-1){c=g.shift();while(++h<f.length)f[h].apply(c[0],c[1])===!1&&a.stopOnFalse&&(h=f.length,c=!1)}a.memory||(c=!1),b=!1,e&&(f=c?[]:"")},j={add:function(){return f&&(c&&!b&&(h=f.length-1,g.push(c)),function d(b){r.each(b,function(b,c){r.isFunction(c)?a.unique&&j.has(c)||f.push(c):c&&c.length&&"string"!==r.type(c)&&d(c)})}(arguments),c&&!b&&i()),this},remove:function(){return r.each(arguments,function(a,b){var c;while((c=r.inArray(b,f,c))>-1)f.splice(c,1),c<=h&&h--}),this},has:function(a){return a?r.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=g=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=g=[],c||b||(f=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],g.push(c),b||i()),this},fire:function(){return j.fireWith(this,arguments),this},fired:function(){return!!d}};return j};function M(a){return a}function N(a){throw a}function O(a,b,c){var d;try{a&&r.isFunction(d=a.promise)?d.call(a).done(b).fail(c):a&&r.isFunction(d=a.then)?d.call(a,b,c):b.call(void 0,a)}catch(a){c.call(void 0,a)}}r.extend({Deferred:function(b){var c=[["notify","progress",r.Callbacks("memory"),r.Callbacks("memory"),2],["resolve","done",r.Callbacks("once memory"),r.Callbacks("once memory"),0,"resolved"],["reject","fail",r.Callbacks("once memory"),r.Callbacks("once memory"),1,"rejected"]],d="pending",e={state:function(){return d},always:function(){return f.done(arguments).fail(arguments),this},"catch":function(a){return e.then(null,a)},pipe:function(){var a=arguments;return r.Deferred(function(b){r.each(c,function(c,d){var e=r.isFunction(a[d[4]])&&a[d[4]];f[d[1]](function(){var a=e&&e.apply(this,arguments);a&&r.isFunction(a.promise)?a.promise().progress(b.notify).done(b.resolve).fail(b.reject):b[d[0]+"With"](this,e?[a]:arguments)})}),a=null}).promise()},then:function(b,d,e){var f=0;function g(b,c,d,e){return function(){var h=this,i=arguments,j=function(){var a,j;if(!(b<f)){if(a=d.apply(h,i),a===c.promise())throw new TypeError("Thenable self-resolution");j=a&&("object"==typeof a||"function"==typeof a)&&a.then,r.isFunction(j)?e?j.call(a,g(f,c,M,e),g(f,c,N,e)):(f++,j.call(a,g(f,c,M,e),g(f,c,N,e),g(f,c,M,c.notifyWith))):(d!==M&&(h=void 0,i=[a]),(e||c.resolveWith)(h,i))}},k=e?j:function(){try{j()}catch(a){r.Deferred.exceptionHook&&r.Deferred.exceptionHook(a,k.stackTrace),b+1>=f&&(d!==N&&(h=void 0,i=[a]),c.rejectWith(h,i))}};b?k():(r.Deferred.getStackHook&&(k.stackTrace=r.Deferred.getStackHook()),a.setTimeout(k))}}return r.Deferred(function(a){c[0][3].add(g(0,a,r.isFunction(e)?e:M,a.notifyWith)),c[1][3].add(g(0,a,r.isFunction(b)?b:M)),c[2][3].add(g(0,a,r.isFunction(d)?d:N))}).promise()},promise:function(a){return null!=a?r.extend(a,e):e}},f={};return r.each(c,function(a,b){var g=b[2],h=b[5];e[b[1]]=g.add,h&&g.add(function(){d=h},c[3-a][2].disable,c[0][2].lock),g.add(b[3].fire),f[b[0]]=function(){return f[b[0]+"With"](this===f?void 0:this,arguments),this},f[b[0]+"With"]=g.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(a){var b=arguments.length,c=b,d=Array(c),e=f.call(arguments),g=r.Deferred(),h=function(a){return function(c){d[a]=this,e[a]=arguments.length>1?f.call(arguments):c,--b||g.resolveWith(d,e)}};if(b<=1&&(O(a,g.done(h(c)).resolve,g.reject),"pending"===g.state()||r.isFunction(e[c]&&e[c].then)))return g.then();while(c--)O(e[c],h(c),g.reject);return g.promise()}});var P=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;r.Deferred.exceptionHook=function(b,c){a.console&&a.console.warn&&b&&P.test(b.name)&&a.console.warn("jQuery.Deferred exception: "+b.message,b.stack,c)},r.readyException=function(b){a.setTimeout(function(){throw b})};var Q=r.Deferred();r.fn.ready=function(a){return Q.then(a)["catch"](function(a){r.readyException(a)}),this},r.extend({isReady:!1,readyWait:1,holdReady:function(a){a?r.readyWait++:r.ready(!0)},ready:function(a){(a===!0?--r.readyWait:r.isReady)||(r.isReady=!0,a!==!0&&--r.readyWait>0||Q.resolveWith(d,[r]))}}),r.ready.then=Q.then;function R(){d.removeEventListener("DOMContentLoaded",R),a.removeEventListener("load",R),r.ready()}"complete"===d.readyState||"loading"!==d.readyState&&!d.documentElement.doScroll?a.setTimeout(r.ready):(d.addEventListener("DOMContentLoaded",R),a.addEventListener("load",R));var S=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===r.type(c)){e=!0;for(h in c)S(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,
r.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(r(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},T=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function U(){this.expando=r.expando+U.uid++}U.uid=1,U.prototype={cache:function(a){var b=a[this.expando];return b||(b={},T(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[r.camelCase(b)]=c;else for(d in b)e[r.camelCase(d)]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][r.camelCase(b)]},access:function(a,b,c){return void 0===b||b&&"string"==typeof b&&void 0===c?this.get(a,b):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d=a[this.expando];if(void 0!==d){if(void 0!==b){r.isArray(b)?b=b.map(r.camelCase):(b=r.camelCase(b),b=b in d?[b]:b.match(K)||[]),c=b.length;while(c--)delete d[b[c]]}(void 0===b||r.isEmptyObject(d))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!r.isEmptyObject(b)}};var V=new U,W=new U,X=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Y=/[A-Z]/g;function Z(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(Y,"-$&").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c||"false"!==c&&("null"===c?null:+c+""===c?+c:X.test(c)?JSON.parse(c):c)}catch(e){}W.set(a,b,c)}else c=void 0;return c}r.extend({hasData:function(a){return W.hasData(a)||V.hasData(a)},data:function(a,b,c){return W.access(a,b,c)},removeData:function(a,b){W.remove(a,b)},_data:function(a,b,c){return V.access(a,b,c)},_removeData:function(a,b){V.remove(a,b)}}),r.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=W.get(f),1===f.nodeType&&!V.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=r.camelCase(d.slice(5)),Z(f,d,e[d])));V.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){W.set(this,a)}):S(this,function(b){var c;if(f&&void 0===b){if(c=W.get(f,a),void 0!==c)return c;if(c=Z(f,a),void 0!==c)return c}else this.each(function(){W.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){W.remove(this,a)})}}),r.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=V.get(a,b),c&&(!d||r.isArray(c)?d=V.access(a,b,r.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=r.queue(a,b),d=c.length,e=c.shift(),f=r._queueHooks(a,b),g=function(){r.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return V.get(a,c)||V.access(a,c,{empty:r.Callbacks("once memory").add(function(){V.remove(a,[b+"queue",c])})})}}),r.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?r.queue(this[0],a):void 0===b?this:this.each(function(){var c=r.queue(this,a,b);r._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&r.dequeue(this,a)})},dequeue:function(a){return this.each(function(){r.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=r.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=V.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var $=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,_=new RegExp("^(?:([+-])=|)("+$+")([a-z%]*)$","i"),aa=["Top","Right","Bottom","Left"],ba=function(a,b){return a=b||a,"none"===a.style.display||""===a.style.display&&r.contains(a.ownerDocument,a)&&"none"===r.css(a,"display")},ca=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};function da(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return r.css(a,b,"")},i=h(),j=c&&c[3]||(r.cssNumber[b]?"":"px"),k=(r.cssNumber[b]||"px"!==j&&+i)&&_.exec(r.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do f=f||".5",k/=f,r.style(a,b,k+j);while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}var ea={};function fa(a){var b,c=a.ownerDocument,d=a.nodeName,e=ea[d];return e?e:(b=c.body.appendChild(c.createElement(d)),e=r.css(b,"display"),b.parentNode.removeChild(b),"none"===e&&(e="block"),ea[d]=e,e)}function ga(a,b){for(var c,d,e=[],f=0,g=a.length;f<g;f++)d=a[f],d.style&&(c=d.style.display,b?("none"===c&&(e[f]=V.get(d,"display")||null,e[f]||(d.style.display="")),""===d.style.display&&ba(d)&&(e[f]=fa(d))):"none"!==c&&(e[f]="none",V.set(d,"display",c)));for(f=0;f<g;f++)null!=e[f]&&(a[f].style.display=e[f]);return a}r.fn.extend({show:function(){return ga(this,!0)},hide:function(){return ga(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){ba(this)?r(this).show():r(this).hide()})}});var ha=/^(?:checkbox|radio)$/i,ia=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ja=/^$|\/(?:java|ecma)script/i,ka={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ka.optgroup=ka.option,ka.tbody=ka.tfoot=ka.colgroup=ka.caption=ka.thead,ka.th=ka.td;function la(a,b){var c="undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName(b||"*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&r.nodeName(a,b)?r.merge([a],c):c}function ma(a,b){for(var c=0,d=a.length;c<d;c++)V.set(a[c],"globalEval",!b||V.get(b[c],"globalEval"))}var na=/<|&#?\w+;/;function oa(a,b,c,d,e){for(var f,g,h,i,j,k,l=b.createDocumentFragment(),m=[],n=0,o=a.length;n<o;n++)if(f=a[n],f||0===f)if("object"===r.type(f))r.merge(m,f.nodeType?[f]:f);else if(na.test(f)){g=g||l.appendChild(b.createElement("div")),h=(ia.exec(f)||["",""])[1].toLowerCase(),i=ka[h]||ka._default,g.innerHTML=i[1]+r.htmlPrefilter(f)+i[2],k=i[0];while(k--)g=g.lastChild;r.merge(m,g.childNodes),g=l.firstChild,g.textContent=""}else m.push(b.createTextNode(f));l.textContent="",n=0;while(f=m[n++])if(d&&r.inArray(f,d)>-1)e&&e.push(f);else if(j=r.contains(f.ownerDocument,f),g=la(l.appendChild(f),"script"),j&&ma(g),c){k=0;while(f=g[k++])ja.test(f.type||"")&&c.push(f)}return l}!function(){var a=d.createDocumentFragment(),b=a.appendChild(d.createElement("div")),c=d.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),o.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",o.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var pa=d.documentElement,qa=/^key/,ra=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,sa=/^([^.]*)(?:\.(.+)|)/;function ta(){return!0}function ua(){return!1}function va(){try{return d.activeElement}catch(a){}}function wa(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)wa(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),e===!1)e=ua;else if(!e)return a;return 1===f&&(g=e,e=function(a){return r().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=r.guid++)),a.each(function(){r.event.add(this,b,e,d,c)})}r.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=V.get(a);if(q){c.handler&&(f=c,c=f.handler,e=f.selector),e&&r.find.matchesSelector(pa,e),c.guid||(c.guid=r.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return"undefined"!=typeof r&&r.event.triggered!==b.type?r.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(K)||[""],j=b.length;while(j--)h=sa.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=r.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=r.event.special[n]||{},k=r.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&r.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),r.event.global[n]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=V.hasData(a)&&V.get(a);if(q&&(i=q.events)){b=(b||"").match(K)||[""],j=b.length;while(j--)if(h=sa.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){l=r.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||r.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)r.event.remove(a,n+b[j],c,d,!0);r.isEmptyObject(i)&&V.remove(a,"handle events")}},dispatch:function(a){var b=r.event.fix(a),c,d,e,f,g,h,i=new Array(arguments.length),j=(V.get(this,"events")||{})[b.type]||[],k=r.event.special[b.type]||{};for(i[0]=b,c=1;c<arguments.length;c++)i[c]=arguments[c];if(b.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,b)!==!1){h=r.event.handlers.call(this,b,j),c=0;while((f=h[c++])&&!b.isPropagationStopped()){b.currentTarget=f.elem,d=0;while((g=f.handlers[d++])&&!b.isImmediatePropagationStopped())b.rnamespace&&!b.rnamespace.test(g.namespace)||(b.handleObj=g,b.data=g.data,e=((r.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(b.result=e)===!1&&(b.preventDefault(),b.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,b),b.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&("click"!==a.type||isNaN(a.button)||a.button<1))for(;i!==this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(d=[],c=0;c<h;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?r(e,this).index(i)>-1:r.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},addProp:function(a,b){Object.defineProperty(r.Event.prototype,a,{enumerable:!0,configurable:!0,get:r.isFunction(b)?function(){if(this.originalEvent)return b(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[a]},set:function(b){Object.defineProperty(this,a,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(a){return a[r.expando]?a:new r.Event(a)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==va()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===va()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&r.nodeName(this,"input"))return this.click(),!1},_default:function(a){return r.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},r.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},r.Event=function(a,b){return this instanceof r.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?ta:ua,this.target=a.target&&3===a.target.nodeType?a.target.parentNode:a.target,this.currentTarget=a.currentTarget,this.relatedTarget=a.relatedTarget):this.type=a,b&&r.extend(this,b),this.timeStamp=a&&a.timeStamp||r.now(),void(this[r.expando]=!0)):new r.Event(a,b)},r.Event.prototype={constructor:r.Event,isDefaultPrevented:ua,isPropagationStopped:ua,isImmediatePropagationStopped:ua,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=ta,a&&!this.isSimulated&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=ta,a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=ta,a&&!this.isSimulated&&a.stopImmediatePropagation(),this.stopPropagation()}},r.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(a){var b=a.button;return null==a.which&&qa.test(a.type)?null!=a.charCode?a.charCode:a.keyCode:!a.which&&void 0!==b&&ra.test(a.type)?1&b?1:2&b?3:4&b?2:0:a.which}},r.event.addProp),r.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){r.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||r.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),r.fn.extend({on:function(a,b,c,d){return wa(this,a,b,c,d)},one:function(a,b,c,d){return wa(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,r(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return b!==!1&&"function"!=typeof b||(c=b,b=void 0),c===!1&&(c=ua),this.each(function(){r.event.remove(this,a,c,b)})}});var xa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,ya=/<script|<style|<link/i,za=/checked\s*(?:[^=]|=\s*.checked.)/i,Aa=/^true\/(.*)/,Ba=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ca(a,b){return r.nodeName(a,"table")&&r.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a:a}function Da(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function Ea(a){var b=Aa.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function Fa(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(V.hasData(a)&&(f=V.access(a),g=V.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;c<d;c++)r.event.add(b,e,j[e][c])}W.hasData(a)&&(h=W.access(a),i=r.extend({},h),W.set(b,i))}}function Ga(a,b){var c=b.nodeName.toLowerCase();"input"===c&&ha.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function Ha(a,b,c,d){b=g.apply([],b);var e,f,h,i,j,k,l=0,m=a.length,n=m-1,q=b[0],s=r.isFunction(q);if(s||m>1&&"string"==typeof q&&!o.checkClone&&za.test(q))return a.each(function(e){var f=a.eq(e);s&&(b[0]=q.call(this,e,f.html())),Ha(f,b,c,d)});if(m&&(e=oa(b,a[0].ownerDocument,!1,a,d),f=e.firstChild,1===e.childNodes.length&&(e=f),f||d)){for(h=r.map(la(e,"script"),Da),i=h.length;l<m;l++)j=e,l!==n&&(j=r.clone(j,!0,!0),i&&r.merge(h,la(j,"script"))),c.call(a[l],j,l);if(i)for(k=h[h.length-1].ownerDocument,r.map(h,Ea),l=0;l<i;l++)j=h[l],ja.test(j.type||"")&&!V.access(j,"globalEval")&&r.contains(k,j)&&(j.src?r._evalUrl&&r._evalUrl(j.src):p(j.textContent.replace(Ba,""),k))}return a}function Ia(a,b,c){for(var d,e=b?r.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||r.cleanData(la(d)),d.parentNode&&(c&&r.contains(d.ownerDocument,d)&&ma(la(d,"script")),d.parentNode.removeChild(d));return a}r.extend({htmlPrefilter:function(a){return a.replace(xa,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=r.contains(a.ownerDocument,a);if(!(o.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||r.isXMLDoc(a)))for(g=la(h),f=la(a),d=0,e=f.length;d<e;d++)Ga(f[d],g[d]);if(b)if(c)for(f=f||la(a),g=g||la(h),d=0,e=f.length;d<e;d++)Fa(f[d],g[d]);else Fa(a,h);return g=la(h,"script"),g.length>0&&ma(g,!i&&la(a,"script")),h},cleanData:function(a){for(var b,c,d,e=r.event.special,f=0;void 0!==(c=a[f]);f++)if(T(c)){if(b=c[V.expando]){if(b.events)for(d in b.events)e[d]?r.event.remove(c,d):r.removeEvent(c,d,b.handle);c[V.expando]=void 0}c[W.expando]&&(c[W.expando]=void 0)}}}),r.fn.extend({detach:function(a){return Ia(this,a,!0)},remove:function(a){return Ia(this,a)},text:function(a){return S(this,function(a){return void 0===a?r.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return Ha(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Ca(this,a);b.appendChild(a)}})},prepend:function(){return Ha(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Ca(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return Ha(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return Ha(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(r.cleanData(la(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return r.clone(this,a,b)})},html:function(a){return S(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!ya.test(a)&&!ka[(ia.exec(a)||["",""])[1].toLowerCase()]){a=r.htmlPrefilter(a);try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(r.cleanData(la(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return Ha(this,arguments,function(b){var c=this.parentNode;r.inArray(this,a)<0&&(r.cleanData(la(this)),c&&c.replaceChild(b,this))},a)}}),r.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){r.fn[a]=function(a){for(var c,d=[],e=r(a),f=e.length-1,g=0;g<=f;g++)c=g===f?this:this.clone(!0),r(e[g])[b](c),h.apply(d,c.get());return this.pushStack(d)}});var Ja=/^margin/,Ka=new RegExp("^("+$+")(?!px)[a-z%]+$","i"),La=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)};!function(){function b(){if(i){i.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",i.innerHTML="",pa.appendChild(h);var b=a.getComputedStyle(i);c="1%"!==b.top,g="2px"===b.marginLeft,e="4px"===b.width,i.style.marginRight="50%",f="4px"===b.marginRight,pa.removeChild(h),i=null}}var c,e,f,g,h=d.createElement("div"),i=d.createElement("div");i.style&&(i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",o.clearCloneStyle="content-box"===i.style.backgroundClip,h.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",h.appendChild(i),r.extend(o,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return b(),e},pixelMarginRight:function(){return b(),f},reliableMarginLeft:function(){return b(),g}}))}();function Ma(a,b,c){var d,e,f,g,h=a.style;return c=c||La(a),c&&(g=c.getPropertyValue(b)||c[b],""!==g||r.contains(a.ownerDocument,a)||(g=r.style(a,b)),!o.pixelMarginRight()&&Ka.test(g)&&Ja.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function Na(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}var Oa=/^(none|table(?!-c[ea]).+)/,Pa={position:"absolute",visibility:"hidden",display:"block"},Qa={letterSpacing:"0",fontWeight:"400"},Ra=["Webkit","Moz","ms"],Sa=d.createElement("div").style;function Ta(a){if(a in Sa)return a;var b=a[0].toUpperCase()+a.slice(1),c=Ra.length;while(c--)if(a=Ra[c]+b,a in Sa)return a}function Ua(a,b,c){var d=_.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function Va(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;f<4;f+=2)"margin"===c&&(g+=r.css(a,c+aa[f],!0,e)),d?("content"===c&&(g-=r.css(a,"padding"+aa[f],!0,e)),"margin"!==c&&(g-=r.css(a,"border"+aa[f]+"Width",!0,e))):(g+=r.css(a,"padding"+aa[f],!0,e),"padding"!==c&&(g+=r.css(a,"border"+aa[f]+"Width",!0,e)));return g}function Wa(a,b,c){var d,e=!0,f=La(a),g="border-box"===r.css(a,"boxSizing",!1,f);if(a.getClientRects().length&&(d=a.getBoundingClientRect()[b]),d<=0||null==d){if(d=Ma(a,b,f),(d<0||null==d)&&(d=a.style[b]),Ka.test(d))return d;e=g&&(o.boxSizingReliable()||d===a.style[b]),d=parseFloat(d)||0}return d+Va(a,b,c||(g?"border":"content"),e,f)+"px"}r.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Ma(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=r.camelCase(b),i=a.style;return b=r.cssProps[h]||(r.cssProps[h]=Ta(h)||h),g=r.cssHooks[b]||r.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=_.exec(c))&&e[1]&&(c=da(a,b,e),f="number"),null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(r.cssNumber[h]?"":"px")),o.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=r.camelCase(b);return b=r.cssProps[h]||(r.cssProps[h]=Ta(h)||h),g=r.cssHooks[b]||r.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=Ma(a,b,d)),"normal"===e&&b in Qa&&(e=Qa[b]),""===c||c?(f=parseFloat(e),c===!0||isFinite(f)?f||0:e):e}}),r.each(["height","width"],function(a,b){r.cssHooks[b]={get:function(a,c,d){if(c)return!Oa.test(r.css(a,"display"))||a.getClientRects().length&&a.getBoundingClientRect().width?Wa(a,b,d):ca(a,Pa,function(){return Wa(a,b,d)})},set:function(a,c,d){var e,f=d&&La(a),g=d&&Va(a,b,d,"border-box"===r.css(a,"boxSizing",!1,f),f);return g&&(e=_.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=r.css(a,b)),Ua(a,c,g)}}}),r.cssHooks.marginLeft=Na(o.reliableMarginLeft,function(a,b){if(b)return(parseFloat(Ma(a,"marginLeft"))||a.getBoundingClientRect().left-ca(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px"}),r.each({margin:"",padding:"",border:"Width"},function(a,b){r.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+aa[d]+b]=f[d]||f[d-2]||f[0];return e}},Ja.test(a)||(r.cssHooks[a+b].set=Ua)}),r.fn.extend({css:function(a,b){return S(this,function(a,b,c){var d,e,f={},g=0;if(r.isArray(b)){for(d=La(a),e=b.length;g<e;g++)f[b[g]]=r.css(a,b[g],!1,d);return f}return void 0!==c?r.style(a,b,c):r.css(a,b)},a,b,arguments.length>1)}});function Xa(a,b,c,d,e){return new Xa.prototype.init(a,b,c,d,e)}r.Tween=Xa,Xa.prototype={constructor:Xa,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||r.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(r.cssNumber[c]?"":"px")},cur:function(){var a=Xa.propHooks[this.prop];return a&&a.get?a.get(this):Xa.propHooks._default.get(this)},run:function(a){var b,c=Xa.propHooks[this.prop];return this.options.duration?this.pos=b=r.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Xa.propHooks._default.set(this),this}},Xa.prototype.init.prototype=Xa.prototype,Xa.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=r.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){r.fx.step[a.prop]?r.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[r.cssProps[a.prop]]&&!r.cssHooks[a.prop]?a.elem[a.prop]=a.now:r.style(a.elem,a.prop,a.now+a.unit)}}},Xa.propHooks.scrollTop=Xa.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},r.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},r.fx=Xa.prototype.init,r.fx.step={};var Ya,Za,$a=/^(?:toggle|show|hide)$/,_a=/queueHooks$/;function ab(){Za&&(a.requestAnimationFrame(ab),r.fx.tick())}function bb(){return a.setTimeout(function(){Ya=void 0}),Ya=r.now()}function cb(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)c=aa[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function db(a,b,c){for(var d,e=(gb.tweeners[b]||[]).concat(gb.tweeners["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function eb(a,b,c){var d,e,f,g,h,i,j,k,l="width"in b||"height"in b,m=this,n={},o=a.style,p=a.nodeType&&ba(a),q=V.get(a,"fxshow");c.queue||(g=r._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,m.always(function(){m.always(function(){g.unqueued--,r.queue(a,"fx").length||g.empty.fire()})}));for(d in b)if(e=b[d],$a.test(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}n[d]=q&&q[d]||r.style(a,d)}if(i=!r.isEmptyObject(b),i||!r.isEmptyObject(n)){l&&1===a.nodeType&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=q&&q.display,null==j&&(j=V.get(a,"display")),k=r.css(a,"display"),"none"===k&&(j?k=j:(ga([a],!0),j=a.style.display||j,k=r.css(a,"display"),ga([a]))),("inline"===k||"inline-block"===k&&null!=j)&&"none"===r.css(a,"float")&&(i||(m.done(function(){o.display=j}),null==j&&(k=o.display,j="none"===k?"":k)),o.display="inline-block")),c.overflow&&(o.overflow="hidden",m.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]})),i=!1;for(d in n)i||(q?"hidden"in q&&(p=q.hidden):q=V.access(a,"fxshow",{display:j}),f&&(q.hidden=!p),p&&ga([a],!0),m.done(function(){p||ga([a]),V.remove(a,"fxshow");for(d in n)r.style(a,d,n[d])})),i=db(p?q[d]:0,d,m),d in q||(q[d]=i.start,p&&(i.end=i.start,i.start=0))}}function fb(a,b){var c,d,e,f,g;for(c in a)if(d=r.camelCase(c),e=b[d],f=a[c],r.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=r.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function gb(a,b,c){var d,e,f=0,g=gb.prefilters.length,h=r.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Ya||bb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:r.extend({},b),opts:r.extend(!0,{specialEasing:{},easing:r.easing._default},c),originalProperties:b,originalOptions:c,startTime:Ya||bb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=r.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(fb(k,j.opts.specialEasing);f<g;f++)if(d=gb.prefilters[f].call(j,a,k,j.opts))return r.isFunction(d.stop)&&(r._queueHooks(j.elem,j.opts.queue).stop=r.proxy(d.stop,d)),d;return r.map(k,db,j),r.isFunction(j.opts.start)&&j.opts.start.call(a,j),r.fx.timer(r.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}r.Animation=r.extend(gb,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return da(c.elem,a,_.exec(b),c),c}]},tweener:function(a,b){r.isFunction(a)?(b=a,a=["*"]):a=a.match(K);for(var c,d=0,e=a.length;d<e;d++)c=a[d],gb.tweeners[c]=gb.tweeners[c]||[],gb.tweeners[c].unshift(b)},prefilters:[eb],prefilter:function(a,b){b?gb.prefilters.unshift(a):gb.prefilters.push(a)}}),r.speed=function(a,b,c){var e=a&&"object"==typeof a?r.extend({},a):{complete:c||!c&&b||r.isFunction(a)&&a,duration:a,easing:c&&b||b&&!r.isFunction(b)&&b};return r.fx.off||d.hidden?e.duration=0:e.duration="number"==typeof e.duration?e.duration:e.duration in r.fx.speeds?r.fx.speeds[e.duration]:r.fx.speeds._default,null!=e.queue&&e.queue!==!0||(e.queue="fx"),e.old=e.complete,e.complete=function(){r.isFunction(e.old)&&e.old.call(this),e.queue&&r.dequeue(this,e.queue)},e},r.fn.extend({fadeTo:function(a,b,c,d){return this.filter(ba).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=r.isEmptyObject(a),f=r.speed(b,c,d),g=function(){var b=gb(this,r.extend({},a),f);(e||V.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=r.timers,g=V.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&_a.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||r.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=V.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=r.timers,g=d?d.length:0;for(c.finish=!0,r.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),r.each(["toggle","show","hide"],function(a,b){var c=r.fn[b];r.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(cb(b,!0),a,d,e)}}),r.each({slideDown:cb("show"),slideUp:cb("hide"),slideToggle:cb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){r.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),r.timers=[],r.fx.tick=function(){var a,b=0,c=r.timers;for(Ya=r.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||r.fx.stop(),Ya=void 0},r.fx.timer=function(a){r.timers.push(a),a()?r.fx.start():r.timers.pop()},r.fx.interval=13,r.fx.start=function(){Za||(Za=a.requestAnimationFrame?a.requestAnimationFrame(ab):a.setInterval(r.fx.tick,r.fx.interval))},r.fx.stop=function(){a.cancelAnimationFrame?a.cancelAnimationFrame(Za):a.clearInterval(Za),Za=null},r.fx.speeds={slow:600,fast:200,_default:400},r.fn.delay=function(b,c){return b=r.fx?r.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=d.createElement("input"),b=d.createElement("select"),c=b.appendChild(d.createElement("option"));a.type="checkbox",o.checkOn=""!==a.value,o.optSelected=c.selected,a=d.createElement("input"),a.value="t",a.type="radio",o.radioValue="t"===a.value}();var hb,ib=r.expr.attrHandle;r.fn.extend({attr:function(a,b){return S(this,r.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){r.removeAttr(this,a)})}}),r.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return"undefined"==typeof a.getAttribute?r.prop(a,b,c):(1===f&&r.isXMLDoc(a)||(e=r.attrHooks[b.toLowerCase()]||(r.expr.match.bool.test(b)?hb:void 0)),void 0!==c?null===c?void r.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=r.find.attr(a,b),null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!o.radioValue&&"radio"===b&&r.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d=0,e=b&&b.match(K);
if(e&&1===a.nodeType)while(c=e[d++])a.removeAttribute(c)}}),hb={set:function(a,b,c){return b===!1?r.removeAttr(a,c):a.setAttribute(c,c),c}},r.each(r.expr.match.bool.source.match(/\w+/g),function(a,b){var c=ib[b]||r.find.attr;ib[b]=function(a,b,d){var e,f,g=b.toLowerCase();return d||(f=ib[g],ib[g]=e,e=null!=c(a,b,d)?g:null,ib[g]=f),e}});var jb=/^(?:input|select|textarea|button)$/i,kb=/^(?:a|area)$/i;r.fn.extend({prop:function(a,b){return S(this,r.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[r.propFix[a]||a]})}}),r.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&r.isXMLDoc(a)||(b=r.propFix[b]||b,e=r.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=r.find.attr(a,"tabindex");return b?parseInt(b,10):jb.test(a.nodeName)||kb.test(a.nodeName)&&a.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),o.optSelected||(r.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),r.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){r.propFix[this.toLowerCase()]=this});var lb=/[\t\r\n\f]/g;function mb(a){return a.getAttribute&&a.getAttribute("class")||""}r.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).addClass(a.call(this,b,mb(this)))});if("string"==typeof a&&a){b=a.match(K)||[];while(c=this[i++])if(e=mb(c),d=1===c.nodeType&&(" "+e+" ").replace(lb," ")){g=0;while(f=b[g++])d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=r.trim(d),e!==h&&c.setAttribute("class",h)}}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).removeClass(a.call(this,b,mb(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a){b=a.match(K)||[];while(c=this[i++])if(e=mb(c),d=1===c.nodeType&&(" "+e+" ").replace(lb," ")){g=0;while(f=b[g++])while(d.indexOf(" "+f+" ")>-1)d=d.replace(" "+f+" "," ");h=r.trim(d),e!==h&&c.setAttribute("class",h)}}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):r.isFunction(a)?this.each(function(c){r(this).toggleClass(a.call(this,c,mb(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c){d=0,e=r(this),f=a.match(K)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else void 0!==a&&"boolean"!==c||(b=mb(this),b&&V.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||a===!1?"":V.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;b=" "+a+" ";while(c=this[d++])if(1===c.nodeType&&(" "+mb(c)+" ").replace(lb," ").indexOf(b)>-1)return!0;return!1}});var nb=/\r/g,ob=/[\x20\t\r\n\f]+/g;r.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=r.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,r(this).val()):a,null==e?e="":"number"==typeof e?e+="":r.isArray(e)&&(e=r.map(e,function(a){return null==a?"":a+""})),b=r.valHooks[this.type]||r.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=r.valHooks[e.type]||r.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(nb,""):null==c?"":c)}}}),r.extend({valHooks:{option:{get:function(a){var b=r.find.attr(a,"value");return null!=b?b:r.trim(r.text(a)).replace(ob," ")}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type,g=f?null:[],h=f?e+1:d.length,i=e<0?h:f?e:0;i<h;i++)if(c=d[i],(c.selected||i===e)&&!c.disabled&&(!c.parentNode.disabled||!r.nodeName(c.parentNode,"optgroup"))){if(b=r(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=r.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=r.inArray(r.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),r.each(["radio","checkbox"],function(){r.valHooks[this]={set:function(a,b){if(r.isArray(b))return a.checked=r.inArray(r(a).val(),b)>-1}},o.checkOn||(r.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var pb=/^(?:focusinfocus|focusoutblur)$/;r.extend(r.event,{trigger:function(b,c,e,f){var g,h,i,j,k,m,n,o=[e||d],p=l.call(b,"type")?b.type:b,q=l.call(b,"namespace")?b.namespace.split("."):[];if(h=i=e=e||d,3!==e.nodeType&&8!==e.nodeType&&!pb.test(p+r.event.triggered)&&(p.indexOf(".")>-1&&(q=p.split("."),p=q.shift(),q.sort()),k=p.indexOf(":")<0&&"on"+p,b=b[r.expando]?b:new r.Event(p,"object"==typeof b&&b),b.isTrigger=f?2:3,b.namespace=q.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=e),c=null==c?[b]:r.makeArray(c,[b]),n=r.event.special[p]||{},f||!n.trigger||n.trigger.apply(e,c)!==!1)){if(!f&&!n.noBubble&&!r.isWindow(e)){for(j=n.delegateType||p,pb.test(j+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),i=h;i===(e.ownerDocument||d)&&o.push(i.defaultView||i.parentWindow||a)}g=0;while((h=o[g++])&&!b.isPropagationStopped())b.type=g>1?j:n.bindType||p,m=(V.get(h,"events")||{})[b.type]&&V.get(h,"handle"),m&&m.apply(h,c),m=k&&h[k],m&&m.apply&&T(h)&&(b.result=m.apply(h,c),b.result===!1&&b.preventDefault());return b.type=p,f||b.isDefaultPrevented()||n._default&&n._default.apply(o.pop(),c)!==!1||!T(e)||k&&r.isFunction(e[p])&&!r.isWindow(e)&&(i=e[k],i&&(e[k]=null),r.event.triggered=p,e[p](),r.event.triggered=void 0,i&&(e[k]=i)),b.result}},simulate:function(a,b,c){var d=r.extend(new r.Event,c,{type:a,isSimulated:!0});r.event.trigger(d,null,b)}}),r.fn.extend({trigger:function(a,b){return this.each(function(){r.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return r.event.trigger(a,b,c,!0)}}),r.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(a,b){r.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),r.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),o.focusin="onfocusin"in a,o.focusin||r.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){r.event.simulate(b,a.target,r.event.fix(a))};r.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=V.access(d,b);e||d.addEventListener(a,c,!0),V.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=V.access(d,b)-1;e?V.access(d,b,e):(d.removeEventListener(a,c,!0),V.remove(d,b))}}});var qb=a.location,rb=r.now(),sb=/\?/;r.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,"text/xml")}catch(d){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||r.error("Invalid XML: "+b),c};var tb=/\[\]$/,ub=/\r?\n/g,vb=/^(?:submit|button|image|reset|file)$/i,wb=/^(?:input|select|textarea|keygen)/i;function xb(a,b,c,d){var e;if(r.isArray(b))r.each(b,function(b,e){c||tb.test(a)?d(a,e):xb(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==r.type(b))d(a,b);else for(e in b)xb(a+"["+e+"]",b[e],c,d)}r.param=function(a,b){var c,d=[],e=function(a,b){var c=r.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(null==c?"":c)};if(r.isArray(a)||a.jquery&&!r.isPlainObject(a))r.each(a,function(){e(this.name,this.value)});else for(c in a)xb(c,a[c],b,e);return d.join("&")},r.fn.extend({serialize:function(){return r.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=r.prop(this,"elements");return a?r.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!r(this).is(":disabled")&&wb.test(this.nodeName)&&!vb.test(a)&&(this.checked||!ha.test(a))}).map(function(a,b){var c=r(this).val();return null==c?null:r.isArray(c)?r.map(c,function(a){return{name:b.name,value:a.replace(ub,"\r\n")}}):{name:b.name,value:c.replace(ub,"\r\n")}}).get()}});var yb=/%20/g,zb=/#.*$/,Ab=/([?&])_=[^&]*/,Bb=/^(.*?):[ \t]*([^\r\n]*)$/gm,Cb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Db=/^(?:GET|HEAD)$/,Eb=/^\/\//,Fb={},Gb={},Hb="*/".concat("*"),Ib=d.createElement("a");Ib.href=qb.href;function Jb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(K)||[];if(r.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Kb(a,b,c,d){var e={},f=a===Gb;function g(h){var i;return e[h]=!0,r.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Lb(a,b){var c,d,e=r.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&r.extend(!0,a,d),a}function Mb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}if(f)return f!==i[0]&&i.unshift(f),c[f]}function Nb(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}r.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:qb.href,type:"GET",isLocal:Cb.test(qb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Hb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":r.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Lb(Lb(a,r.ajaxSettings),b):Lb(r.ajaxSettings,a)},ajaxPrefilter:Jb(Fb),ajaxTransport:Jb(Gb),ajax:function(b,c){"object"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m,n,o=r.ajaxSetup({},c),p=o.context||o,q=o.context&&(p.nodeType||p.jquery)?r(p):r.event,s=r.Deferred(),t=r.Callbacks("once memory"),u=o.statusCode||{},v={},w={},x="canceled",y={readyState:0,getResponseHeader:function(a){var b;if(k){if(!h){h={};while(b=Bb.exec(g))h[b[1].toLowerCase()]=b[2]}b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return k?g:null},setRequestHeader:function(a,b){return null==k&&(a=w[a.toLowerCase()]=w[a.toLowerCase()]||a,v[a]=b),this},overrideMimeType:function(a){return null==k&&(o.mimeType=a),this},statusCode:function(a){var b;if(a)if(k)y.always(a[y.status]);else for(b in a)u[b]=[u[b],a[b]];return this},abort:function(a){var b=a||x;return e&&e.abort(b),A(0,b),this}};if(s.promise(y),o.url=((b||o.url||qb.href)+"").replace(Eb,qb.protocol+"//"),o.type=c.method||c.type||o.method||o.type,o.dataTypes=(o.dataType||"*").toLowerCase().match(K)||[""],null==o.crossDomain){j=d.createElement("a");try{j.href=o.url,j.href=j.href,o.crossDomain=Ib.protocol+"//"+Ib.host!=j.protocol+"//"+j.host}catch(z){o.crossDomain=!0}}if(o.data&&o.processData&&"string"!=typeof o.data&&(o.data=r.param(o.data,o.traditional)),Kb(Fb,o,c,y),k)return y;l=r.event&&o.global,l&&0===r.active++&&r.event.trigger("ajaxStart"),o.type=o.type.toUpperCase(),o.hasContent=!Db.test(o.type),f=o.url.replace(zb,""),o.hasContent?o.data&&o.processData&&0===(o.contentType||"").indexOf("application/x-www-form-urlencoded")&&(o.data=o.data.replace(yb,"+")):(n=o.url.slice(f.length),o.data&&(f+=(sb.test(f)?"&":"?")+o.data,delete o.data),o.cache===!1&&(f=f.replace(Ab,""),n=(sb.test(f)?"&":"?")+"_="+rb++ +n),o.url=f+n),o.ifModified&&(r.lastModified[f]&&y.setRequestHeader("If-Modified-Since",r.lastModified[f]),r.etag[f]&&y.setRequestHeader("If-None-Match",r.etag[f])),(o.data&&o.hasContent&&o.contentType!==!1||c.contentType)&&y.setRequestHeader("Content-Type",o.contentType),y.setRequestHeader("Accept",o.dataTypes[0]&&o.accepts[o.dataTypes[0]]?o.accepts[o.dataTypes[0]]+("*"!==o.dataTypes[0]?", "+Hb+"; q=0.01":""):o.accepts["*"]);for(m in o.headers)y.setRequestHeader(m,o.headers[m]);if(o.beforeSend&&(o.beforeSend.call(p,y,o)===!1||k))return y.abort();if(x="abort",t.add(o.complete),y.done(o.success),y.fail(o.error),e=Kb(Gb,o,c,y)){if(y.readyState=1,l&&q.trigger("ajaxSend",[y,o]),k)return y;o.async&&o.timeout>0&&(i=a.setTimeout(function(){y.abort("timeout")},o.timeout));try{k=!1,e.send(v,A)}catch(z){if(k)throw z;A(-1,z)}}else A(-1,"No Transport");function A(b,c,d,h){var j,m,n,v,w,x=c;k||(k=!0,i&&a.clearTimeout(i),e=void 0,g=h||"",y.readyState=b>0?4:0,j=b>=200&&b<300||304===b,d&&(v=Mb(o,y,d)),v=Nb(o,v,y,j),j?(o.ifModified&&(w=y.getResponseHeader("Last-Modified"),w&&(r.lastModified[f]=w),w=y.getResponseHeader("etag"),w&&(r.etag[f]=w)),204===b||"HEAD"===o.type?x="nocontent":304===b?x="notmodified":(x=v.state,m=v.data,n=v.error,j=!n)):(n=x,!b&&x||(x="error",b<0&&(b=0))),y.status=b,y.statusText=(c||x)+"",j?s.resolveWith(p,[m,x,y]):s.rejectWith(p,[y,x,n]),y.statusCode(u),u=void 0,l&&q.trigger(j?"ajaxSuccess":"ajaxError",[y,o,j?m:n]),t.fireWith(p,[y,x]),l&&(q.trigger("ajaxComplete",[y,o]),--r.active||r.event.trigger("ajaxStop")))}return y},getJSON:function(a,b,c){return r.get(a,b,c,"json")},getScript:function(a,b){return r.get(a,void 0,b,"script")}}),r.each(["get","post"],function(a,b){r[b]=function(a,c,d,e){return r.isFunction(c)&&(e=e||d,d=c,c=void 0),r.ajax(r.extend({url:a,type:b,dataType:e,data:c,success:d},r.isPlainObject(a)&&a))}}),r._evalUrl=function(a){return r.ajax({url:a,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},r.fn.extend({wrapAll:function(a){var b;return this[0]&&(r.isFunction(a)&&(a=a.call(this[0])),b=r(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this},wrapInner:function(a){return r.isFunction(a)?this.each(function(b){r(this).wrapInner(a.call(this,b))}):this.each(function(){var b=r(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=r.isFunction(a);return this.each(function(c){r(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(a){return this.parent(a).not("body").each(function(){r(this).replaceWith(this.childNodes)}),this}}),r.expr.pseudos.hidden=function(a){return!r.expr.pseudos.visible(a)},r.expr.pseudos.visible=function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},r.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(b){}};var Ob={0:200,1223:204},Pb=r.ajaxSettings.xhr();o.cors=!!Pb&&"withCredentials"in Pb,o.ajax=Pb=!!Pb,r.ajaxTransport(function(b){var c,d;if(o.cors||Pb&&!b.crossDomain)return{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Ob[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(b.hasContent&&b.data||null)}catch(i){if(c)throw i}},abort:function(){c&&c()}}}),r.ajaxPrefilter(function(a){a.crossDomain&&(a.contents.script=!1)}),r.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return r.globalEval(a),a}}}),r.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),r.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(e,f){b=r("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&f("error"===a.type?404:200,a.type)}),d.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Qb=[],Rb=/(=)\?(?=&|$)|\?\?/;r.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Qb.pop()||r.expando+"_"+rb++;return this[a]=!0,a}}),r.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Rb.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Rb.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=r.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Rb,"$1"+e):b.jsonp!==!1&&(b.url+=(sb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||r.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?r(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Qb.push(e)),g&&r.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),o.createHTMLDocument=function(){var a=d.implementation.createHTMLDocument("").body;return a.innerHTML="<form></form><form></form>",2===a.childNodes.length}(),r.parseHTML=function(a,b,c){if("string"!=typeof a)return[];"boolean"==typeof b&&(c=b,b=!1);var e,f,g;return b||(o.createHTMLDocument?(b=d.implementation.createHTMLDocument(""),e=b.createElement("base"),e.href=d.location.href,b.head.appendChild(e)):b=d),f=B.exec(a),g=!c&&[],f?[b.createElement(f[1])]:(f=oa([a],b,g),g&&g.length&&r(g).remove(),r.merge([],f.childNodes))},r.fn.load=function(a,b,c){var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=r.trim(a.slice(h)),a=a.slice(0,h)),r.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&r.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?r("<div>").append(r.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},r.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){r.fn[b]=function(a){return this.on(b,a)}}),r.expr.pseudos.animated=function(a){return r.grep(r.timers,function(b){return a===b.elem}).length};function Sb(a){return r.isWindow(a)?a:9===a.nodeType&&a.defaultView}r.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=r.css(a,"position"),l=r(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=r.css(a,"top"),i=r.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),r.isFunction(b)&&(b=b.call(a,c,r.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},r.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){r.offset.setOffset(this,a,b)});var b,c,d,e,f=this[0];if(f)return f.getClientRects().length?(d=f.getBoundingClientRect(),d.width||d.height?(e=f.ownerDocument,c=Sb(e),b=e.documentElement,{top:d.top+c.pageYOffset-b.clientTop,left:d.left+c.pageXOffset-b.clientLeft}):d):{top:0,left:0}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===r.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),r.nodeName(a[0],"html")||(d=a.offset()),d={top:d.top+r.css(a[0],"borderTopWidth",!0),left:d.left+r.css(a[0],"borderLeftWidth",!0)}),{top:b.top-d.top-r.css(c,"marginTop",!0),left:b.left-d.left-r.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent;while(a&&"static"===r.css(a,"position"))a=a.offsetParent;return a||pa})}}),r.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;r.fn[a]=function(d){return S(this,function(a,d,e){var f=Sb(a);return void 0===e?f?f[b]:a[d]:void(f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e)},a,d,arguments.length)}}),r.each(["top","left"],function(a,b){r.cssHooks[b]=Na(o.pixelPosition,function(a,c){if(c)return c=Ma(a,b),Ka.test(c)?r(a).position()[b]+"px":c})}),r.each({Height:"height",Width:"width"},function(a,b){r.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){r.fn[d]=function(e,f){var g=arguments.length&&(c||"boolean"!=typeof e),h=c||(e===!0||f===!0?"margin":"border");return S(this,function(b,c,e){var f;return r.isWindow(b)?0===d.indexOf("outer")?b["inner"+a]:b.document.documentElement["client"+a]:9===b.nodeType?(f=b.documentElement,Math.max(b.body["scroll"+a],f["scroll"+a],b.body["offset"+a],f["offset"+a],f["client"+a])):void 0===e?r.css(b,c,h):r.style(b,c,e,h)},b,g?e:void 0,g)}})}),r.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}}),r.parseJSON=JSON.parse,"function"==typeof define&&define.amd&&define("jquery",[],function(){return r});var Tb=a.jQuery,Ub=a.$;return r.noConflict=function(b){return a.$===r&&(a.$=Ub),b&&a.jQuery===r&&(a.jQuery=Tb),r},b||(a.jQuery=a.$=r),r});
/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,j,i){var h,d=0;if(typeof f!=="boolean"){i=j;j=f;f=c}function g(){var o=this,m=+new Date()-d,n=arguments;function l(){d=+new Date();j.apply(o,n)}function k(){h=c}if(i&&!h){l()}h&&clearTimeout(h);if(i===c&&m>e){l()}else{if(f!==true){h=setTimeout(i?k:l,i===c?e-m:e)}}}if($.guid){g.guid=j.guid=j.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);
/*!
 * imagesLoaded PACKAGED v4.1.0
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
!function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}(this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},n=i[t]=i[t]||[];return n[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=0,o=i[n];e=e||[];for(var r=this._onceEvents&&this._onceEvents[t];o;){var s=r&&r[o];s&&(this.off(t,o),delete r[o]),o.apply(this,e),n+=s?0:1,o=i[n]}return this}},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter")):t.imagesLoaded=e(t,t.EvEmitter)}(window,function(t,e){function i(t,e){for(var i in e)t[i]=e[i];return t}function n(t){var e=[];if(Array.isArray(t))e=t;else if("number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e}function o(t,e,r){return this instanceof o?("string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=n(t),this.options=i({},this.options),"function"==typeof e?r=e:i(this.options,e),r&&this.on("always",r),this.getImages(),h&&(this.jqDeferred=new h.Deferred),void setTimeout(function(){this.check()}.bind(this))):new o(t,e,r)}function r(t){this.img=t}function s(t,e){this.url=t,this.element=e,this.img=new Image}var h=t.jQuery,a=t.console;o.prototype=Object.create(e.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),this.options.background===!0&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&d[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var r=t.querySelectorAll(this.options.background);for(n=0;n<r.length;n++){var s=r[n];this.addElementBackgroundImages(s)}}}};var d={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,t),n=i.exec(e.backgroundImage)}},o.prototype.addImage=function(t){var e=new r(t);this.images.push(e)},o.prototype.addBackground=function(t,e){var i=new s(t,e);this.images.push(i)},o.prototype.check=function(){function t(t,i,n){setTimeout(function(){e.progress(t,i,n)})}var e=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},o.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,t,e)},o.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},r.prototype=Object.create(e.prototype),r.prototype.check=function(){var t=this.getIsImageComplete();return t?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},r.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},r.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},r.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype=Object.create(r.prototype),s.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var t=this.getIsImageComplete();t&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},s.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},o.makeJQueryPlugin=function(e){e=e||t.jQuery,e&&(h=e,h.fn.imagesLoaded=function(t,e){var i=new o(this,t,e);return i.jqDeferred.promise(h(this))})},o.makeJQueryPlugin(),o});
/*! lz-string-1.3.3-min.js | (c) 2013 Pieroxy | Licensed under a WTFPL license */
var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(e==null)return"";var t="";var n,r,i,s,o,u,a;var f=0;e=LZString.compress(e);while(f<e.length*2){if(f%2==0){n=e.charCodeAt(f/2)>>8;r=e.charCodeAt(f/2)&255;if(f/2+1<e.length)i=e.charCodeAt(f/2+1)>>8;else i=NaN}else{n=e.charCodeAt((f-1)/2)&255;if((f+1)/2<e.length){r=e.charCodeAt((f+1)/2)>>8;i=e.charCodeAt((f+1)/2)&255}else r=i=NaN}f+=3;s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+LZString._keyStr.charAt(s)+LZString._keyStr.charAt(o)+LZString._keyStr.charAt(u)+LZString._keyStr.charAt(a)}return t},decompressFromBase64:function(e){if(e==null)return"";var t="",n=0,r,i,s,o,u,a,f,l,c=0,h=LZString._f;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<e.length){u=LZString._keyStr.indexOf(e.charAt(c++));a=LZString._keyStr.indexOf(e.charAt(c++));f=LZString._keyStr.indexOf(e.charAt(c++));l=LZString._keyStr.indexOf(e.charAt(c++));i=u<<2|a>>4;s=(a&15)<<4|f>>2;o=(f&3)<<6|l;if(n%2==0){r=i<<8;if(f!=64){t+=h(r|s)}if(l!=64){r=o<<8}}else{t=t+h(r|i);if(f!=64){r=s<<8}if(l!=64){t+=h(r|o)}}n+=3}return LZString.decompress(t)},compressToUTF16:function(e){if(e==null)return"";var t="",n,r,i,s=0,o=LZString._f;e=LZString.compress(e);for(n=0;n<e.length;n++){r=e.charCodeAt(n);switch(s++){case 0:t+=o((r>>1)+32);i=(r&1)<<14;break;case 1:t+=o(i+(r>>2)+32);i=(r&3)<<13;break;case 2:t+=o(i+(r>>3)+32);i=(r&7)<<12;break;case 3:t+=o(i+(r>>4)+32);i=(r&15)<<11;break;case 4:t+=o(i+(r>>5)+32);i=(r&31)<<10;break;case 5:t+=o(i+(r>>6)+32);i=(r&63)<<9;break;case 6:t+=o(i+(r>>7)+32);i=(r&127)<<8;break;case 7:t+=o(i+(r>>8)+32);i=(r&255)<<7;break;case 8:t+=o(i+(r>>9)+32);i=(r&511)<<6;break;case 9:t+=o(i+(r>>10)+32);i=(r&1023)<<5;break;case 10:t+=o(i+(r>>11)+32);i=(r&2047)<<4;break;case 11:t+=o(i+(r>>12)+32);i=(r&4095)<<3;break;case 12:t+=o(i+(r>>13)+32);i=(r&8191)<<2;break;case 13:t+=o(i+(r>>14)+32);i=(r&16383)<<1;break;case 14:t+=o(i+(r>>15)+32,(r&32767)+32);s=0;break}}return t+o(i+32)},decompressFromUTF16:function(e){if(e==null)return"";var t="",n,r,i=0,s=0,o=LZString._f;while(s<e.length){r=e.charCodeAt(s)-32;switch(i++){case 0:n=r<<1;break;case 1:t+=o(n|r>>14);n=(r&16383)<<2;break;case 2:t+=o(n|r>>13);n=(r&8191)<<3;break;case 3:t+=o(n|r>>12);n=(r&4095)<<4;break;case 4:t+=o(n|r>>11);n=(r&2047)<<5;break;case 5:t+=o(n|r>>10);n=(r&1023)<<6;break;case 6:t+=o(n|r>>9);n=(r&511)<<7;break;case 7:t+=o(n|r>>8);n=(r&255)<<8;break;case 8:t+=o(n|r>>7);n=(r&127)<<9;break;case 9:t+=o(n|r>>6);n=(r&63)<<10;break;case 10:t+=o(n|r>>5);n=(r&31)<<11;break;case 11:t+=o(n|r>>4);n=(r&15)<<12;break;case 12:t+=o(n|r>>3);n=(r&7)<<13;break;case 13:t+=o(n|r>>2);n=(r&3)<<14;break;case 14:t+=o(n|r>>1);n=(r&1)<<15;break;case 15:t+=o(n|r);i=0;break}s++}return LZString.decompress(t)},compress:function(e){if(e==null)return"";var t,n,r={},i={},s="",o="",u="",a=2,f=3,l=2,c="",h=0,p=0,d,v=LZString._f;for(d=0;d<e.length;d+=1){s=e.charAt(d);if(!Object.prototype.hasOwnProperty.call(r,s)){r[s]=f++;i[s]=true}o=u+s;if(Object.prototype.hasOwnProperty.call(r,o)){u=o}else{if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}r[o]=f++;u=String(s)}}if(u!==""){if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}}n=2;for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}while(true){h=h<<1;if(p==15){c+=v(h);break}else p++}return c},decompress:function(e){if(e==null)return"";if(e=="")return null;var t=[],n,r=4,i=4,s=3,o="",u="",a,f,l,c,h,p,d,v=LZString._f,m={string:e,val:e.charCodeAt(0),position:32768,index:1};for(a=0;a<3;a+=1){t[a]=a}l=0;h=Math.pow(2,2);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(n=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 2:return""}t[3]=d;f=u=d;while(true){if(m.index>m.string.length){return""}l=0;h=Math.pow(2,s);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(d=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 2:return u}if(r==0){r=Math.pow(2,s);s++}if(t[d]){o=t[d]}else{if(d===i){o=f+f.charAt(0)}else{return null}}u+=o;t[i++]=f+o.charAt(0);r--;f=o;if(r==0){r=Math.pow(2,s);s++}}}};if(typeof module!=="undefined"&&module!=null){module.exports=LZString}
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var saveAs=saveAs||navigator.msSaveBlob&&navigator.msSaveBlob.bind(navigator)||function(e){"use strict";var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=e.URL||e.webkitURL||e,i=t.createElementNS("http://www.w3.org/1999/xhtml","a"),s="download"in i,o=function(n){var r=t.createEvent("MouseEvents");r.initMouseEvent("click",true,false,e,0,0,0,0,0,false,false,false,false,0,null);n.dispatchEvent(r)},u=e.webkitRequestFileSystem,a=e.requestFileSystem||u||e.mozRequestFileSystem,f=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},l="application/octet-stream",c=0,h=[],p=function(){var e=h.length;while(e--){var t=h[e];if(typeof t==="string"){r.revokeObjectURL(t)}else{t.remove()}}h.length=0},d=function(e,t,n){t=[].concat(t);var r=t.length;while(r--){var i=e["on"+t[r]];if(typeof i==="function"){try{i.call(e,n||e)}catch(s){f(s)}}}},v=function(t,r){var f=this,p=t.type,v=false,m,g,y=function(){var e=n().createObjectURL(t);h.push(e);return e},b=function(){d(f,"writestart progress write writeend".split(" "))},w=function(){if(v||!m){m=y(t)}if(g){g.location.href=m}else{window.open(m,"_blank")}f.readyState=f.DONE;b()},E=function(e){return function(){if(f.readyState!==f.DONE){return e.apply(this,arguments)}}},S={create:true,exclusive:false},x;f.readyState=f.INIT;if(!r){r="download"}if(s){m=y(t);i.href=m;i.download=r;o(i);f.readyState=f.DONE;b();return}if(e.chrome&&p&&p!==l){x=t.slice||t.webkitSlice;t=x.call(t,0,t.size,l);v=true}if(u&&r!=="download"){r+=".download"}if(p===l||u){g=e}if(!a){w();return}c+=t.size;a(e.TEMPORARY,c,E(function(e){e.root.getDirectory("saved",S,E(function(e){var n=function(){e.getFile(r,S,E(function(e){e.createWriter(E(function(n){n.onwriteend=function(t){g.location.href=e.toURL();h.push(e);f.readyState=f.DONE;d(f,"writeend",t)};n.onerror=function(){var e=n.error;if(e.code!==e.ABORT_ERR){w()}};"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=f["on"+e]});n.write(t);f.abort=function(){n.abort();f.readyState=f.DONE};f.readyState=f.WRITING}),w)}),w)};e.getFile(r,{create:false},E(function(e){e.remove();n()}),E(function(e){if(e.code===e.NOT_FOUND_ERR){n()}else{w()}}))}),w)}),w)},m=v.prototype,g=function(e,t){return new v(e,t)};m.abort=function(){var e=this;e.readyState=e.DONE;d(e,"abort")};m.readyState=m.INIT=0;m.WRITING=1;m.DONE=2;m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null;e.addEventListener("unload",p,false);return g}(self)
/*! seedrandom.js v2.3.3 | (c) 2013 David Bau, all rights reserved. | Licensed under a BSD-style license */
!function(a,b,c,d,e,f,g,h,i){function j(a){var b,c=a.length,e=this,f=0,g=e.i=e.j=0,h=e.S=[];for(c||(a=[c++]);d>f;)h[f]=f++;for(f=0;d>f;f++)h[f]=h[g=r&g+a[f%c]+(b=h[f])],h[g]=b;(e.g=function(a){for(var b,c=0,f=e.i,g=e.j,h=e.S;a--;)b=h[f=r&f+1],c=c*d+h[r&(h[f]=h[g=r&g+b])+(h[g]=b)];return e.i=f,e.j=g,c})(d)}function k(a,b){var c,d=[],e=typeof a;if(b&&"object"==e)for(c in a)try{d.push(k(a[c],b-1))}catch(f){}return d.length?d:"string"==e?a:a+"\0"}function l(a,b){for(var c,d=a+"",e=0;e<d.length;)b[r&e]=r&(c^=19*b[r&e])+d.charCodeAt(e++);return n(b)}function m(c){try{return a.crypto.getRandomValues(c=new Uint8Array(d)),n(c)}catch(e){return[+new Date,a,(c=a.navigator)&&c.plugins,a.screen,n(b)]}}function n(a){return String.fromCharCode.apply(0,a)}var o=c.pow(d,e),p=c.pow(2,f),q=2*p,r=d-1,s=c["seed"+i]=function(a,f,g){var h=[],r=l(k(f?[a,n(b)]:null==a?m():a,3),h),s=new j(h);return l(n(s.S),b),(g||function(a,b,d){return d?(c[i]=a,b):a})(function(){for(var a=s.g(e),b=o,c=0;p>a;)a=(a+c)*d,b*=d,c=s.g(1);for(;a>=q;)a/=2,b/=2,c>>>=1;return(a+c)/b},r,this==c)};l(c[i](),b),g&&g.exports?g.exports=s:h&&h.amd&&h(function(){return s})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random");
/*! console_hack.js | (c) 2015 Thomas Michael Edwards | Licensed under SugarCube's Simple BSD license */
!function(){for(var methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],length=methods.length,noop=function(){},console=window.console=window.console||{};length--;){var method=methods[length];console[method]||(console[method]=noop)}}();
}else{document.documentElement.className="init-lacking"}
</script>
<style id="style-normalize" type="text/css">/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}</style>
<style id="style-init-screen" type="text/css">#init-screen{display:none;z-index:100000;position:fixed;top:0;left:0;height:100%;width:100%;font-size:28px;text-align:center}#init-screen p{display:none;width:75%;margin:2em auto;font-weight:700;font-style:italic}#init-loading progress{height:20px}html.init-lacking #init-screen,html.init-loading #init-screen,html.init-no-js #init-screen{display:block}html.init-no-js #init-no-js{display:block}html.init-lacking #init-lacking{display:block}html.init-loading #init-loading{display:block}html.init-loading #passages,html.init-loading #ui-bar{display:none}html.init-no-js #init-no-js,noscript{color:red;font-weight:700}</style>
<style id="style-fonts" type="text/css">@font-face{font-family:tme-fa-icons;src:url(data:application/octet-stream;base64,d09GRgABAAAAACWoAA4AAAAAQhQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABRAAAAEQAAABWPihI/2NtYXAAAAGIAAAAOgAAAUrQXRm3Y3Z0IAAAAcQAAAAKAAAACgAAAABmcGdtAAAB0AAABZQAAAtwiJCQWWdhc3AAAAdkAAAACAAAAAgAAAAQZ2x5ZgAAB2wAABjCAAAq+uJ4WNtoZWFkAAAgMAAAADQAAAA2BZlJs2hoZWEAACBkAAAAIAAAACQIJwQZaG10eAAAIIQAAABuAAABOPTeAABsb2NhAAAg9AAAAJ4AAACeojKW6m1heHAAACGUAAAAIAAAACAA6gvwbmFtZQAAIbQAAAGPAAAC/eLsyKlwb3N0AAAjRAAAAfwAAAM0412SIHByZXAAACVAAAAAZQAAAHvdawOFeJxjYGRWYZzAwMrAwVTFtIeBgaEHQjM+YDBkZGJgYGJgZWbACgLSXFMYHF4wvPBhDvqfxRDFHMQwDSjMCJIDANLeC6V4nGNgYGBmgGAZBkYGEHAB8hjBfBYGDSDNBqQZGZgYGF74/P8PUvCCAURLMELVAwEjG8OIBwC4Ywb6AAAAAAAAAAAAAAAAAAB4nK1WaXMTRxCd1WHLNj6CDxI2gVnGcox2VpjLCBDG7EoW4BzylexCjl1Ldu6LT/wG/ZpekVSRb/y0vB4d2GAnVVQoSv2m9+1M9+ueXpPQksReWI+k3HwpprY2aWTnSUg3bFqO4kPZ2QspU0z+LoiCaLXUvu04JCISgap1hSWC2PfI0iTjQ48yWrYlvWpSbulJd9kaD+qt+vbT0FGO3QklNZuhQ+uRLanCqBJFMu2RkjYtw9VfSVrh5yvMfNUMJYLoJJLGm2EMj+Rn44xWGa3GdhxFkU2WG0WKRDM8iCKPslpin1wxQUD5oBlSXvk0onyEH5EVe5TTCnHJdprf9yU/6R3OvyTieouyJQf+QHZkB3unK/ki0toK46adbEehivB0fSfEI5uT6p/sUV7TaOB2RaYnzQiWyleQWPkJZfYPyWrhfMqXPBrVkoOcCFovc2Jf8g60HkdMiWsmyILujk6IoO6XnKHYY/q4+OO9XSwXIQTIOJb1jkq4EEYpYbOaJG0EOYiSskWV1HpHTJzyOi3iLWG/Tu3oS2e0Sag7MZ6th46tnKjkeDSp00ymTu2k5tGUBlFKOhM85tcBlB/RJK+2sZrEyqNpbDNjJJFQoIVzaSqIZSeWNAXRPJrRm7thmmvXokWaPFDPPXpPb26Fmzs9p+3AP2v8Z3UqpoO9MJ2eDshKfJp2uUnRun56hn8m8UPWAiqRLTbDlMVDtn4H5eVjS47CawNs957zK+h99kTIpIH4G/AeL9UpBUyFmFVQC9201rUsy9RqVotUZOq7IU0rX9ZpAk05Dn1jX8Y4/q+ZGUtMCd/vxOnZEZeeufYlyDSH3GZdj+Z1arFdgM5sz+k0y/Z9nebYfqDTPNvzOh1ha+t0lO2HOi2w/UinY2wvaEGT7jsEchGBXMAGEoGwdRAI20sIhK1CIGwXEQjbIgJhu4RA2H6MQNguIxC2l7Wsmn4qaRw7E8sARYgDoznuyGVuKldTyaUSrotGpzbkKXKrpKJ4Vv0rA/3ikTesgbVAukTW/IpJrnxUleOPrmh508S5Ao5Vf3tzXJ8TD2W/WPhT8L/amqqkV6x5ZHIVeSPQk+NE1yYVj67p8rmqR9f/i4oOa4F+A6UQC0VZlg2+mZDwUafTUA1c5RAzGzMP1/W6Zc3P4fybGCEL6H78NxQaC9yDTllJWe1gr9XXj2W5twflsCdYkmK+zOtb4YuMzEr7RWYpez7yecAVMCqVYasNXK3gzXsS85DpTfJMELcVZYOkjceZILGBYx4wb76TICRMXbWB2imcsIG8YMwp2O+EQ1RvlOVwe6F9Ho2Uf2tX7MgZFU0Q+G32Rtjrs1DyW6yBhCe/1NdAVSFNxbipgEsj5YZq8GFcrdtGMk6gr6jYDcuyig8fR9x3So5lIPlIEatHRz+tvUKd1Ln9yihu3zv9CIJBaWL+9r6Z4qCUd7WSZVZtA1O3GpVT15rDxasO3c2j7nvH2Sdy1jTddE/c9L6mVbeDg7lZEO3bHJSlTC6o68MOG6jLzaXQ6mVckt52DzAsMKDfoRUb/1f3cfg8V6oKo+NIvZ2oH6PPYgzyDzh/R/UF6OcxTLmGlOd7lxOfbtzD2TJdxV2sn+LfwKy15mbpGnBD0w2Yh6xaHbrKDXynBjo90tyO9BDwse4K8QBgE8Bi8InuWsbzKYDxfMYcH+Bz5jBoMofBFnMYbDNnDWCHOQx2mcNgjzkMvmDOOsCXzGEQModBxBwGT5gTADxlDoOvmMPga+Yw+IY59wG+ZQ6DmDkMEuYw2Nd0ayhzixd0F6htUBXowPQTFvewONRUGbK/44Vhf28Qs38wiKk/aro9pP7EC0P92SCm/mIQU3/VdGdI/Y0Xhvq7QUz9wyCmPtMvxnKZwV9GvkuFA8ouNp/z98T7B8IaQLYAAQAB//8AD3icrToNcBzVefe9/b3dvd29u909/dyd7ke6k86yLEunOyHJsrCxJWyJGmEcLMDYxBhHNsZQBzOAkjQmFDrGIq5gHEIcCILOAGZq3IQO04RkIGkgaUMKMbQznSlJW0wgJtOQHxRr1e+93TvJwq7JTD3y2/f//bzvfX/vAhAIzL3KPcYNBFIB8UR9EJYuAcuAqGNbOiwDSczkuorlaJ6WTeVSRwMIDveY8aN20GztjzMhW4P2H+kNUPM5NaVNQE0K3tWM77vv8rJqgnT33VJE4WWIfd/QbKHZjcXcZiFAqjCDgUJA/mZTWOIIwi0vAwNiUjkW9THIZs6DAbnj6ffGP/P+0y2vv+5SXGLKuXHJPJH92c+yT7x3883wnI9W/DxI4T9+bm7uOL+MUwNywAg0BJYFQgNKa2NDzFBEjqeM0SFXLHU4YKe7yjFoSmdEKWw5nemOUj5czMXCliilM7lyuFgqp3HaDf1j/fhH+s6cfm4MEpA8c0BSQBO5CUkD5fJi05kDjSUoNnETTUUSXtpPVm0aGHDdmV0nNkPiMUWeHZMVRSZPSlp0dqypCKVG8iT9IK5AEeamyZGAjecW5tm5SSBm8ojiSqBsYoXDTRtuymw13V8axjB+p2EPlsMGcRzTTRkGOLRpmk/AzSZ+A97ecx+QN8g9gUbc26F7N+GJiN5pLGMA8hUo7EQcHI455A0PwrS3I37N+bZhTE8bex1aeeIJ4+MTjTY6gcH+iIvgGWQRdh2TR9sS81kspCzytguLfBcyuBOLXuhwYnZnh8NFUs6plLPLScGpWBKwkYztwsop7Hie9r7rYK/9brWXTg9U+RiBX+GJiyc0rgIv7UNJe3vPjrFdyZOV/byNUkyW/0AuIi/h+h6U5a64SmW5ieGcya2AYimG+EUtnZN08ImgveV+KOYykiiJVMrbkI+dHUkC9+nyPUFdD94j639r1uTq7FiSNrR1hXS8uLbGapYUSbpaJvzmp5aODbU9iJNBU1gJa5LFTCqihNpDigmWWtc2GjUy7Y2m3hHk14qmPJXp2cTInZudO85dhzw2AuXAJQHl+Yt7l0RVjkO8u4q5JZARE2A5yNxStNgGWcQSj7izA1HucCgJOsRsb7xYWgn9XAwvRqaN4HAS4ENF3kXFFovJ/muW3zsYDK3jxaCQbOouOPXZPmBDNZG4krS0N2/9wakf7hHv+IcPX/jcaGWZAp9fvrFtv66UeSlXn4zYdZo5kLNwIJJRTbEu3jz62Zf37Xv5l7RAeugZfAQ7kJ5koA3PoJB1eP8MpHRVWqpygyITpiKz4DCoHMENlun+wrDA0bNZ9jmJZdZwhhx9UnewMKztg2yAlie9j6O7Lzrks7tYdRdOO4u/FJ9e5G93RyFTJ1f5G17IZDs7z25uEfuFBYwlvYpUUuTnKJO6umg5IymD88yGGxbycjN2JOkIVk6wUoEzm/0O5T/Owb92Jg8NyL/6qFrl30IZ5nSgMp3nch7DkvOMCaMeoQ1U4JZxQncenmAMmcAei/S7V9CvAccW8mczwtMCceSQ8nwhXWuKAeQPJbRCc9RnhoSyhvBL+WgxTzsk0Y567IFj+35wa4Xq7ykS5YIm7UIdq4iCfKcsiIoSvFFWONUnFovZoXHKhXE69R9hTOIEgZPcJ0VZRrx+i3j9hhtFPqQDnYjX8uaEpS2+F4twiVkOylSJAwfvBZO3XBnoTaEHtltSWAGKIEl3SJIQ1CRESIRnLFtJRc88GckEbQuOBTO5zBXziL0JIPKiyMtzggwiMc+czmbDEbDMbJaLhC3LPzPuFOKaD6zEM+tt15gNxTPLIg5dvglCfGmbmakYmqmKsEfRVOWWAXjqvEzVeamT6botq9321Vu2rIb7KOrufmZ24LWmoiI3yspJJ65e704JprBSFGH3pxXLhAQe9fBzbM1rq7YAm1dsctvZSiqu8G94rxwS/LQ7JYorRR0XXq/GmSh4dJADKAsSk70ajQ8gHdE0MhzVjOCbVDSvKINd1PhKVN+fgMTG2zYCvIaq+V2mmsNTP36IRLD6xO7ejWTDisfc7zCVD6tQW+/eMTW1Y3fSt20foe+hBZpQ3zfGfH3vyzmCZNvHFoJFVPrRjj7m6I26M3r7KHQxgD5c2H/4tQdIeJLJ+yQDvTsZOwv4jYfJQxVaxxmtKtNTTVaQnRmS6kkWvfBoNvCeIT55jt41PJZwpg3YYeJYGK+dppgK/sF+R/8ggZIOBlnyNoK/qpwokLZ6uCFRKCTKV8HeGaYksPg2Xj/3fyQZb6dhGWv2QLLQU4DW7lZwf77Hw+vb3AjzexKIVywkEXoGlB1JUqr4FW3A7BZlDzgzhZ5W0tyfI1da7mmn13JvsZOFxLuJIRsmLXJVskByA41iu/uvSds9bWOnPZQ4lSgANm+xqQ6gMPlGH2YR79rSDIXLXQBujHZSxkCpSIeynwCdNxEFJ2HVmSDaFPxQYoIN2BfCM8E6zTCu66VDSQ97KkPfIa8i7nGUITNAZagDhYFJjeg5rXh+bcBuYamT/JWmRVE8Iopeb/3ud1ZdSIs4TkQLcaogJ63Z5dGUxEfefz8qSKko+Qm2PB/ZgyEEMngmjkjovYB0GBog+n9COzD7MiQ73pfOA5S8NLseIst+QWbPC9y/J8dRv7QFliCNWcnzAYlI3fE8hdNVbBPY1WEeZxm8m5mKOdypQRG1qhiRgQBnZbr7N20qT1ipoPsLVYWEGq8hE3BoLPn2tV8PhWVe0WTB4nIN3WMD7cmIiDZEhaSSROulWMbk2+sX4LIs0Iq4NNdUfV3mDeqCbaEOligmbYSFCaU0VRVULrhTKoKlIMubNvV3ZyyOByWMilXkBpNjcIjihTjBrwzF/bmKF1iMJNsHxrobcnxElDVF0C3u69fevP5txIsEcUrVZyR96DPqiI/C+zGTp0uZGkXVP6PG1RncET7Ey/eKjnX885QeWw83krsCIVyvMp8TD9P3rEvMFUkFZxS6Rw25ytWQJ/52/tqLyQSDrc7Dpiq/H2XDgYsVBgjnK7BF95EwLKLNKLh0bg5x74VXPNwJO1fq7raB588j7pbhat78pDKjPE1td1Jl6Hhn8Q73LdISsCrrgwuijljQ28Tinnavx+Xu9ap6jYqn2QzNaly7RoVJ99MoBl/DvmtU1X0Lu3FCnO37XXKEW832Nai8BYnDKKvIF92W3F9dotK94ahCNyJPuW+5b2L1WrQ2X6fSc1TBejLg77uvsm8FX2b1ghWk6cbjuB1FUIVm9y0f6aMKfMbdhjshNGihFKgIgE7044ZvkbXz+zbh3chXN/f35Z6mOyF2b/m7H6V7HVV3XYOYtiDOig/J25bh+xPuAPMdxRPRc8V1YU8Z2mEv9OIO2O6DTg8Wtt2C3+lCcjBRmEaNVbDhi0nLnUK1ttvqdVpsexruQ93WGnf3T9s47N+te7nN5FeohRGeChUfIvZx5htAPYTNjQl/ea/tTlkW7LZ7nIK3dyNsGUwWpq0+a4k/ALvozB5nurkCqwthUdrq5mnzBD/tu5rpfPVYuC6L0VZwnMfd/YnGxgTc97jjFNjGFvRQ6iyrYPfZjyPVyQJM233YRF5YVb1xgLzjwVMX3NOwZ/K7wtJZx4W8pGRNNzf4ZOBeCKgPCxuKcUYmxQNycbjP5wGlEJGk8OZc369tR3gtaZ+X6CbmVkIONRVJcugpluk1TQL1Fqmfy1ELVi4hYy1zJhYNj4zu7RkfbuebN17fv+q2Fj4sDgtE7Hv2uk89uneIH7j9yNWjR1YMmUvJSzO6s9QcGWkbHt83PtzW0yWCMMLr4roNcMm+o88e3XdJ/0VDkWiFDxSv5YhXq8d3nVAryjjtoDXp7Ojn2gg6ijGHIUxDpQZ0Y2lQym2+5NZHN219to8XhsUw33Lb6p6dG9DVGN598/bmkXA0NoPeR2t4qO/h0U8d3bcKtmB5yeilos6PCCB29fgINjeNmEsdfaYmGhm6qB9RrPhEx7mrEbfGwCDauZXNJo09wLJ1oAhSe1NxWkUDKKJofMqeE+szt8S4K9JYmjbLXRRtylOU1vWN//mVy4/0DVGNqM9QJT7SvL287ot5MSZoGC/oyHTWO7p3vdd5s6RB439/5fKH6aIaEDh46AVkpMqWo1YdaWpe1690hzT4e79jxGuLvD+R0iUwuiJ+TLUM4+yrA8aAdsVAsX1JFgMsTkCF4ceBdtgLZ8oXaENnPpfPipLA6A57nn4+XI1hUbCoYmig1KP5pH44Kybnq4cUyatKivvTmXpeOC7y8J4il3yHncWVz+SDrc5zTqucPyYro3Af7XP30/I8ddJxsQAgXIFbz37QdsmqNhJl0K6145C0rkWzExAX8aM3sDpwYyA8oF83PNBXWu7xRPQMIT1E6syw7M4F2tFwOmyhVKQ7+uH/lz9DribLBF4jsuze94lYBc+7LzLOXMw4c+66u52EZz/QLEWxyA0XZFuA9+OVUfSTwyzWCw0o3a0Jx9BYTrKp2AZiEi9qGSs6OFhZkPboRDXesZKpbcd3UOjV8dMgNNQhr1pJh0Qy5petVIQ48Zq1KefMj7zIhluf3pQeBs5JfUuJMGcgHFRik16gP1mzHX2EmroaYhmVysETLOo54aSGU/gHzbEwdRvCMXuGhUczHj3HkZ42Rk9LYIDS07c8YRuqSBg91Pmnwo8VghFR2Y9oKTmxziSwi0HTN2I1cMvT3E7Fezk/Pae1UnYyUwqdRnqCNZPoXSJSk6hxGWmRBKqBSMqyTP97/wmaJcQCGpqbG5Iw6vhEtHpEVWihepULpFG3rqG0rOha2qTxJIC0YOSYFjrxEtP8nlSlIxvu7PLcRKmS76mk04Sq0HoTqJ04CcfcK+DDIU34mhCX/dByaAiDy58ibicVeRdNJrNyezI2G/ESlUKsZDxiOtLJk/ChXCc9Imp+1nO2xL6QZIkkWiizM7SHIF9q9K8ZpQDx8zOjgWaMzORvdrSGPJ2sEzRYZer9O2gmWD4zSTr6sSuH8Uc/IGjmyLIMOHUV0G48840967ixy2v6zIhcU+pr3bDj9u0bc1xfqUbO9sUuH3O/iqEbFPqaPbOBZuFTO57rx7mxvnDL7avRFLah/ei55LZCpKddjqz4OxhyH6YRLuzA0rcfY5yC8rQTcb08JdLYleZW8TZ0lGgSCyVfQoQtRDiPV6BqKLryzL7kqRmkuoGdE5UzlKWy39mJQlU1OChf1KrEHOYcsdMhvaO3j5JN+zZBXJZ2Kmq0WRSMDSFJGqmtC0q8eZesmfWxPxNNca3DC3KzYsg7MBBXhJ2yHmvy5sojNXVBmQvfhUdoxJ0NgiENWTzfqwd3SOjC927ceNvGjbfTUTNp13eIumhvAKEvJA/HTUW6Maj1CeJAUtBFrcOI1xugSWxubV1qqaRJ1gZvqiHLbKqwOo5TR9hELw7/iBsjL/t6WXl+SWN9VOO5RfnTtJcwreTFY35bWthGB+bMB+yOcGEDg4bztxbkUR0wh1h2kJWgV0awMR+Hjvn5mlrmu9BMCMpYsZynmQC8KR2xco4maZIg5jN5CU86ViJ/s27nzqlxgFc6167fuXP92s5XYOdDO8j4pYNYw16IjR8eH79U0ra3Y6V9uyat20l2P7AbsKpjJ81Tzs39nt9PXgqYeL9LNB+Yi9uMN1BEZ0knnvijDiZLEDg6dJ30NuA9oQEVh9U0uk/kgO8A+R94pvWy8YveWn0ZWbfmLepJXdqz5Z5B94qhu7d2k75r7l0Lx2gVtvTMr6FXgDY7p56d6qSNS+/e0ke6r//CQ1/YXiTdW++u+FK/529HfC3klvzNhK3Te4txIUFlkuQ8tIjguXrUG6WAPWgMsIcDF664d3v3DHXwhQ07YMul2I9QDvtQXz+bokoej3uUo5mt1Qi7f/m58pGoIAyavsnnFiUl8cbhKTpRmI+CKw9Y1oKc5GvZZJCT6kWJcCHNzzDS3KTQKEocr/6Fe1GoUf+1rq/QG/W/hs9goz8E649Xc5M6HxXjAnDV9OT9spBFuwOC26Prv2bzQ3RhCHfwaYpW8+LxqOzlYOZR7/Kf/RbmXMktCzAr3jWP/Kqt5KUqZDq4uTqyBbYGfL17HcuL19KcjykyePSoAP2bNgILH1qOXXFwA9l471P3bOIvOwRXL8j+k0OjB6cPjrLCfe2sXP/824QcsAMZlOmGWiMo0rwb4K1qo+mH/LkBVlXdA+cFXFFWvz0//AXvbZ6+ac3GoyzHHvXfzCqvNILfLi9qV7KBJ/03OPbql/A+XlcDa3g9C1/rnPPU/XzkR4E3q/4p6kHES6V3vVx1M7x3EG4RnpwfhuT9B8mTF4BG6w/vZp7SbtoL4oJBkCuYe2+LL3GT6CtdzGKjNas6FGaHETyqOIeljCSdy4azYTwkLxFIL08OHSKaM+7sonl9vERpGguhHaS5bUgz24xu3ETTPsVKqntkIZfpqR1MdBfQKd6hmiFHviU1QZ260MQ2FSOcbfDmVoyFeHkb9rq/db9KFWsP6uutqz6LgZW6R+JrIjp86Gp6jSXL+7RoUv38yjEracH0NiVpKdu2ISBl27QDRdTKAT9WHoc/IL/p7w4sptcdmtpFR6IcZRnNXDnaT909x7Ykjj6PwmlFdP9FMuWgQvb8nAiKpHB7iS4/r+pk678LRCWOGpq9QwfOlOGlbpDkEPwThngKL7puibAY5LvMl+ZQQ8Yx4mxF/wZjkGJ7a3NjKl5jyjiJ/hAhLzVVExN+9qMpZsAyWImhu/eF2NlfcmS6bxq6lNlO9CZvxpjon/G7R5k1SqVwuFwOv3HTTZn0TTelSQs2wtjpPkNH8D/RH++b3mkosx0KLkzSlfi92qSrzPKX2arMTe692ChjJ7T5I75t3I487EIe5jXKQ6pg6Q83qs/lEn3noSFynmb4aOrBF9sEoBuHhKFYcL11up41emofLCQGE60wVdeDClSvn5qqM41Go7t+iuWUHqzrNrOGWTsFst5TtwLXXPk0Syc9fSX2rsBFmzadY6C/Fge8d+e5uXHkfyiQRc6vwTu2Ylkhz95Fq2/8+YVv/CxSqb7xxyqhDjDBRxFBxcQnSYzeBfrYNqGJjej4TLDfWEywII42hqZ+/BB/6I2DkCn0WS9uv3PD4Z0DpG/3oemDe7u5NS/aMOWtol60t2qCusYTSi19uHn1iHiQOpz2i2v6xx/4xqE9PfyqHQ+N3Ln9RftsmoxADcYAyvMt9Y73lr7wdwTUmb8g/u53GOaw6pPizJC9MJrEj7noG9sG1CNhmWN2BcF2dpRzGBfz5XrojEWZRxuj6aCYY0tiLJOTMmK2uJJQjxj/8hjKEB1iGHCj4JTpxczQzEtehAevG+5pUO12twtCjfG4I979yJB4a7RlZbDdVGV1OMgDQPZQY+ERm1wqiVyYJwJHMrGaP+o9YKbUlE2ApL6YEiyylNT9ESff74qtvCgqNSZcBVOa+2Hr9q9E70rVikGTcxRJ4BSQa6ImzpQIEXk+OFbqhvQRQ4souDWotqAiL2Xqm+AZ/Yz0kXcCOnvfqg1779vzOXtqtvPMii9Ig5+dwj87Kf4bQ6EJfdRt4PyQZYFY0/NXERbE5vPzi+As2njhToFqfp7h6ufXYTFiZ6MCryyG/xQX5qIBFddLfr6b+SYsHc3P1ocikRD5rxCMuNslxeBKuiZjzQpUY6kFvwNgPtyioHRxkEr9fv+HE5AwHFc9q0neOXOa/kiAi9ByQX3et1fZb2+q7yCL914QN5y1GVt/DOVaR29JPCECXV9iGaI84A7sQ9W3Y4dLZe4vVR1Mxd3Hc7rq7lNVOKjqHM9xqmiceVWXNTgoiO6fswpN0R/EfnefyHtnMvcsdw1nzMOJiSzGpQ+SPmclxmVRqlVM0HG5wNFSQYAIRhjE3ZDTsobwJbifVegTxj7sx7mCRwvp5XSWh6/QYs/TwjyMahKsVCYZVaeECMTR56MplPyzCfrSPO/dL0m8RwvpQ1oS56aF7i/58Mpn0eOHaKxcTNGd84cLd4oCvXPu3B+4a8kPUA7rmSzJ7E3Zy7OzuJEm/Mt+7Eh/pyDPMx7xF7luuh/CY9hDe4WZYLqvW+YhFlJiWX1PO0aOB6L0t3AVOUK7V/XSqP8Dx/CavHCY8erwC3jhyKHZR2nu9wXvpz4vKN4dwOIA22sZ/S1RTbhyBxbvF/XeXzEQpfEUTa0hLTTE+RigN9vzQhBp0RzT5OUaKazwlhEU8u0fx8D9XmGdwVmmZmpavDGuichhJJUz1nn5pp9yj5H3GG7DgZtovmnn5YNFiiT/JyIZqw6Uvd+i0TRIFwumFw7SVEg/TYvQDM/8hE9O4uTWEVlECuyU2tLW1oKK3jIk+bItDxy6TZKw36mttdZgKDxo1fIRzrFMSbrt0J/Cl8KVh1OcozuqGUyO7RxLBk3UrA6XfmDTF97qwAErpOl655GnjnTqOidyIQsHO08G/hcLt/j/AAB4nGNgZGBgAOLaW41M8fw2Xxm4mV8ARRguss1QhNC5H/9//Z/FUsEcBORyMDCBRAFTFwxveJxjYGRgYA76n8UQxVLGwPD/FUsFA1AEBfgBAHyYBUh4nGN+wcDAvACCWfSBNIgviMBM1kA6koGBMRWVBqsDYqYmiF4wHQkxg+kUBMPVWEP0gTDYvBdoahZAzYxEY0ciuWUBFjkoZimDYLC8IKpehmsQccYvSGYgYZB7YBhFL5o8cxTQjDUI/wIArpclrwAAAAAAAAA6AIYA3AEKAUgBgAGgAfoCYgKqAwIDOgOGA9wEQAR4BLYFAgU8BZoFzAYMBlIGmga6BtgG+AcYB0QHcAecB8gIAAg2CG4IpgjyCUAJrAo0CtALOAueDAoMYA0ADVANjg3mDiQOjg7GDvgPOA+ED84QPBB2EN4RNhGgEfISchKoEsgS6BMGEz4TXhOSE8QT+BQsFGIUiBTWFX0AAAABAAAATgBuAAYAAAAAAAIAAAAQAHMAAAAiC3AAAAAAeJx1kctOGzEUhn9DoIKgLloJdcdZIRDK5CKhSqyoogJrhLJDwgyeSzpjRx4HlGfgLcoz8Dp9j+76Z2KhqFJmZM93Ph/bxx4AX/AHCqvnnG3FCgeMVryFT/gReZv+JnKHfBd5B108RN6l/xV5H2d4idzFV/zmCqqzx2iK98gK39RR5C18Vt8jb9P/jNwh30fewaGaR96lf428j4l6i9zFsfo7drOFL/MiyMn4VEaD4bk8LsRRlVZXouehcL6RS8mcDaaqXJK6OtSml+lemTrb3Jp8Xmm/rtZ5YnxTOivDZLCur401XgfztNytec5HIWSSeVfLVdxHZt5NTRqSIoTZRb+/vj/GcJhhAY8SOQoECE5oT/kdYYAhf4zgkRnCzFVWCQuNikZjzhlFO9IwvmTLGFlaw4yKnCBlX9PUdD2Oa/Zlay1n3dLmXKei9xuzNvkJ7XLvso2F9SaselP2Na1tZ+i2wqePszV4ZhUj2sBZy1P4tmrB1X/nEd7XcmxKk9In7a0F2gv0+W44/z/KQo7lAHicbZLnlpswEIW5Bgy4bLLpvfeE9N57z76DLARWEJKOEEucpw8CO/kTncOdT6PhnlHxRt4wJt7/x47nYQQfAUKMESFGggmmmGGOLezBXmxjH/bjAA7iEA7jCI7iGI7jBE7iFE7jDM7iHM7jAi7iEi7jCq7iGq7jBlLcxC3cxh3cxT3cxwM8xCM8xhM8xTM8xwu8xCu8xhu8xTu8xwd8xCd8xhd8xTd8xw/sBLUlZuIkZZW2q0hzahvDRqocUyIpE4EWTR1WXDZ1sGRCz5yklBsqWBZwmauZk01mTqxl0nIlUyLs9r/Zej35m4kFl2XKftlAKFomTlKlmfQ1l74lRdB9dbxQqqyIKbc2MPQZGqbFKsqVaYnJ4ky1Ms24iQXLrYPE8GLZ07jRfaIvcf5JX+NoMhQ5jLoqFwenBS8Gpw7WTh05py6MaOtT2ibEGNXWKW1Da0i9nPY6dNe7CEWy7pc+5EJpvfJVnvtUFUHFZBPWS2LYxKqiECztVpINypAuGS2nvQ6Gs+H0hsk0U3ZznDETguua1/MNpLvMWH/RFGEuuobCihScxqS2zPC6jH4rVaVcxn1UjQ1yJW1QK2MTJ6nrPOqp0d3Vk1WoSVOz7p0oHeWdTbpoh5i3sVWpezp23AGTWch+Mmonu0o0Vb+l6RqdabLmRnveH9ru7j54nGPw3sFwIihiIyNjX+QGxp0cDBwMyQUbGVidNjIwaEFoDhR6JwMDAycyi5nBZaMKY0dgxAaHjoiNzCkuG9VAvF0cDQyMLA4dySERICWRQLCRgUdrB+P/1g0svRuZGFwAB9MiuAAAAA==) format('woff')}</style>
<style id="style-core" type="text/css">html{font:16px/1 Helmet,Freesans,sans-serif}#store-area,tw-storydata{display:none!important;z-index:0}#story{z-index:10;margin:2.5em;-webkit-transition:margin-left .2s ease-in;-o-transition:margin-left .2s ease-in;transition:margin-left .2s ease-in}@media screen and (max-width:1136px){#story{margin-right:1.5em}}#passages{max-width:54em;margin:0 auto}.no-transition{-webkit-transition:none!important;-o-transition:none!important;transition:none!important}:focus{outline:thin dotted}body{color:#eee;background-color:#111}a{cursor:pointer;color:#68d;text-decoration:none;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}a:hover{color:#8af;text-decoration:underline}a.link-broken{color:#c22}a.link-broken:hover{color:#e44}span.link-disabled{color:#aaa}area{cursor:pointer}button{cursor:pointer;color:#eee;background-color:#35a;border:1px solid #57c;line-height:normal;padding:.4em;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}button:hover{background-color:#57c;border-color:#79e}button:disabled{cursor:not-allowed;background-color:#444;border:1px solid #666}input,select,textarea{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}select{padding:.34em .4em}input[type=text]{min-width:18em}textarea{min-width:30em}input[type=checkbox],input[type=file],input[type=radio],select{cursor:pointer}input:focus,input:hover,select:focus,select:hover,textarea:focus,textarea:hover{background-color:#333;border-color:#eee}hr{display:block;height:1px;border:none;border-top:1px solid #eee;margin:1em 0;padding:0}textarea{resize:vertical}audio,canvas,progress,video{max-width:100%;vertical-align:middle}.error{padding:.25em;background-color:#511;border-left:.5em solid #c22}.error[title]{cursor:help}.highlight,.marked{color:#ff0;font-weight:700;font-style:italic}.nobr{white-space:nowrap}#story a.link-external:after,.error:before,[data-icon-after]:after,[data-icon-before]:before,[data-icon]:before{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}[data-icon]:before{content:attr(data-icon)}[data-icon-before]:before{content:attr(data-icon-before) "\00a0"}[data-icon-after]:after{content:"\00a0" attr(data-icon-after)}.error:before{content:"\00a0\e80d\00a0\00a0"}#story a.link-external:after{content:"\00a0\e80e"}.passage{line-height:1.75;text-align:left;-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.passage-in{opacity:0}.passage ol,.passage ul{margin-left:.5em;padding-left:1.5em}.passage table{margin:1em 0;border-collapse:collapse;font-size:100%}.passage caption,.passage td,.passage th,.passage tr{padding:3px}.passage .error{white-space:nowrap}.macro-linkappend-insert,.macro-linkprepend-insert,.macro-linkreplace-insert,.macro-repeat-insert,.macro-timed-insert{-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.macro-linkappend-in,.macro-linkprepend-in,.macro-linkreplace-in,.macro-repeat-in,.macro-timed-in{opacity:0}</style>
<style id="style-ui-bar" type="text/css">#story{margin-left:20em}#ui-bar.stowed~#story{margin-left:4.5em}@media screen and (max-width:1136px){#story{margin-left:19em}#ui-bar.stowed~#story{margin-left:3.5em}}@media screen and (max-width:768px){#story{margin-left:3.5em}}#ui-bar{position:fixed;z-index:50;top:0;left:0;width:17.5em;height:100%;margin:0;padding:0;-webkit-transition:left .2s ease-in;-o-transition:left .2s ease-in;transition:left .2s ease-in}#ui-bar.stowed{left:-15.5em}#ui-bar-body{height:90%;height:calc(100% - 2.5em);margin:2.5em 0;padding:0 1.5em}#ui-bar.stowed #ui-bar-body,#ui-bar.stowed #ui-bar-history{visibility:hidden;-webkit-transition:visibility .2s step-end;-o-transition:visibility .2s step-end;transition:visibility .2s step-end}#ui-bar{background-color:#222;border-right:1px solid #444;text-align:center}#ui-bar-tray{position:absolute;top:.2em;left:0;right:0}#ui-bar a{text-decoration:none}#ui-bar hr{border-color:#444}#ui-bar-history [id|=history],#ui-bar-toggle{font-size:1.2em;line-height:inherit;color:#eee;background-color:transparent;border:1px solid #444}#ui-bar-toggle{display:block;position:absolute;top:0;right:0;border-right:none;padding:.3em .45em .25em}#ui-bar.stowed #ui-bar-toggle{padding:.3em .35em .25em .55em}#ui-bar-toggle:hover{background-color:#444;border-color:#eee}#ui-bar-history{margin:0 auto}#ui-bar-history [id|=history]{padding:.2em .45em .35em}#ui-bar-history #history-jumpto{padding:.2em .665em .35em}#ui-bar-history [id|=history]:not(:first-child){margin-left:1.2em}#ui-bar-history [id|=history]:hover{background-color:#444;border-color:#eee}#ui-bar-history [id|=history]:disabled{color:#444;background-color:transparent;border-color:#444}#ui-bar-body{line-height:1.5;overflow:auto}#ui-bar-body>:not(:first-child){margin-top:2em}#story-title{margin:0;font-size:162.5%}#story-author{margin-top:2em;font-weight:700}#menu ul{margin:1em 0 0;padding:0;list-style:none;border:1px solid #444}#menu ul:empty{display:none}#menu li{margin:0}#menu li:not(:first-child){border-top:1px solid #444}#menu li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-transform:uppercase}#menu li a:hover{background-color:#444;border-color:#eee}#menu a,#ui-bar-history [id|=history],#ui-bar-toggle{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#menu-item-restart a:before,#menu-item-saves a:before,#menu-item-settings a:before,#menu-item-share a:before,#ui-bar-history [id|=history],#ui-bar-toggle:before{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}#ui-bar-toggle:before{content:"\e81d"}#ui-bar.stowed #ui-bar-toggle:before{content:"\e81e"}#menu-item-saves a:before{content:"\e82b\00a0"}#menu-item-settings a:before{content:"\e82d\00a0"}#menu-item-restart a:before{content:"\e82c\00a0"}#menu-item-share a:before{content:"\e82f\00a0"}</style>
<style id="style-ui-dialog" type="text/css">html.ui-dialog-open body{overflow:hidden}#ui-overlay.open{visibility:visible;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-overlay:not(.open){-webkit-transition:visibility .2s step-end,opacity .2s ease-in;-o-transition:visibility .2s step-end,opacity .2s ease-in;transition:visibility .2s step-end,opacity .2s ease-in}#ui-overlay{visibility:hidden;opacity:0;z-index:1000;position:fixed;top:0;left:0;height:100%;width:100%}#ui-dialog.open{display:block;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-dialog{display:none;opacity:0;z-index:1100;position:fixed;top:50px;margin:0;padding:0}#ui-dialog-titlebar{position:relative}#ui-dialog-close{display:block;position:absolute;right:0;top:0;white-space:nowrap}#ui-dialog-body{overflow:auto;min-width:280px;height:90%;height:calc(100% - 2.1em - 34px)}#ui-dialog-body.settings [id|=setting-body]{display:table;width:100%}#ui-dialog-body.settings [id|=setting-label]{display:table-cell;padding:.4em 2em .4em 0}#ui-dialog-body.settings [id|=setting-label]+div{display:table-cell;min-width:8em;text-align:right;vertical-align:middle;white-space:nowrap}#ui-overlay{background-color:#000}#ui-overlay.open{opacity:.8}#ui-dialog{max-width:66em}#ui-dialog.open{opacity:1}#ui-dialog-titlebar{background-color:#444;min-height:24px}#ui-dialog-title{margin:0;padding:.2em 3.5em .2em .5em;font-size:1.5em;text-align:center;text-transform:uppercase}#ui-dialog-close{cursor:pointer;font-size:120%;margin:0;padding:0;width:3.6em;height:92%;background-color:transparent;border:1px solid transparent;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}#ui-dialog-close:hover{background-color:#b44;border-color:#d66}#ui-dialog-body{background-color:#111;border:1px solid #444;text-align:left;line-height:1.5;padding:1em}#ui-dialog-body>:first-child{margin-top:0}#ui-dialog-body hr{background-color:#444}#ui-dialog-body ul.buttons{margin:0;padding:0;list-style:none}#ui-dialog-body ul.buttons li{display:inline-block;margin:0;padding:.4em .4em 0 0}#ui-dialog-body ul.buttons>li+li>button{margin-left:1em}#ui-dialog-body.list{padding:0;min-width:140px}#ui-dialog-body.list ul{margin:0;padding:0;list-style:none;border:1px solid transparent}#ui-dialog-body.list li{margin:0}#ui-dialog-body.list li:not(:first-child){border-top:1px solid #444}#ui-dialog-body.list li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-decoration:none}#ui-dialog-body.list li a:hover{background-color:#333;border-color:#eee}#ui-dialog-body.saves{padding:0 0 1px}#ui-dialog-body.saves>:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves table{border-spacing:0;min-width:340px;width:100%}#ui-dialog-body.saves tr:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves td{padding:.33em .33em}#ui-dialog-body.saves td:first-child{min-width:1.5em;text-align:center}#ui-dialog-body.saves td:nth-child(3){line-height:1.2}#ui-dialog-body.saves td:last-child{text-align:right}#ui-dialog-body.saves .empty{color:#999}#ui-dialog-body.saves .datestamp{font-size:75%}#ui-dialog-body.saves ul.buttons li{padding:.4em}#ui-dialog-body.saves ul.buttons>li+li>button{margin-left:.2em}#ui-dialog-body.saves ul.buttons li:last-child{float:right}#ui-dialog-body.settings div[id|=header-body]{margin:1em 0}#ui-dialog-body.settings div[id|=header-body]:first-child{margin-top:0}#ui-dialog-body.settings div[id|=header-body]:not(:first-child){border-top:1px solid #444;padding-top:1em}#ui-dialog-body.settings div[id|=header-body]>*{margin:0}#ui-dialog-body.settings h2[id|=header-heading]{font-size:1.375em}#ui-dialog-body.settings p[id|=header-label]{font-size:87.5%}#ui-dialog-body.settings div[id|=setting-body]+div[id|=setting-body]{margin:.5em 0}#ui-dialog-body.settings [id|=setting-control]{white-space:nowrap}#ui-dialog-body.settings button[id|=setting-control]{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}#ui-dialog-body.settings button[id|=setting-control]:hover{background-color:#333;border-color:#eee}#ui-dialog-body.settings button[id|=setting-control].enabled{background-color:#282;border-color:#4a4}#ui-dialog-body.settings button[id|=setting-control].enabled:hover{background-color:#4a4;border-color:#6c6}#ui-dialog-body.share{min-width:140px}#ui-dialog-body.list a,#ui-dialog-body.settings span[id|=setting-input],#ui-dialog-close{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves button[id=saves-export]:before,#ui-dialog-body.saves button[id=saves-import]:before,#ui-dialog-body.saves button[id=saves-clear]:before,#ui-dialog-body.settings button[id|=setting-control].enabled:after,#ui-dialog-body.settings button[id|=setting-control]:after,#ui-dialog-close{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}#ui-dialog-body.saves button[id=saves-export]:before{content:"\e829\00a0"}#ui-dialog-body.saves button[id=saves-import]:before{content:"\e82a\00a0"}#ui-dialog-body.saves button[id=saves-clear]:before{content:"\e827\00a0"}#ui-dialog-body.settings button[id|=setting-control]:after{content:"\00a0\00a0\e830"}#ui-dialog-body.settings button[id|=setting-control].enabled:after{content:"\00a0\00a0\e831"}</style>
<style id="style-debugview" type="text/css">#ui-bar-body>#debug-view-toggle:first-child{margin-top:1em}#ui-bar-body>#debug-view-toggle:first-child+*{margin-top:1em}#debug-view-toggle{text-transform:uppercase}#debug-view-toggle:after,#debug-view-toggle:before{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}#debug-view-toggle:before{content:"\e838\00a0"}html:not(.debug-view) #debug-view-toggle{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}html:not(.debug-view) #debug-view-toggle:hover{background-color:#333;border-color:#eee}html:not(.debug-view) #debug-view-toggle:after{content:"\00a0\00a0\e830"}html.debug-view #debug-view-toggle{background-color:#282;border-color:#4a4}html.debug-view #debug-view-toggle:hover{background-color:#4a4;border-color:#6c6}html.debug-view #debug-view-toggle:after{content:"\00a0\00a0\e831"}html.debug-view .debug{padding:.25em;background-color:#234}html.debug-view .debug[title]{cursor:help}html.debug-view .debug.block{display:inline-block;vertical-align:middle}html.debug-view .debug.invalid{text-decoration:line-through}html.debug-view .debug.hidden,html.debug-view .debug.hidden .debug{background-color:#555}html:not(.debug-view) .debug.hidden{display:none}html.debug-view .debug[data-name][data-type].nonvoid:after,html.debug-view .debug[data-name][data-type]:before{background-color:rgba(0,0,0,.25);font-family:monospace,monospace;white-space:pre}html.debug-view .debug[data-name][data-type]:before{content:attr(data-name)}html.debug-view .debug[data-name][data-type|=macro]:before{content:"<<" attr(data-name) ">>"}html.debug-view .debug[data-name][data-type|=macro].nonvoid:after{content:"<</" attr(data-name) ">>"}html.debug-view .debug[data-name][data-type|=html]:before{content:"<" attr(data-name) ">"}html.debug-view .debug[data-name][data-type|=html].nonvoid:after{content:"</" attr(data-name) ">"}html.debug-view .debug[data-name][data-type]:not(:empty):before{margin-right:.25em}html.debug-view .debug[data-name][data-type].nonvoid:not(:empty):after{margin-left:.25em}html.debug-view .debug[data-name][data-type|=special],html.debug-view .debug[data-name][data-type|=special]:before{display:block}</style>
</head>
<body>
	<div id="init-screen">
		<p id="init-no-js"><noscript>Apologies! JavaScript is required. Please enable it to continue.</noscript></p>
		<p id="init-lacking">Apologies! You are using an <strong>outdated</strong> browser which lacks required capabilities. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
		<p id="init-loading">Initializing. Please wait&hellip;<br /><progress></progress></p>
	</div>
	<div id="store-area" hidden><tw-storydata name="Chaudron magique" startnode="34" creator="Twine" creator-version="2.0.11" ifid="A1089D4E-9A0F-4011-953B-C64AFD1CEFEC" format="SugarCube 2 (local/offline)" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">/*@import url('https://fonts.googleapis.com/css?family=Open+Sans');*/
@import url('https://fonts.googleapis.com/css?family=Amaranth');
/*@import url('https://fonts.googleapis.com/css?family=Lato');*/

@font-face {
    font-family: Kaushan Script;
    src: url(fonts/KaushanScript-Regular.otf);
}

body, tw-story {
  font-family: Amaranth, "Open Sans", "Kaushan Script", serif;
  font-size: 18px;
}


#ui-bar {
	display: none;
}

html {
    background: url(media/pictures/bg2_m.jpg) no-repeat center center fixed;
    background-size: cover;
}
body {
  /* Remove default styles */
	/*margin: 10% 0 0 0;*/
  background-color: transparent;
  font-size: 100%;
  /* Used to center the box */
  text-align: center;
}

#story {
	margin: 0;
}

#passages {
	border: 2px solid #212121;
	box-shadow: 0 0 20px 6px #545454;
	
	position: relative;

	/*background-image: url(media/pictures/paperborder3.png), url(media/pictures/paperborder2.png), url(media/pictures/paperborder4.png), url(media/pictures/paperborder5.png), url(media/pictures/pattern.jpg);
	background-position: top, bottom, left, right, center;
	background-size: 100% auto, 100% auto, auto 100%, auto 100%, auto;
	background-repeat: no-repeat, no-repeat, no-repeat, no-repeat, repeat;*/
		background-image: url(media/pictures/paperborder3.png), url(media/pictures/paperborder2.png), url(media/pictures/pattern.jpg);
	background-position: top, bottom, center;
	background-size: 100% auto, 100% auto, auto;
	background-repeat: no-repeat, no-repeat, repeat;

  /* Box width */
  width: 100%;
	max-width: 40%;

  /* Center the box */
  display: inline-block;
  min-height: 400px;
  margin:auto;
	margin-top: 5%;
  margin-bottom: 5%;
  padding: 0px;

	font-size: 20px;
}

#passages img.illustration {
	display: block;
  margin-left: auto;
  margin-right: auto;
	border: 2px solid #212121;
  max-width: 100%;
	max-height: 400px;
}

.passage {
	min-height: 50vh;
  margin: 0px;
  /* Inner margin within the box */
  padding: 4em;

  /* Text formatting */
  color: black;
  font-size: .9em;
  text-align:justify;

	position: relative;
	
	line-height: 1.5;
}

/* No sidebar */
#sidebar {
  display:none;
}

/* Links */
a.link-internal, a.link-external {
  color: royalblue;
}
a.link-internal:hover, a.link-external:hover {
  color: deepskyblue;
  text-decoration: none;
}

/* Title */
#game_title {
	width: 100%;
	border: 0px;
}

.black_overlay {
	width: 100%;
	height: 100%;
	position: absolute;
	background-color: black;
	z-index: 1;
	top: 0;
	left: 0;
}

.white_overlay {
	width: 100%;
	height: 100%;
	position: absolute;
	background-color: white;
	z-index: 20;
	top: 0;
	left: 0;
}

/* Passage d'intro avec écran noir */
#passage-intro {
	background-color: black;
	color: white;
}



/* Images fixes du chaudron */
#chaudron_container {
	position: fixed;
	width: 20%;
  top: 10%;
  right: 5%;
	line-height: 0;
}
img.chaudron {
	border: 2px solid #212121;
	width: 100%;
	position: absolute;
}

/* Badges */

img.badge {
	width: 50px;
	vertical-align: middle;
}

</style><script role="script" id="twine-user-script" type="text/twine-javascript">// requires jquery



/* Pour forcer le saut vers un passage particulier
Dans une balise twine script :
$("body #passages").on("click", "area[data-passage]", function () {
	state.display(this.getAttribute("data-passage"));
});
*/


/**
* macro that displays a Passage automatically after another
* @param[0] : time before displaying the passage
* @param[1] : name of the passage to display
*/

macros.wait = {
	handler: function(place, macroName, params, parser) {
		window.setTimeout(function(){
			state.display(params[1]);
		}, params[0]);
	},
};

try {
  version.extensions['macrodemoMacro'] = {
    major:1, minor:0, revision:0
  };
  macros['macrodemo'] = {
    handler: function(place, macroName, params, parser) {
      new Wikifier(place, "Hello World!");
    },
    init: function() { },
  };
} catch(e) {
  throwError(place,"macrodemo Setup Error: "+e.message);
}


version.extensions.timedgotoMacro={
	major:1,minor:1,revision:1 /*SugarCube version*/
};
macros["goto"]=macros["timedgoto"]={
	timer:null,handler:function(a,b,c,d){
		function cssTimeUnit(s){
			if(typeof s=="string"){
				if(s.slice(-2).toLowerCase()=="ms"){
					return Number(s.slice(0,-2))||0;
				}
				else{
					if(s.slice(-1).toLowerCase()=="s"){
						return Number(s.slice(0,-1))*1000||0;
					}
				}
			}
			throwError(a,s+" isn't a CSS time unit");
			return 0;
		}
		var t,d,m,s;
		t=c[c.length-1];
		d=d.fullArgs();
		m=0;
		if(b!="goto"){
			d=d.slice(0,d.lastIndexOf(t));
			m=cssTimeUnit(t);
		}
		d=eval(Wikifier.parse(d));
		if(d+""){
			if(this.timer){
			clearTimeout(this.timer);
			}
			s=state.active.title;
			this.timer=setTimeout(function(){
				if(state.active.title==s){
					state.display(d,a);
				}
			},m);
		}
	}
};


window.blurElement = function (element, size, sduration) {
	var filterVal = 'blur(' + size + 'px)';
		$(element).css({
        'filter':filterVal,
        'webkitFilter':filterVal,
        'mozFilter':filterVal,
        'oFilter':filterVal,
        'msFilter':filterVal,
        'transition':'all ' + sduration + 's ease-out',
        '-webkit-transition':'all ' + sduration + 's ease-out',
        '-moz-transition':'all ' + sduration + 's ease-out',
        '-o-transition':'all ' + sduration + 's ease-out'
	});
}







</script><tw-passagedata pid="1" name="Rivière" tags="" position="1340,1261">&lt;&lt;silently&gt;&gt;
&lt;&lt;set $var to random(1,10)&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;if $glace eq true&gt;&gt;
&lt;img class=&quot;illustration&quot; alt=&quot;rivière gelée&quot; src=&quot;media/pictures/illustrations/riviere_gelee.png&quot;/&gt;
Alors que le temps est fort agréable, vous arrivez devant une rivière gelée. Ne voyant pas de pont à l&#39;horizon, vous juger que l&#39;épaisseur de la glace n&#39;est pas très importante au vu des fissures présentes dans celle-ci. Après un court instant de réflexion, elle a l&#39;air assez épaisse pour passer sans sac à dos et éventuellement assez si vous ne déposez que votre bâton.
&lt;span id=&quot;glace&quot;&gt;
	&lt;&lt;link &quot;Abandonner votre sac à dos&quot;&gt;&gt;
		&lt;&lt;replace &quot;#glace&quot;&gt;&gt;
&lt;&lt;set $allumette to false&gt;&gt;
&lt;&lt;set $lampe to false&gt;&gt;
Ne voulant pas prendre de risques inutiles, vous retirez votre sac à dos avant de traverser délicatement la glace. Bien que les bruits de fissures, se propageant sous vos pieds, vous ont donné des sueurs froides, vous atteignez sain et sauf l&#39;autre rive.
[[Suite-&gt;bruit]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;link &quot;Abandonner votre bâton&quot;&gt;&gt;
		&lt;&lt;replace &quot;#glace&quot;&gt;&gt;
&lt;&lt;set $baton to false&gt;&gt;
	&lt;&lt;if $var &lt; 8&gt;&gt;
Ne voulant pas vous séparer de vos affaires, vous laisser tout de même votre bâton avant de traverser (de toute façon votre couteau vous permettra d&#39;en refaire un). Bien que les bruits de fissures, se propageant sous vos pieds, vous ont donné des sueurs froides, vous atteignez sain et sauf l&#39;autre rive.
[[Suite-&gt;bruit]]
	&lt;&lt;else&gt;&gt;
Ne voulant pas vous séparer de vos affaires, vous laisser tout de même votre bâton avant de traverser (de toute façon votre couteau vous permettra d&#39;en refaire un)...
[[Suite-&gt;Passer au travers de la glace]]
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;link &quot;Tenter&quot;&gt;&gt;
		&lt;&lt;replace &quot;#glace&quot;&gt;&gt;
	&lt;&lt;if $var &lt; 4&gt;&gt;
Ne voulant pas vous séparer de vos affaires, vous commencez la traversée. Bien que les bruits de fissures, se propageant sous vos pieds, vous ont donné des sueurs froides, vous atteignez sain et sauf l&#39;autre rive.
[[Suite-&gt;bruit]]
	&lt;&lt;else&gt;&gt;
Ne voulant pas vous séparer de vos affaires, vous commencez la traversée...
[[Suite-&gt;Passer au travers de la glace]]
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;
&lt;&lt;else&gt;&gt;
&lt;img class=&quot;illustration&quot; alt=&quot;rivière&quot; src=&quot;media/pictures/illustrations/riviere.png&quot;/&gt;
Comme indiqué par les villageois, vous arrivez au niveau d&#39;une rivière à traverser, mais le pont manque à l&#39;appel. Voyant le fond, vous estimez que la profondeur ne doit pas dépasser la hauteur de vos épaules. Ne pouvant porter qu&#39;un seul objet hors de l&#39;eau, vous vous tâter sur l&#39;objet à préserver de l&#39;eau...
[[Le bâton-&gt;porter le bâton]]
[[Le sac-&gt;porter le sac]]
&lt;&lt;/if&gt;&gt;</tw-passagedata>
<tw-passagedata pid="2" name="porter le sac" tags="" position="1516,1393">&lt;&lt;if $poussièredefeu eq true&gt;&gt;
&lt;&lt;set $baton to false&gt;&gt;
Vous traversez alors la rivière, le sac au-dessus de votre tête et le bâton à votre ceinture. Une odeur arrivant à votre nez, vous remarquez que votre bâton de marche prend feu alors qu&#39;il est dans l&#39;eau. Interloqué, vous vous en séparez avant qu&#39;il ne vous brûle. Une fois de l&#39;autre côté, vous séchez rapidement vos vêtements par ce temps agréable, en réfléchissant à ce qui s&#39;est produit, avant de reprendre la route.
&lt;&lt;else&gt;&gt;
Vous traversez alors la rivière, le sac au-dessus de votre tête, et vous continuez tranquillement votre route après avoir séché vos vêtement au soleil.
&lt;&lt;/if&gt;&gt;
[[suite-&gt;bruit]]</tw-passagedata>
<tw-passagedata pid="3" name="bruit" tags="" position="1750,1267">&lt;&lt;if $livre eq false&gt;&gt;
	&lt;&lt;if $os eq false&gt;&gt;
Alors que vous vagabondez dans vos idées, vous apercevez un petit sentier sur votre droite menant certainement à la clairière mentionnée par les habitants...
[[Aller voir la clairière-&gt;Clairière]]
[[Continuer sur le sentier-&gt;Groupe de scout]]
	&lt;&lt;else&gt;&gt;
&lt;!--Bruit--&gt;
Le bruit provient d&#39;un chemin discret sur votre droite. Vous rappelant les dires des habitants, il s&#39;agit certainement de la clairière...
[[Aller en direction du bruit-&gt;Clairière]]
[[Continuer sur le sentier-&gt;Groupe de scout]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;!--Bruit--&gt;
Le bruit provient d&#39;un chemin discret sur votre droite. Vous rappelant les dires des habitants, il s&#39;agit certainement de la clairière...
[[Aller en direction du bruit-&gt;Clairière]]
[[Continuer sur le sentier-&gt;Groupe de scout]]
&lt;&lt;/if&gt;&gt;</tw-passagedata>
<tw-passagedata pid="4" name="porter le bâton" tags="" position="1508,1560">&lt;&lt;set $allumette to false&gt;&gt;
Vous décidez alors de porter vôtre bâton hors de l&#39;eau. Une fois de l&#39;autre côté de la rive, vous vous retrouvez humide, comme les amulettes que vous avez oublié dans votre sac. Une fois séché au soleil, par ce temps agréable, vous reprenez la route.
[[Suite-&gt;bruit]]
</tw-passagedata>
<tw-passagedata pid="5" name="Groupe de scout" tags="" position="2370,1270">&lt;img class=&quot;illustration&quot; alt=&quot;scouts&quot; src=&quot;media/pictures/illustrations/scouts.png&quot;/&gt;
Sur votre chemin, vous rencontrez un groupe de jeunes scouts affairés à étudier la nature. L&#39;un ramasse des champignons, une autre des papillons, le troisième ramasse des feuilles et les examine avec une loupe et le dernier, perdu dans ses pensées, regarde les nuages...
Ah la jeunesse, cela vous rappelle la vôtre où vous partiez avec votre grand-frère en forêt et où  vous imaginiez divers scénarios pour vous amuser : combat d&#39;épées, fabrication d&#39;arcs, construction de forteresse, opération commando... À votre vue, ils se détournent de leur tâche pour vous saluer.\
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $champignon eq true&gt;&gt; Une drôle de lueur émane de leurs yeux et leurs gestes semblent mous.&lt;&lt;/if&gt;&gt;
&lt;&lt;if $scouteperduvu eq true&gt;&gt; Il doit sûrement s&#39;agir du groupe auquel appartient le scout vu précédemment.&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;\
&lt;span id=&quot;scouts&quot;&gt;
	&lt;&lt;link &quot;Les saluer&quot;&gt;&gt;
		&lt;&lt;replace &quot;#scouts&quot;&gt;&gt;
&lt;&lt;if $champignon eq true&gt;&gt;
&lt;!-- texte multicolor--&gt;
- Bonjour l&#39;ami, dis-moi tu dois être perdu non?
- Encore un éléphant qui se promène dans le bois ?! Qui aurait dit qu&#39;il y en avait dans le coin...

	&lt;span id=&quot;delire&quot;&gt;
		&lt;&lt;link &quot;Les laisser dans leur monde&quot;&gt;&gt;
			&lt;&lt;replace &quot;#delire&quot;&gt;&gt;
En essayant de comprendre les paroles du scout vous le voyez ramasser quelque chose de pas très net à terre et le manger. Ne cherchant pas plus loin, vous décidez de reprendre la route et ne pas perdre de temps avec eux...
[[Suite-&gt;Embranchement]]
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;
	&lt;/span&gt;
&lt;&lt;else&gt;&gt;
- Eh bonjour ! C&#39;est rare de rencontrer des gens par ici. Ca fait des semaines que nous examinons cette forêt et mis à part quelques animaux, nous ne voyons rien d&#39;intéressant.
- Encore un citadin qui se perd dans le bois
- Dites-moi, je galère un peu à attraper cette pomme, vous ne pourriez pas m&#39;aider à l&#39;attraper, s&#39;il vous plaît ?
&lt;!-- ou alors attraper papillon qui bouge à l&#39;écran(GIF)--&gt;
	&lt;span id=&quot;help&quot;&gt;
		&lt;&lt;link &quot;Aider&quot;&gt;&gt;
			&lt;&lt;replace &quot;#help&quot;&gt;&gt;
Il suffit juste de monter la chercher 
Ah merci bien
&lt;&lt;set $scoutaide to true&gt;&gt;
&lt;span id=&quot;perdu&quot;&gt;
	&lt;&lt;link &quot;Prendre congé&quot;&gt;&gt;
		&lt;&lt;replace &quot;#perdu&quot;&gt;&gt;
Devant vous remettre en route, vous laissez le groupe reprendre ses activités...
[[Suite-&gt;Embranchement]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;&lt;if $scoutperduvu eq true&gt;&gt;
	&lt;&lt;link &quot;Mentionner le scout perdu&quot;&gt;&gt;
		&lt;&lt;replace &quot;#perdu&quot;&gt;&gt;
- Rho toujours la tête en l&#39;air celui-là heureusement qu&#39;on lui a mis une pancarte
- C&#39;est qu&#39;il nous mettra en retard avec ses bêtises et dire qu&#39;on doit retourner le chercher
-En tout cas merci pour l&#39;indication et bonne route &lt;&lt;set $scoutaide to true&gt;&gt;
[[Prendre congé-&gt;Embranchement]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;/span&gt;
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;
		&lt;&lt;link &quot;Refuser&quot;&gt;&gt;
			&lt;&lt;replace &quot;#help&quot;&gt;&gt;
- Vous n&#39;êtes pas gentil ... en tout cas ne comptez pas sur nous pour vous aider en cas de besoin ...
&lt;span id=&quot;perdu&quot;&gt;
	&lt;&lt;link &quot;Prendre congé&quot;&gt;&gt;
		&lt;&lt;replace &quot;#perdu&quot;&gt;&gt;
Devant vous remettre en route, vous laissez le groupe reprendre ses activités...
[[Suite-&gt;Embranchement]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;&lt;if $scoutperduvu eq true&gt;&gt;
	&lt;&lt;link &quot;Mentionner le scout perdu&quot;&gt;&gt;
		&lt;&lt;replace &quot;#perdu&quot;&gt;&gt;
- Rho toujours la tête en l&#39;air celui-là heureusement qu&#39;on lui a mis une pancarte
- C&#39;est qu&#39;il nous mettra en retard avec ses bêtises et dire qu&#39;on doit retourner le chercher
-En tout cas merci pour l&#39;indication et bonne route &lt;&lt;set $scoutaide to true&gt;&gt;
[[Prendre congé-&gt;Embranchement]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;/span&gt;
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;
	&lt;/span&gt;
&lt;&lt;/if&gt;&gt;
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;link &quot;Les laisser à leurs occupations&quot;&gt;&gt;
		&lt;&lt;replace &quot;#scouts&quot;&gt;&gt;
N&#39;ayant pas le temps pour dialoguer, vous laissez la jeunesse à leurs occupations et vous reprenez votre route
[[Suite-&gt;Embranchement]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;</tw-passagedata>
<tw-passagedata pid="6" name="Manifestation" tags="" position="2080,1811">Interloqués de voir des animaux parlants, vous vous manifestez auprès d&#39;eux. Après plusieurs minutes de conversation au travers différents débats, vous allez reprendre la route vers la cabane du sorcier lorsqu&#39;un lapin vous propose d&#39;argumenter à propos de l&#39;existence et l’absurdité des sentiments avec un animal intelligent ...
[[Relever le défi-&gt;Dicussion]]
[[Décliner la proposition et s&#39;en aller-&gt;Groupe de scout]] </tw-passagedata>
<tw-passagedata pid="7" name="Dicussion" tags="" position="2297,1729">&lt;img class=&quot;illustration&quot; alt=&quot;lapin savant&quot; src=&quot;media/pictures/illustrations/lapin.png&quot;/&gt;
Vous vous lancez donc dans un débat face au lapin qui ne semble pas à court d&#39;arguments. Le temps défilant, personne ne semble toutefois décidé à admettre le point de vue de l&#39;autre.
&lt;&lt;set $bad_end to &quot;discussion&quot;&gt;&gt;
[[Fin-&gt;fin]]</tw-passagedata>
<tw-passagedata pid="8" name="Embranchement" tags="" position="2675,1266">&lt;img class=&quot;illustration&quot; alt=&quot;embranchement&quot; src=&quot;media/pictures/illustrations/embranchement.png&quot;/&gt;
Vous abandonnez la jeunesse à la rêverie pour continuer votre chemin.
Arrivé à un embranchement, vous voyez deux chemins qui s&#39;offrent à vous :
- un chemin sombre, où vous ne distinguez même pas les branches des arbres à la lisière
- un chemin indiqué par un panneau affichant &quot;raccourci&quot; mais qui vous semble glissant et escarpé...
[[Aller vers le chemin sombre-&gt;chemin sombre]]
[[Tenter le raccourci-&gt;raccourci]]</tw-passagedata>
<tw-passagedata pid="9" name="chemin sombre" tags="" position="2778,1011">Vous avancez alors en direction du chemin sombre où la visibilité est faible à cause de la densité des arbres environnants.
&lt;&lt;set $variable to random(1,10)&gt;&gt;&lt;&lt;if $allumette eq true&gt;&gt;&lt;&lt;if $variable &lt;6&gt;&gt;
[[Allumer une allumette pour éclairer le chemin-&gt;pièce or]]&lt;&lt;else&gt;&gt;
[[Allumer une allumette pour éclairer le chemin-&gt;antre du dragon]]&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $lampe eq true&gt;&gt;&lt;&lt;if $variable &lt;10&gt;&gt;
[[Sortir la lampe de poche pour éclairer le chemin-&gt;pièce or]]&lt;&lt;else&gt;&gt;
[[Sortir la lampe de poche pour éclairer le chemin-&gt;antre du dragon]]&lt;&lt;/if&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;if $allumette eq false&gt;&gt;
Après avoir fouillé vos poches sans succès, n&#39;ayant plus de moyens d&#39;éclairer la route, vous vous enfoncez dans l&#39;obscurité.&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
[[Continuer et rester dans la pénombre-&gt;antre du dragon]]
</tw-passagedata>
<tw-passagedata pid="10" name="raccourci" tags="" position="3011,1264">&lt;&lt;set $variable to random(1,10)&gt;&gt;
&lt;&lt;if $baton eq true&gt;&gt;&lt;!-- ##########Avance avec bâton######--&gt;
Souhaitant gagner du temps, vous empruntez le raccourci et aidé de votre bâton vous avancez sans glisser ni chuter dans le ravin.
[[Poursuivre-&gt;jardincabane]]
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $couteau eq true&gt;&gt;
N&#39;ayant plus de bâton, pour vous aider dans votre ascension, vous avez la possibilité d&#39;utiliser les arbres à disposition, dont un magnifique chêne qui dispose d’une branche susceptible de faire un bon bâton de marche.
&lt;span id=&quot;glisse&quot;&gt;
&lt;&lt;link &quot;Fabriquer un bâton&quot;&gt;&gt;&lt;!-- ######Fabrique bâton#####--&gt;
&lt;&lt;replace &quot;#glisse&quot;&gt;&gt;
&lt;&lt;set $baton to true&gt;&gt;
Après avoir fabriqué votre bâton à parti d’une solide branche de chêne, vous vous remettez en route et vous avancez sans glisser ni chuter dans le ravin.
[[Suite-&gt;jardincabane]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;&lt;link &quot;Continuer sans bâton&quot;&gt;&gt;&lt;!-- ######Ne veut pas fabriquer baton###--&gt;
&lt;&lt;if $bave eq false&gt;&gt;
&lt;&lt;if $variable &lt; 5&gt;&gt;
&lt;&lt;replace &quot;#glisse&quot;&gt;&gt;
Vous sentant courageux, vous bravez le danger et vous vous remettez en route et vous avancez sans glisser ni chuter dans le ravin.

[[Suite-&gt;jardincabane]]
		&lt;&lt;/replace&gt;&gt;
			&lt;&lt;else&gt;&gt;
&lt;&lt;replace &quot;#glisse&quot;&gt;&gt;
Vous sentant courageux, vous bravez le danger mais bien mal vous en a pris car vous chutez dans le ravin après avoir glissé sur une pierre.
	&lt;&lt;set $bad_end to &quot;ravin&quot;&gt;&gt;
[[Fin-&gt;fin]]
		&lt;&lt;/replace&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
&lt;&lt;if $variable &lt;3&gt;&gt;
&lt;&lt;replace &quot;#glisse&quot;&gt;&gt;
Vous sentant courageux, vous bravez le danger et  vous vous remettez en route et vous avancez sans glisser ni chuter dans le ravin.
[[Suite-&gt;jardincabane]]
		&lt;&lt;/replace&gt;&gt;
			&lt;&lt;else&gt;&gt;
&lt;&lt;replace &quot;#glisse&quot;&gt;&gt;
Vous sentant courageux, vous bravez le danger mais bien mal vous en a pris car vous chutez dans le ravin après avoir glissé sur une pierre recouverte d&#39;une substance gluante.
	&lt;&lt;set $bad_end to &quot;ravin&quot;&gt;&gt;
[[Fin-&gt;fin]]
		&lt;&lt;/replace&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;
	&lt;&lt;else&gt;&gt; &lt;!--##################pas possible de faire baton##################--&gt;
&lt;span id=&quot;roule&quot;&gt;
N’ayant pas de bâton à disposition et aucun outil pour en fabriquer un, malgré la présence d’un magnifique chêne qui dispose d’une branche susceptible de faire un bon bâton de marche, vous vous élancez dans ce chemin escarpé…
	&lt;&lt;link Poursuivre&gt;&gt;
&lt;&lt;if $bave eq false&gt;&gt;
&lt;&lt;if $variable &lt;5&gt;&gt;
&lt;&lt;replace &quot;#roule&quot;&gt;&gt;
…et vous avancez sans glisser ni chuter dans le ravin.

[[Suite-&gt;jardincabane]]
		&lt;&lt;/replace&gt;&gt;
			&lt;&lt;else&gt;&gt;
&lt;&lt;replace &quot;#roule&quot;&gt;&gt;
… mais bien mal vous en a pris car vous chutez dans le ravin après avoir glissé sur une pierre.
	&lt;&lt;set $bad_end to &quot;ravin&quot;&gt;&gt;
[[Fin-&gt;fin]]
		&lt;&lt;/replace&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
&lt;&lt;if $variable &lt;3&gt;&gt;
&lt;&lt;replace &quot;#roule&quot;&gt;&gt;
…et vous avancez sans glisser ni chuter dans le ravin.
[[Suite-&gt;jardincabane]]
		&lt;&lt;/replace&gt;&gt;
			&lt;&lt;else&gt;&gt;
&lt;&lt;replace &quot;#roule&quot;&gt;&gt;
Vous sentant courageux, vous bravez le danger mais bien mal vous en a pris car vous chutez dans le ravin après avoir glissé sur une pierre recouverte d&#39;une substance gluante.
	&lt;&lt;set $bad_end to &quot;ravin&quot;&gt;&gt;
[[Fin-&gt;fin]]
		&lt;&lt;/replace&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;

	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
</tw-passagedata>
<tw-passagedata pid="11" name="pièce or" tags="" position="2948,859">Eclairé, votre progression est facilitée et vous avancez plus sereinement, malgré les bruits d&#39;animaux environnant. Et, heureusement pour vous, vous ne voyez pas les créatures qui vous scrutent.  Car aussi susceptibles qu’elles sont, elles vous mettraient en pièces si vous tentiez de les fuir par dégoût.  Admirant la triste végétation poussant en ces lieux, votre regard est attiré par un objet brillant sur le sol. Vous vous penchez donc pour ramasser ce précieux objet rond et doré et, après l&#39;avoir nettoyé de la terre qui le recouvrait, vous pouvez observer d’étranges motifs sur cette pièce d’or...
&lt;span id=&quot;pieceor&quot;&gt;
	&lt;&lt;link &quot;Prendre la pièce&quot;&gt;&gt;
		&lt;&lt;replace &quot;#pieceor&quot;&gt;&gt;
&lt;&lt;set $pieceor to true&gt;&gt;
Ne cherchant pas plus loin à qui appartient cette pièce et ce que représentent les symboles, vous la mettez dans votre poche et vous reprenez votre route.
[[Suite-&gt;antre du dragon]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;link &quot;reposer la pièce&quot;&gt;&gt;
		&lt;&lt;replace &quot;#pieceor&quot;&gt;&gt;
Devant l’incompréhension des symboles, vous préférez reposer la pièce plutôt que de risquer une quelconque malédiction, au vu de l’étrangeté de ces lieux…
[[Suite-&gt;antre du dragon]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;
</tw-passagedata>
<tw-passagedata pid="12" name="antre du dragon" tags="" position="3126,1006">&lt;&lt;silently&gt;&gt;
&lt;!-- bruit moto--&gt;
&lt;&lt;set $variable to random(1,10)&gt;&gt;
&lt;&lt;if $variable &gt; 5&gt;&gt;
&lt;&lt;set $dragon to  &quot;dragon&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Alors que vous sortez de la pénombre du sombre chemin, vous arrivez devant une sorte de grotte contre laquelle est appuyée une moto. Au pied de la roue arrière, vous pouvez voir qu&#39;un chien soulage sa vessie.
&lt;&lt;if $dragon eq &quot;dragon&quot;&gt;&gt;&lt;!-- ######dragon=dragon##########--&gt;
&lt;img class=&quot;illustration&quot; alt=&quot;dragon&quot; src=&quot;media/pictures/illustrations/dragon.png&quot;/&gt;
C&#39;est alors que la moto se met à vibrer et à se déformer pour prendre des dimensions gigantesques et laisser place à une créature semblable à un dragon. D&#39;un coup, il gobe le pauvre chien
- Ah la sale bête ! Enfin je t&#39;ai eu, depuis le temps ! Ça t&#39;apprendra à venir tous les jours pour te soulager sur moi !
Grouaahh que ça fait du bien de s&#39;étirer.

BLABLABLA

&lt;span id=&quot;depart&quot;&gt;
	&lt;&lt;link &quot;Reprendre la route&quot;&gt;&gt;
		&lt;&lt;replace &quot;#depart&quot;&gt;&gt;
	&lt;&lt;if $pieceor eq true&gt;&gt;
&lt;!-- bruit dragon qui sent qqch--&gt;
- C&#39;est quoi cette odeur, mes souvenir sont lointains mais cette odeur m&#39;est fort agréable... N&#39;aurais tu pas de l&#39;or sur toi qui aurait appartenu à mon trésor?
&lt;span id=&quot;voleur&quot;&gt;
	&lt;&lt;link &quot;Mentir&quot;&gt;&gt;&lt;!-- ###############Mentir############--&gt;
		&lt;&lt;replace &quot;#voleur&quot;&gt;&gt;
&lt;&lt;set $variable to random(1,10)&gt;&gt;
		&lt;&lt;if $livrescout eq true&gt;&gt;&lt;!--#######Test echec fuite#######--&gt;
			&lt;&lt;if $variable &gt; 5&gt;&gt;	
&lt;&lt;set $variable to &quot;echec&quot;&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;if $variable &gt; 2&gt;&gt;
&lt;&lt;set $variable to &quot;echec&quot;&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $variable eq &quot;echec&quot;&gt;&gt;
Alors que vous essayez, tant bien que mal d&#39;argumenter sur le fait que vous ne pouvez pas avoir la pièce, le dragon, agacé, vous gobe d&#39;un geste rapide pour son âge...
&lt;&lt;set $bad_end to &quot;mange&quot;&gt;&gt;
[[Fin-&gt;fin]]
		&lt;&lt;else&gt;&gt;
Après un discours riche en arguments, le vieux dragon abdique et vous présente ses excuses en prenant pour faute son odorat âgé.
[[Suite-&gt;Portesecrete]]
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;link &quot;Donner la pièce&quot;&gt;&gt;&lt;!-- #######Donnerpièce######--&gt;
		&lt;&lt;replace &quot;#voleur&quot;&gt;&gt;
&lt;&lt;set $pieceor to false&gt;&gt;
Bien que le dragon soit âgé, vous préférez ne pas prendre de risques et vous lui donnez la pièce et il vous laisse repartir sans vous dévorer. 
[[Suite-&gt;Portesecrete]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;link &quot;Fuir&quot;&gt;&gt;&lt;!-- ###############Fuir############--&gt;
		&lt;&lt;replace &quot;#voleur&quot;&gt;&gt;
		&lt;&lt;if $gateau eq true&gt;&gt;
		&lt;&lt;set $dragon to &quot;mouton&quot;&gt;&gt;
		&lt;img class=&quot;illustration&quot; alt=&quot;mouton&quot; src=&quot;media/pictures/illustrations/mouton.png&quot;/&gt;
Vous courez et, le dragon se mettant à votre poursuite, vous vous dites que votre vie ne valait peut-être pas une pièce d&#39;or en fin de compte. Alors que vous sentez que votre fin approche, vous n&#39;entendez plus la course lourde du dragon. Ne comprenant pas, vous vous retournez pour apercevoir que derrière vous se trouve un mouton qui broute paisiblement l&#39;herbe le long du chemin. Bizarrement, vous commencez à avoir faim en le regardant…
[[Suite-&gt;Portesecrete]]
&lt;!-- bruit mouton--&gt;
		&lt;&lt;else&gt;&gt;
&lt;&lt;set $variable to random(1,10)&gt;&gt;
			&lt;&lt;if $variable &lt; 4&gt;&gt;
Profitant d&#39;un moment d&#39;inattention de la part du dragon, vous fuyez en courant aussi vite que possible. Le dragon se mettant à votre poursuite et se rapprochant de plus en plus, vous sentez la fin arriver et c&#39;est alors que vous glissez sur une pierre, vous faisant alors tomber dans le ravin bordant le chemin.
Tant bien que mal, vous vous en sortez sans blessures et vous entendez alors le dragon proférer ses dernières menaces :
-Tu as de la chance que c&#39;est plus de mon âge de voler à la poursuite de voleur de ton espèce mais soit sûr que la prochaine fois que tu passeras, je me chargerai de toi...
[[Suite-&gt;Portesecrete]]
			&lt;&lt;else&gt;&gt;
Vous tentez votre chance face au dragon en espérant que ces années resté sans bouger l&#39;empêcheront de vous rattraper. Vous courez aussi vite que possible pour lui échapper mais le bruit lourd de ses pas se rapproche rapidement. Sachant que c&#39;est la fin pour vous, vous regrettez d&#39;avoir risqué votre vie pour une simple pièce et c&#39;est alors que la mâchoire du dragon se referme sur vous...
&lt;&lt;set $bad_end to &quot;mange&quot;&gt;&gt;
[[Fin-&gt;fin]]
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;
	&lt;&lt;else&gt;&gt;&lt;!-- ############Pas de pièce en poche##########--&gt;
Et c’est ainsi que vous laissez cette créature fantastique à la recherche de son trésor …
[[Suite-&gt;Portesecrete]]
	&lt;&lt;/if&gt;&gt;
			&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;
&lt;&lt;else&gt;&gt;&lt;!-- #################dragon = moto#############--&gt;
Le chien vous voyant arriver, file se cacher dans des buissons. N’apercevant personne dans les alentours, vous vous approchez de la moto, qui vrombisse. Las de marcher, vous envisagez de la prendre…
&lt;span id=&quot;moto&quot;&gt;
	&lt;&lt;link &quot;Enfourcher la moto&quot;&gt;&gt;
		&lt;&lt;replace &quot;#moto&quot;&gt;&gt;
Et c’est ainsi que vous décidez &quot;d’emprunter&quot; le bolide à son mystérieux possesseur et que vous vous élancez à toute blinde sur la route. Le paysage défilant à toute vitesse, les cheveux au vent, vous pouvez sentir la puissance du bolide.  C’est alors que celui-ci semble cafouiller, éventuellement de mécontentement (après tout la moto a peut-être quelque chose de magique) et, après une embardé, prend la direction des arbres. N’arrivant pas à rattraper la trajectoire, vous recevez une branche dans le torse, qui vous fait tomber de la moto, tandis que celle-ci continue sa course. Après avoir récupéré tout en maudissant la moto, que vous entendez au loin, vous reprenez votre route avec une douleur dans la poitrine…
[[Suite-&gt;Portesecrete]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;link &quot;Continuer à pied&quot;&gt;&gt;
		&lt;&lt;replace &quot;#moto&quot;&gt;&gt;
Vous méfiant de tout ce qui se rattache à ce mystérieux lieu, vous préférez ne pas prendre le risque de mécontenter l’énigmatique possesseur de la moto. Et c’est ainsi que, contre l’avis de vos semelles, vous repartez …
[[Suite-&gt;Portesecrete]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata>
<tw-passagedata pid="13" name="1er_ingrédient" tags="" position="334,1296">&lt;&lt;nobr&gt;&gt;
&lt;!-- La potion de liquéfaction doit être neutralisé en annulant son acidité et sa liquidité :
 Poussière de feu pour assécher la potion
 Glace pour solidifier la potion
 Champignon pour diminuer l&#39;acidité de la potion --&gt;
&lt;div id=&quot;chaudron_container&quot;&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 6&quot; data-zi=&quot;6&quot; src=&quot;media/pictures/illustrations/chaudron2.png&quot; alt=&quot;chaudron ok&quot; title=&quot;Ça commencer à chauffer...&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 5&quot; data-zi=&quot;5&quot; src=&quot;media/pictures/illustrations/chaudron2_1.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 4&quot; data-zi=&quot;4&quot; src=&quot;media/pictures/illustrations/chaudron2_2.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 3&quot; data-zi=&quot;3&quot; src=&quot;media/pictures/illustrations/chaudron2_3.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 2&quot; data-zi=&quot;2&quot; src=&quot;media/pictures/illustrations/chaudron2_4.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 1&quot; data-zi=&quot;1&quot; src=&quot;media/pictures/illustrations/chaudron3.png&quot; alt=&quot;chaudron critique&quot; title=&quot;AU SECOURS !!!&quot;/&gt;
&lt;/div&gt;
&lt;&lt;/nobr&gt;&gt;\
&lt;&lt;silently&gt;&gt;&gt;
&lt;&lt;audio &quot;:playing&quot; stop&gt;&gt;
&lt;&lt;audio &quot;1sttimer&quot; play&gt;&gt;
&lt;&lt;audio &quot;1sttimer&quot; time 15&gt;&gt;
&lt;&lt;set $image_index to 6&gt;&gt;
&lt;&lt;set $alea to random(1,3)&gt;&gt;

    &lt;&lt;repeat 8s&gt;&gt;
		&lt;&lt;script&gt;&gt;
		var $image_index = state.active.variables.image_index;
		$(&#39;img.chaudron[data-zi=&#39;+$image_index+&#39;]&#39;).animate({opacity: 0}, 1000);
		&lt;&lt;/script&gt;&gt;
		&lt;&lt;set $image_index to $image_index - 1&gt;&gt;
		&lt;&lt;if $image_index eq 1&gt;&gt;
			&lt;&lt;stop&gt;&gt;
        &lt;&lt;/if&gt;&gt;
    &lt;&lt;/repeat&gt;&gt;

&lt;&lt;timed 40s&gt;&gt;
  &lt;&lt;audio &quot;thunder&quot; volume 1 fadeoverto 5 0&gt;&gt;
  &lt;&lt;replace &quot;#first-ing-desc-text&quot;&gt;&gt;
  Plus le temps d&#39;observer le chaudron, il faut vous &#39;&#39;DEPÊCHER&#39;&#39; de choisir !!
  &lt;&lt;/replace&gt;&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;/silently&gt;&gt;
&lt;span id=&quot;first-ing-desc-text&quot;&gt;
	Vous reprenez place au-dessus du chaudron, lequel est plus agité et menaçant que jamais, et vous observez son contenu. Vous n&#39;avez encore jamais rien vu de tel: la potion semble avoir atteint un état de fluidité si totale, que l&#39;oeil humain peine à encore la percevoir comme liquide. Le contenu du chaudron ressemble désormais presque plus à un nuage d&#39;orage sombre, habité d&#39;éclairs magiques occasionnels, qu&#39;à une potion. La substance est manifestement hautement volatile. Même corrosive, vous apercevez-vous en sentant votre peau commencer à vous démanger au bout d&#39;à peine quelques instants passés penché sur le chaudron.
	
	Après une seconde de réflexion, vous décidez donc que l&#39;urgence est d&#39;abord d&#39;annuler l&#39;acidité de la potion et de lui redonner une consistance plus ragoûtante. Vous farfouillez parmi les ingrédients vous restant sur votre table de travail. Trois d&#39;entre eux retiennent d&#39;abord votre attention, bien que vos connaissances alchimiques ne soient plus aussi bonnes que par le passé et que vous craignez de faire une terrible erreur. Mais on ne vit qu&#39;une fois !
&lt;/span&gt;

&lt;span id=&quot;1eringr&quot;&gt;[[Ajouter de la poussière de feu-&gt;poussièredefeu]]
[[Ajouter un fragment de glace éternelle-&gt;glace]]
[[Jeter négligemment quelques champignons-&gt;champignon]]&lt;/span&gt;

&lt;&lt;timed 45s&gt;&gt;
	&lt;&lt;remove &quot;#first-ing-desc-text&quot;&gt;&gt;
	&lt;&lt;replace &quot;#1eringr&quot;&gt;&gt;
	Vous êtes manifestement indécis, mais le temps ne vous attend pas et le chaudron s&#39;agite de plus en plus. Bientôt, il semble comme sur le point d&#39;exploser, bouillonnant avec des bruits de tonnerre, attendre plus longtemps pour agir n&#39;est vraiment plus raisonnable. Vous vous emparez du premier ingrédient qui vous passe sous la main:&lt;&lt;if $alea eq 1&gt;&gt; [[la poussière de feu !-&gt;poussièredefeu]]&lt;&lt;elseif $alea eq 2&gt;&gt; [[un fragment de glace éternelle !-&gt;glace]]&lt;&lt;elseif $alea eq 3&gt;&gt; [[une poignée de champignons !-&gt;champignon]]&lt;&lt;/if&gt;&gt;
	&lt;&lt;/replace&gt;&gt;
&lt;&lt;/timed&gt;&gt;</tw-passagedata>
<tw-passagedata pid="14" name="poussièredefeu" tags="" position="575,1251">&lt;&lt;nobr&gt;&gt;
&lt;!-- fera brûler  le bâton dans la rivière s&#39;il nest pas porté hors de l&#39;eau--&gt;
&lt;!-- Il reste encore l&#39;effet acide à réduire. --&gt;
&lt;div id=&quot;chaudron_container&quot;&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 6&quot; data-zi=&quot;6&quot; src=&quot;media/pictures/illustrations/chaudron2.png&quot; alt=&quot;chaudron ok&quot; title=&quot;Ça commencer à chauffer...&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 5&quot; data-zi=&quot;5&quot; src=&quot;media/pictures/illustrations/chaudron2_1.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 4&quot; data-zi=&quot;4&quot; src=&quot;media/pictures/illustrations/chaudron2_2.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 3&quot; data-zi=&quot;3&quot; src=&quot;media/pictures/illustrations/chaudron2_3.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 2&quot; data-zi=&quot;2&quot; src=&quot;media/pictures/illustrations/chaudron2_4.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 1&quot; data-zi=&quot;1&quot; src=&quot;media/pictures/illustrations/chaudron3.png&quot; alt=&quot;chaudron critique&quot; title=&quot;AU SECOURS !!!&quot;/&gt;
&lt;/div&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;silently&gt;&gt;&gt;
&lt;&lt;set $poussièredefeu to true&gt;&gt;
&lt;&lt;set $alea to random(1,3)&gt;&gt;
&lt;&lt;audio &quot;:playing&quot; stop&gt;&gt;
&lt;&lt;audio &quot;2ndtimer_1&quot; play&gt;&gt;

&lt;&lt;set $image_index to 6&gt;&gt;

    &lt;&lt;repeat 8s&gt;&gt;
		&lt;&lt;script&gt;&gt;
		var $image_index = state.active.variables.image_index;
		$(&#39;img.chaudron[data-zi=&#39;+$image_index+&#39;]&#39;).animate({opacity: 0}, 1000);
		&lt;&lt;/script&gt;&gt;
		&lt;&lt;set $image_index to $image_index - 1&gt;&gt;
		&lt;&lt;if $image_index eq 1&gt;&gt;
			&lt;&lt;stop&gt;&gt;
        &lt;&lt;/if&gt;&gt;
    &lt;&lt;/repeat&gt;&gt;

&lt;&lt;timed 40s&gt;&gt;
  &lt;&lt;audio &quot;thunder&quot; volume 1 fadeoverto 5 0&gt;&gt;
  &lt;&lt;remove &quot;#2eingr3_0&quot;&gt;&gt;
  &lt;&lt;remove &quot;#2eingr4_0&quot;&gt;&gt;
  &lt;&lt;replace &quot;#2eingr0&quot;&gt;&gt;
  Plus le temps d&#39;observer le chaudron, il faut vous &#39;&#39;DEPÊCHER&#39;&#39; de choisir !!
  &lt;&lt;/replace&gt;&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;span id=&quot;2eingr0&quot;&gt;
	La décision d&#39;incorporer de la poussière de feu à la préparation n&#39;était manifestement pas la meilleure, découvrez-vous une fois le forfait accompli. En effet, voilà que la potion semble avoir tout à fait renoncer à son état liquide et s&#39;être changée en un épais nuage de fumée noire d&#39;où il vous semble entendre résonner les rires démoniaques de créatures infernales que vous n&#39;avez aucune envie de rencontrer un jour.
	Cela se présente mal, mais vous avez encore manifestement la possibilité de tenter quelque chose. Vous vous mettez alors à fouiller parmi le reste de vos ingrédients à la recherche de quelque chose qui pourrait vous aider à stabiliser la potion.
&lt;/span&gt;
&lt;&lt;if $livre eq true&gt;&gt;
&lt;span id=&quot;2eingr3_0&quot;&gt;
	Finalement, ce sont votre précieux tabac, quelques feuilles d&#39;orties a priori tout à fait banales, et un flacon de bave de crapaud qui retiennent votre attention pour une nouvelle tentative de calmer le jeu. Les grondements du chaudron sont de plus en plus forts et la mixture, parsemée de lueurs manifestement magiques et inquiétantes, menace de se renverser à tout instant.
&lt;/span&gt;
	
&lt;span id=&quot;2eingr3&quot;&gt;[[Renoncer à votre tabac-&gt;tabac]]
[[Vous débarasser des feuilles d&#39;orties-&gt;orties]]
[[Verser la bave de crapaud dans le chaudron-&gt;bave]]&lt;/span&gt;

&lt;&lt;timed 45s&gt;&gt;
	&lt;&lt;replace &quot;#2eingr3&quot;&gt;&gt;
		Le choix est difficile, et il faut bien dire qu&#39;aucune solution ne vous inspire confiance. Cependant, il faut vraiment vraiment faire un choix maintenant, car le chaudron s&#39;est soudain arrêter de bouillonner, pour plutôt se montrer comme secoué de soubresauts à intervalles réguliers. Un peu comme si quelque chose essayait d&#39;enfoncer une porte, une porte entre les dimensions en l&#39;occurence... Vous tentez donc le coup avec le premier truc qui vous passe sous la main:&lt;&lt;if $alea eq 1&gt;&gt; [[le tabac !-&gt;tabac]]&lt;&lt;elseif $alea eq 2&gt;&gt; [[le bocal de bave de crapaud !-&gt;bave]]&lt;&lt;elseif $alea eq 3&gt;&gt; [[les feuilles d&#39;orties !-&gt;orties]]&lt;&lt;/if&gt;&gt;
	&lt;&lt;/replace&gt;&gt;
&lt;&lt;/timed&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;span id=&quot;2eingr4_0&quot;&gt;
Finalement, ce sont quelques feuilles d&#39;orties a priori tout à fait banales, un flacon de bave de crapaud et une maigre collection d&#39;ossements (qui maintenant que vous les remarquez vous font froid dans le dos) qui retiennent votre attention pour une nouvelle tentative de calmer le jeu. Les grondements du chaudron sont de plus en plus forts et la mixture, parsemée de lueurs manifestement magiques et inquiétantes, menace de se renverser à tout instant.
&lt;/span&gt;
	
&lt;span id=&quot;2eingr4&quot;&gt;[[Vous débarasser des feuilles d&#39;orties-&gt;orties]]
[[Verser la bave de crapaud dans le chaudron-&gt;bave]]
[[Tenter votre chance en introduisant un des os dans la mixture-&gt;os]]&lt;/span&gt;

&lt;&lt;timed 45s&gt;&gt;
	&lt;&lt;replace &quot;#2eingr4&quot;&gt;&gt;
		Le choix est difficile, et il faut bien dire qu&#39;aucune solution ne vous inspire confiance. Cependant, il faut vraiment vraiment faire un choix maintenant, car le chaudron s&#39;est soudain arrêter de bouillonner, pour plutôt se montrer comme secoué de soubresauts à intervalles réguliers. Un peu comme si quelque chose essayait d&#39;enfoncer une porte, une porte entre les dimensions en l&#39;occurence... Vous tentez donc le coup avec le premier truc qui vous passe sous la main:&lt;&lt;if $alea eq 1&gt;&gt; [[le tabac !-&gt;tabac]]&lt;&lt;elseif $alea eq 2&gt;&gt; [[le bocal de bave de crapaud !-&gt;bave]]&lt;&lt;elseif $alea eq 3&gt;&gt; [[les feuilles d&#39;orties !-&gt;orties]]&lt;&lt;/if&gt;&gt;
	&lt;&lt;/replace&gt;&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata>
<tw-passagedata pid="15" name="glace" tags="" position="577,1047">&lt;&lt;nobr&gt;&gt;
&lt;!-- fera geler la rivière--&gt;
&lt;!-- Il reste encore l&#39;effet acide à réduire. --&gt;
&lt;div id=&quot;chaudron_container&quot;&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 6&quot; data-zi=&quot;6&quot; src=&quot;media/pictures/illustrations/chaudron2.png&quot; alt=&quot;chaudron ok&quot; title=&quot;Ça commencer à chauffer...&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 5&quot; data-zi=&quot;5&quot; src=&quot;media/pictures/illustrations/chaudron2_1.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 4&quot; data-zi=&quot;4&quot; src=&quot;media/pictures/illustrations/chaudron2_2.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 3&quot; data-zi=&quot;3&quot; src=&quot;media/pictures/illustrations/chaudron2_3.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 2&quot; data-zi=&quot;2&quot; src=&quot;media/pictures/illustrations/chaudron2_4.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 1&quot; data-zi=&quot;1&quot; src=&quot;media/pictures/illustrations/chaudron3.png&quot; alt=&quot;chaudron critique&quot; title=&quot;AU SECOURS !!!&quot;/&gt;
&lt;/div&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;silently&gt;&gt;&gt;
&lt;&lt;set $glace to true&gt;&gt;
&lt;&lt;set $alea to random(1,3)&gt;&gt;
&lt;&lt;audio &quot;:playing&quot; stop&gt;&gt;
&lt;&lt;audio &quot;2ndtimer_1&quot; play&gt;&gt;

&lt;&lt;set $image_index to 6&gt;&gt;

    &lt;&lt;repeat 8s&gt;&gt;
		&lt;&lt;script&gt;&gt;
		var $image_index = state.active.variables.image_index;
		$(&#39;img.chaudron[data-zi=&#39;+$image_index+&#39;]&#39;).animate({opacity: 0}, 1000);
		&lt;&lt;/script&gt;&gt;
		&lt;&lt;set $image_index to $image_index - 1&gt;&gt;
		&lt;&lt;if $image_index eq 1&gt;&gt;
			&lt;&lt;stop&gt;&gt;
        &lt;&lt;/if&gt;&gt;
    &lt;&lt;/repeat&gt;&gt;

&lt;&lt;timed 40s&gt;&gt;
  &lt;&lt;audio &quot;thunder&quot; volume 1 fadeoverto 5 0&gt;&gt;
  &lt;&lt;remove &quot;#2eingr1_0&quot;&gt;&gt;
  &lt;&lt;remove &quot;#2eingr2_0&quot;&gt;&gt;
  &lt;&lt;replace &quot;#2eingr0&quot;&gt;&gt;
  Plus le temps d&#39;observer le chaudron, il faut vous &#39;&#39;DEPÊCHER&#39;&#39; de choisir !!
  &lt;&lt;/replace&gt;&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;span id=&quot;2eingr0&quot;&gt;
	Après avoir sacrifié au chaudron un fragment de glace éternelle de votre collection personnelle d&#39;objets magiques rares, vous constatez une amélioration relative. En tout cas, la potion vous semble d&#39;un seul coup beaucoup plus épaisse et vous ne la confondez plus avec un nuage.

	Pour autant, vous n&#39;êtes pas encore sorti d&#39;affaire, et le chaudron ne semble pas s&#39;être calmé le moins du monde. Il est violemment secoué sous l&#39;effet de ses bouillonnements assourdissants, et si avant vous pouviez redouter l&#39;expansion d&#39;une tempête magique, vous êtes maintenant tout à fait livré à l&#39;inconnu quant à la façon dont les choses peuvent empirer. Autant dire que l&#39;inquiétude se renforce encore sur votre visage.
	Vous vous mettez alors à fouiller parmi le reste de vos ingrédients à la recherche de quelque chose qui pourrait vous aider à stabiliser la potion.
&lt;/span&gt;
&lt;&lt;if $livre eq true&gt;&gt;
&lt;span id=&quot;2eingr1_0&quot;&gt;
	Finalement, ce sont votre précieux tabac, quelques feuilles d&#39;orties a priori tout à fait banales, et un flacon de bave de crapaud qui retiennent votre attention pour une nouvelle tentative de calmer le jeu. Les grondements du chaudron sont de plus en plus forts et la mixture, parsemée de lueurs manifestement magiques et inquiétantes, menace de se renverser à tout instant.
&lt;/span&gt;
	
&lt;span id=&quot;2eingr1&quot;&gt;[[Renoncer à votre tabac-&gt;tabac]]
[[Vous débarasser des feuilles d&#39;orties-&gt;orties]]
[[Verser la bave de crapaud dans le chaudron-&gt;bave]]&lt;/span&gt;

&lt;&lt;timed 45s&gt;&gt;
	&lt;&lt;replace &quot;#2eingr1&quot;&gt;&gt;
		Le choix est difficile, et il faut bien dire qu&#39;aucune solution ne vous inspire confiance. Cependant, il faut vraiment vraiment faire un choix maintenant, car le chaudron a déjà commencé à basculer et que quelques gouttes de la potion se sont répandues sur le feu. Ce dernier crépite violemment de flammes vertes, bleues, violettes, et vous craignez que toute votre cabane ne prenne feu. Vous tentez donc le coup avec le premier truc qui vous passe sous la main :&lt;&lt;if $alea eq 1&gt;&gt; [[le tabac !-&gt;tabac]]&lt;&lt;elseif $alea eq 2&gt;&gt; [[le bocal de bave de crapaud !-&gt;bave]]&lt;&lt;elseif $alea eq 3&gt;&gt; [[les feuilles d&#39;orties !-&gt;orties]]&lt;&lt;/if&gt;&gt;
	&lt;&lt;/replace&gt;&gt;
&lt;&lt;/timed&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;span id=&quot;2eingr2_0&quot;&gt;
	Finalement, ce sont quelques feuilles d&#39;orties a priori tout à fait banales, un flacon de bave de crapaud et une maigre collection d&#39;ossements (qui maintenant que vous les remarquez vous font froid dans le dos) qui retiennent votre attention pour une nouvelle tentative de calmer le jeu. Les grondements du chaudron sont de plus en plus forts et la mixture, parsemée de lueurs manifestement magiques et inquiétantes, menace de se renverser à tout instant.
&lt;/span&gt;
	
&lt;span id=&quot;2eingr2&quot;&gt;[[Vous débarasser des feuilles d&#39;orties-&gt;orties]]
[[Verser la bave de crapaud dans le chaudron-&gt;bave]]
[[Tenter votre chance en introduisant un des os dans la mixture-&gt;os]]&lt;/span&gt;

&lt;&lt;timed 45s&gt;&gt;
	&lt;&lt;replace &quot;#2eingr2&quot;&gt;&gt;
		Le choix est difficile, et il faut bien dire qu&#39;aucune solution ne vous inspire confiance. Cependant, il faut vraiment vraiment faire un choix maintenant, car le chaudron a déjà commencé à basculer et que quelques gouttes de la potion se sont répandues sur le feu. Ce dernier crépite violemment de flammes vertes, bleues, violettes, et vous craignez que toute votre cabane ne prenne feu. Vous tentez donc le coup avec le premier truc qui vous passe sous la main :&lt;&lt;if $alea eq 1&gt;&gt; [[l&#39;os !-&gt;os]]&lt;&lt;elseif $alea eq 2&gt;&gt; [[le bocal de bave de crapaud !-&gt;bave]]&lt;&lt;elseif $alea eq 3&gt;&gt; [[les feuilles d&#39;orties !-&gt;orties]]&lt;&lt;/if&gt;&gt;
	&lt;&lt;/replace&gt;&gt;
&lt;&lt;/timed&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata>
<tw-passagedata pid="16" name="champignon" tags="" position="575,1443">&lt;&lt;nobr&gt;&gt;
&lt;!-- champignons hallucinogènes qui agiront sur le groupe de scouts--&gt;
&lt;!-- L&#39;effet acide étant annulé, il faut estomper l&#39;effet liquide --&gt;
&lt;&lt;set $champignon to true&gt;&gt;
&lt;&lt;set $alea to random(1,3)&gt;&gt;
&lt;div id=&quot;chaudron_container&quot;&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 6&quot; data-zi=&quot;6&quot; src=&quot;media/pictures/illustrations/chaudron2.png&quot; alt=&quot;chaudron ok&quot; title=&quot;Ça commencer à chauffer...&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 5&quot; data-zi=&quot;5&quot; src=&quot;media/pictures/illustrations/chaudron2_1.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 4&quot; data-zi=&quot;4&quot; src=&quot;media/pictures/illustrations/chaudron2_2.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 3&quot; data-zi=&quot;3&quot; src=&quot;media/pictures/illustrations/chaudron2_3.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 2&quot; data-zi=&quot;2&quot; src=&quot;media/pictures/illustrations/chaudron2_4.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 1&quot; data-zi=&quot;1&quot; src=&quot;media/pictures/illustrations/chaudron3.png&quot; alt=&quot;chaudron critique&quot; title=&quot;AU SECOURS !!!&quot;/&gt;
&lt;/div&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;silently&gt;&gt;
&lt;&lt;audio &quot;:playing&quot; stop&gt;&gt;
&lt;&lt;audio &quot;2ndtimer_1&quot; play&gt;&gt;

&lt;&lt;set $image_index to 6&gt;&gt;

    &lt;&lt;repeat 8s&gt;&gt;
		&lt;&lt;script&gt;&gt;
		var $image_index = state.active.variables.image_index;
		$(&#39;img.chaudron[data-zi=&#39;+$image_index+&#39;]&#39;).animate({opacity: 0}, 1000);
		&lt;&lt;/script&gt;&gt;
		&lt;&lt;set $image_index to $image_index - 1&gt;&gt;
		&lt;&lt;if $image_index eq 1&gt;&gt;
			&lt;&lt;stop&gt;&gt;
        &lt;&lt;/if&gt;&gt;
    &lt;&lt;/repeat&gt;&gt;

&lt;&lt;timed 40s&gt;&gt;
  &lt;&lt;audio &quot;thunder&quot; volume 1 fadeoverto 5 0&gt;&gt;
  &lt;&lt;remove &quot;#2eingr5_0&quot;&gt;&gt;
  &lt;&lt;remove &quot;#2eingr6_0&quot;&gt;&gt;
  &lt;&lt;replace &quot;#2eingr0&quot;&gt;&gt;
  Plus le temps d&#39;observer le chaudron, il faut vous &#39;&#39;DEPÊCHER&#39;&#39; de choisir !!
  &lt;&lt;/replace&gt;&gt;
&lt;&lt;/timed&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;span id=&quot;2eingr0&quot;&gt;
	Vous vous sentez partiellement rassuré quand, une fois les champignons disparus dans la mixture, l&#39;atmosphère commence à redevenir respirable et que vos réactions cutanées s&#39;estompent. Vous avez apparemment porté un grand coup à l&#39;acidité de la potion !
	Cela dit, la joie est de courte durée, car vous vous rendez bien vite compte que les choses ne s&#39;arrangent pas forcément aussi facilement. Certes, la potion n&#39;est plus corrosive, mais elle a toujours cette étrange apparence de nuage liquide, et de nuage très menaçant, pour le coup. Vous avez de quoi craindre qu&#39;une tempête magique, un ouragan (que dîtes-vous, un cyclone même !) ne se déclenche depuis votre chaudron qui gronde, gronde, et gronde encore, habité d&#39;éclairs d&#39;énergie multicolores.
	Cela se présente mal, mais vous avez encore manifestement la possibilité de tenter quelque chose. Vous vous mettez alors à fouiller parmi le reste de vos ingrédients à la recherche de quelque chose qui pourrait vous aider à stabiliser la potion.
&lt;/span&gt;
&lt;&lt;if $livre eq true&gt;&gt;
&lt;span id=&quot;2eingr5_0&quot;&gt;
	Finalement, ce sont votre précieux tabac, une corne de licorne aux propriétés magiques réputées extraordinaires en toutes circonstances, et un flacon de bave de crapaud qui retiennent votre attention pour une nouvelle tentative de calmer le jeu. Les grondements du chaudron sont de plus en plus forts et la mixture, devenue petit phénomène météorologique magique, menace de laisser éclater sa puissance à tout instant.
&lt;/span&gt;

&lt;span id=&quot;2eingr5&quot;&gt;[[Renoncer à votre tabac-&gt;tabac]]
[[Sacrifier votre précieuse corne de licorne-&gt;corne]]
[[Verser la bave de crapaud dans le chaudron-&gt;bave]]&lt;/span&gt;

&lt;&lt;timed 45s&gt;&gt;
	&lt;&lt;replace &quot;#2eingr5&quot;&gt;&gt;
		Alors que vous êtes plongé dans vos réflexions et vos calculs magiques, un formidable coup de tonnerre vous fait faire un bond. Un coup d&#39;oeil au chaudron vous informe de l&#39;extrême urgence de la situation, étant donné le fait que le nuage liquide noir a commencé à prendre de l&#39;ampleur et à s&#39;extraire de son récipient. L&#39;heure n&#39;est plus aux tergiversations, il faut agir. Vous tentez donc le coup avec le premier truc qui vous passe sous la main:&lt;&lt;if $alea eq 1&gt;&gt; [[la corne de licorne !-&gt;corne]]&lt;&lt;elseif $alea eq 2&gt;&gt; [[le bocal de bave de crapaud !-&gt;bave]]&lt;&lt;elseif $alea eq 3&gt;&gt; [[le tabac !-&gt;tabac]]&lt;&lt;/if&gt;&gt;
	&lt;&lt;/replace&gt;&gt;
&lt;&lt;/timed&gt;&gt;

&lt;&lt;else&gt;&gt;
&lt;span id=&quot;2eingr6_0&quot;&gt;
	Finalement, ce sont une corne de licorne aux propriétés magiques réputées extraordinaires en toutes circonstances, un flacon de bave de crapaud, et une maigre collection d&#39;ossements (qui maintenant que vous les remarquez vous font froid dans le dos) qui retiennent votre attention pour une nouvelle tentative de calmer le jeu. Les grondements du chaudron sont de plus en plus forts et la mixture, devenue petit phénomène météorologique magique, menace de laisser éclater sa puissance à tout instant.
&lt;/span&gt;

&lt;span id=&quot;2eingr6&quot;&gt;[[Sacrifier votre précieuse corne de licorne-&gt;corne]]
[[Verser la bave de crapaud dans le chaudron-&gt;bave]]
[[Tenter votre chance en introduisant un des os dans la mixture-&gt;os]]&lt;/span&gt;

&lt;&lt;timed 45s&gt;&gt;
	&lt;&lt;replace &quot;#2eingr6&quot;&gt;&gt;
		Alors que vous êtes plongé dans vos réflexions et vos calculs magiques, un formidable coup de tonnerre vous fait faire un bond. Un coup d&#39;oeil au chaudron vous informe de l&#39;extrême urgence de la situation, étant donné le fait que le nuage liquide noir a commencé à prendre de l&#39;ampleur et à s&#39;extraire de son récipient. L&#39;heure n&#39;est plus aux tergiversations, il faut agir. Vous tentez donc le coup avec le premier truc qui vous passe sous la main:&lt;&lt;if $alea eq 1&gt;&gt; [[la corne de licorne !-&gt;corne]]&lt;&lt;elseif $alea eq 2&gt;&gt; [[le bocal de bave de crapaud !-&gt;bave]]&lt;&lt;elseif $alea eq 3&gt;&gt; [[le tabac !-&gt;tabac]]&lt;&lt;/if&gt;&gt;
	&lt;&lt;/replace&gt;&gt;
&lt;&lt;/timed&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata>
<tw-passagedata pid="17" name="tabac" tags="" position="940,984">&lt;&lt;silently&gt;&gt;
&lt;!-- les nains de jardin tousseront en pestant contre le sorcier et ses expériences--&gt;
&lt;&lt;set $tabac to true&gt;&gt;
&lt;&lt;audio &quot;:playing&quot; stop&gt;&gt;
&lt;&lt;audio &quot;2ndtimer_2&quot; volume 0.7 loop play&gt;&gt;
&lt;&lt;audio &quot;snoring&quot; loop volume 0.25 fadeto 0.5&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Devant l&#39;urgence de la situation, vous choisissez de sacrifier votre prestigieux tabac, importé tout droit d&#39;un fameux petit village dont les producteurs maîtrisent les techniques ancestrales de fabrication, depuis des millénaires. C&#39;est donc à contrecoeur que vous jetez dans la mixture votre onéreux tabac, afin d&#39;épaissir la potion, tout en gardant une quantité raisonnable pour votre pipe.
 Le tabac dissout dans la potion, le chaudron semble alors retrouver sa quiétude habituelle. Fatigué par les événements, vous décidez de vous allongez sur votre lit quelques instants, le temps de récupérer.
Et c&#39;est lentement que vos yeux se ferment, et que vous retournez vous nicher dans les bras de Morphée...
[[Poursuivre l&#39;histoire-&gt;Phase2]]</tw-passagedata>
<tw-passagedata pid="18" name="orties" tags="" position="938,1258">&lt;&lt;silently&gt;&gt;
&lt;!-- les nains de jardin se gratteront en pestant contre le sorcier et ses expériences--&gt;
&lt;&lt;set $orties to true&gt;&gt;
&lt;&lt;audio &quot;:playing&quot; stop&gt;&gt;
&lt;&lt;audio &quot;2ndtimer_2&quot; volume 0.7 loop play&gt;&gt;
&lt;&lt;audio &quot;snoring&quot; loop volume 0.25 fadeto 0.5&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Dépéché, par l&#39;urgence de la situation, à épaissir la mixture instable, et ne trouvant pas vos gants, vous décidez de prendre la poignée d&#39;orties à pleines mains pour l&#39;incorporer à la mixture. Ravalant l&#39;envie de vous gratter, vous regardez les feuilles se dissoudrent dans la décoction instable. La marmite se stabilisant et reprenant son habituelle quiétude, vous vous félicitez de votre prouesse à faire face à l&#39;imprévu. Vos démangeaisons persistant, vous vous essuyez  vos mains dans votre chiffon magique.
Fatigué par les événements, vous décidez de vous allongez sur votre lit quelques instants, le temps de récupérer.
Et c&#39;est lentement que vos yeux se ferment, et que vous retournez vous nicher dans les bras de Morphée...
[[Poursuivre l&#39;histoire-&gt;Phase2]] </tw-passagedata>
<tw-passagedata pid="19" name="bave" tags="" position="940,1132">&lt;&lt;silently&gt;&gt;
&lt;!-- augmentera les chances de chute dans le raccourci--&gt;
&lt;&lt;set $bave to true&gt;&gt;
&lt;&lt;audio &quot;:playing&quot; stop&gt;&gt;
&lt;&lt;audio &quot;2ndtimer_2&quot; volume 0.7 loop play&gt;&gt;
&lt;&lt;audio &quot;snoring&quot; loop volume 0.25 fadeto 0.5&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Prenant le bocal vitrifié de bave de crapaud, collectée au cours de ces dernières semaines de chasse, par un temps pluvieux, vous tentez de l&#39;ouvrir. N&#39;y arrivant pas, poussé par l&#39;urgence de la situation, vous le jetez dans la marmite en espérant que le bocal ne résiste pas à l&#39;effet de la mixture. En voyant le bocal couler, vous vous sentez rassuré losque la marmite se stabilise pour retrouver sa quiétude innoffensive. Fatigué par les événements, vous décidez de vous allongez sur votre lit quelques instants, le temps de récupérer.
Et c&#39;est lentement que vos yeux se ferment, et que vous retournez vous nicher dans les bras de Morphée...

[[Poursuivre l&#39;histoire-&gt;Phase2]] </tw-passagedata>
<tw-passagedata pid="20" name="marmite" tags="" position="189,1150">&lt;&lt;set $livre to true&gt;&gt;
&lt;&lt;audio &quot;boiling&quot; volume 0.25 fadeto 0.5&gt;&gt;
&lt;div id=&quot;chaudron_container&quot;&gt;
 &lt;img class=&quot;chaudron&quot; src=&quot;media/pictures/illustrations/chaudron2.png&quot; alt=&quot;chaudron moins ok&quot; title=&quot;Ça chauffe !&quot;/&gt;
&lt;/div&gt;
Après vous être rapidement étiré (dans une cacophonie de craquements osseux, la vieillesse ne vous a pas épargné), vous vous dirigez le plus tranquillement du monde vers votre chaudron.

Mais en vous penchant au-dessus de la décoction, vous vous rendez compte que c&#39;est le drame. Vous avez manifestement raté quelque chose pendant la préparation de la veille, car la potion a pris une couleur et une odeur inquiétantes, sans parler du fait qu&#39;elle bout dangereusement fort. Au cours de votre longue vie de magicien vous avez déjà connu de telles situations et vous savez que si vous ne faîtes rien pour arranger les choses tout peut vite dégénérer et passer hors de contrôle.

Ne sachant précisément d&#39;où vient le problème et ne sachant donc pas comment arranger les choses, vous courez à votre bibliothèque afin de trouver une solution. Après un coup d&#39;oeil rapide sur vos étagères c&#39;est un trio de trois tranches de livre sur lesquelles aucun titre n&#39;est indiqué qui retient votre attention. Il vous semble que parmi ceux-là se trouve une référence des ouvrages alchimiques...

&lt;span id=&quot;livre&quot;&gt;
&lt;&lt;link &quot;Prendre le livre violet&quot;&gt;&gt;
&lt;&lt;replace &quot;#livre&quot;&gt;&gt;
	Vous délogez le livre à la couverture violette de son étagère et vous apprêtez à l&#39;ouvrir lorsque votre porte d&#39;entrée s&#39;ouvre avec violence. Vous sursautez et portez un regard inquiet sur l&#39;entrée désormais bâillante de votre cabane. Il semble pourtant que cela n&#39;était qu&#39;un fort courant d&#39;air, car vous n&#39;y apercevez personne. Vous reportez donc une nouvelle fois votre attention sur le livre encore entre vos mains...
- En bas, vieux schnock !
Vous sursautez une nouvelle fois mais baissez les yeux vers le sol où vous découvrez trois nains de jardins tout ce qu&#39;il y a de plus animés et visiblement mécontents, à en juger par leurs bras croisés et leurs sourcils froncés.
- Ah ! Vous ! Ce n&#39;est vraiment pas le moment..., commencez-vous à dire, avant d&#39;être brutalement coupé par un des intrus.
- Assez de vos excuses vieillard ! Nous avons rédigé une liste de réclamations regardant notre condition d&#39;esclaves forcés magiquement à vous obéir, que nous considérons tout à fait raisonnable compte-tenu de l&#39;illégalité totale de notre situation. Il n&#39;est plus acceptable à notre époque, même pour des nains de jardin, de continuer à vivre dans les conditions effroyables dans lesquelles vous nous laissez...

&lt;span id=&quot;choix1&quot;&gt;&lt;&lt;link &quot;Continuer à écouter les réclamations des nains de jardin&quot;&gt;&gt;
&lt;&lt;replace &quot;#choix1&quot;&gt;&gt;
	Vous serrez les dents, ravalez vos remarques acerbes et vous vous préparez à subir la diarrhée verbale qui s&#39;apprête à se déverser sur vous.
- Nous exigeons donc: 1. de ne plus dormir dehors, c&#39;est extrêmement dégradant, et d&#39;au moins obtenir un abri, une cabane à notre taille, que nous ne doutons pas que votre magie soit capable de faire apparaître en un instant...
	Vous battez du pied contre le sol et vous contorsionnez sur vous-mêmes d&#39;impatience et d&#39;inquiétude par rapport au chaudron dont les bouillonnements sont loins de diminuer.
- Nous exigeons également: 2. Un salaire, au moins suffisamment substantiel pour acheter régulièrement des bonbons chez &quot;Les fins gourmets de la forêt&quot;. Tout travail mérite rétribution et ce n&#39;est pas parce que nous n&#39;avons pas d&#39;impératif biologique à nous nourrir que nous n&#39;apprécions pas une petite friandise occasionnelle !
	Vos yeux vont du chaudron décidément de plus en plus énervé au livre que vous avez ouvert au hasard pour vous essayer au multitâche. Hélas, la logorrhée des nains aux timbres particulièrement aigus et discordant vous tape sur les nerfs et vous n&#39;arrivez pas à comprendre un traître mot de ce que vous lisez.
- Et nous exigeons aussi: 3. Au moins une journée de repos par semaine, ainsi que chacun devrait pouvoir le réclam...
	Soudain c&#39;en est trop ! La pression vous écrase, la sueur dégouline de votre visage jusque dans votre barbe habituellement si soyeuse (ou en tout cas, ce que vous prenez pour soyeux...) ! Dans un geste rageur vous jetez votre livre, dont vous vous rendez compte au dernier moment que le titre était en fait &quot;L&#39;illusion du choix, tome 1&quot;, dans le chaudron, qui semble surpris par cette offrande et cesse un moment de s&#39;agiter. Toujours habité par la colère, vous vous employez alors à mettre les nains à la porte à force de coups de pied (ils sont solides, il y a plus à s&#39;en faire pour votre pied que pour eux) et à grand renfort d&#39;insultes.
	
	Vous refermez la porte derrière vous et laissez échapper un soupir de soulagement. Soulagement de courte de durée cependant, car soudain le chaudron se met à trembler de plus belle, comme de rage, sous l&#39;effet du bouillonnement encore renforcé de la potion. Vous sentez que les choses sont en train de vous échapper. Il faut vite que vous vous débrouilliez pour stabiliser la potion avant que tout ne dégénère davantage...
	
	[[Il est temps de faire preuve d&#39;un peu de connaissances alchimiques.-&gt;1er_ingrédient]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;

&lt;&lt;link &quot;Rendre muets les empêcheurs de tourner en rond avec un sortilège à durée limitée&quot;&gt;&gt;
&lt;&lt;replace &quot;#choix1&quot;&gt;&gt;
Vous essayez de vous rappeler de la formule adéquate...

&lt;span id=&quot;choix2&quot;&gt;&lt;&lt;link &quot;- Fermesez voses bouchesées !&quot;&gt;&gt;
&lt;&lt;replace &quot;#choix2&quot;&gt;&gt;
- Fermesez voses bouchesées ! vous écriez vous soudain en dirigeant vos mains grandes ouvertes sur les nains.

Surpris, les nains cessent un instant de parler, les yeux ronds d&#39;étonnement. Puis, leurs bouches s&#39;ouvrent à nouveau, dans une tentative de crier au scandale. Hélas pour eux, leurs récriminations semblent bien être bloquées au fond de leur gorge, et aucun son n&#39;en peut plus sortir pour une petite heure.
	Fort satisfait de votre performance, vous ouvrez le livre violet et commencez à en lire quelques lignes. C&#39;était cependant sans compter sur la rage des petits êtres de jardin, visiblement peu heureux d&#39;avoir à subir un nouvel outrage magique de votre part. Ils se jettent sur vous et vous destabilisent. Vous êtes contraints, pour ne pas vous étaler de tout votre long, de laisser échapper le livre, dont vous apercevez alors seulement le titre écrit sur la couverture, tandis qu&#39;il chute dans les eaux sombres du chaudron: &quot;L&#39;illusion du choix, tome 1&quot;.
	Le chaudron semble surpris par cette offrande et cesse un moment de s&#39;agiter. Quant à vous, une fois votre équilibre retrouvé, vous ripostez avec fermeté et vous vous employez à mettre les nains à la porte à coups de pied (ils sont solides, il y a plus à s&#39;en faire pour votre pied que pour eux) et à grand renfort d&#39;insultes.
	
	Vous refermez la porte derrière vous et laissez échapper un soupir de soulagement. Soulagement de courte de durée cependant, car soudain le chaudron se met à trembler de plus belle, comme de rage, sous l&#39;effet du bouillonnement encore renforcé de la potion. Vous sentez que les choses sont en train de vous échapper. Il faut vite que vous vous débrouilliez pour stabiliser la potion avant que tout ne dégénère davantage...
	
	[[Il est temps de faire preuve d&#39;un peu de connaissances alchimiques.-&gt;1er_ingrédient]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;link &quot;- Chutatis toutabra d&#39;suitam !&quot;&gt;&gt;
&lt;&lt;replace &quot;#choix2&quot;&gt;&gt;
- Chutatis toutabra d&#39;suitam ! vous écriez vous soudain en dirigeant vos mains grandes ouvertes sur les nains.

Surpris, les nains cessent un instant de parler, les yeux ronds d&#39;étonnement. Puis, leurs bouches s&#39;ouvrent à nouveau, dans une tentative de crier au scandale. Hélas pour vous, vous réalisez alors que ce n&#39;était pas du tout la bonne formule, et ce sont des cris tonitruants qui sortent alors de la bouche des petits nains de jardin et vous vrillent les tympans. Vous avez augmenté leur puissance vocale pour une heure !
	Assourdi, vous essayez d&#39;abord de porter vos mains à vos oreilles pour vous protéger, mais ce n&#39;est guère efficace et les nains ne semblent pas portés sur l&#39;idée de se taire. Aux grands maux, les grands remèdes, vous jetez votre livre violet sur eux, réalisant ainsi un superbe strike qui renvoie les nains hors de la cabane. Toutefois, le livre rebondit inexplicablement sur le plancher et atterrit dans la potion, sans que vous ayez le temps de faire quoi que ce soit d&#39;autre qu&#39;entr&#39;apercevoir le titre du livre: &quot;L&#39;illusion du choix, tome 1&quot;.
	
	Le chaudron se met alors à trembler de plus belle, comme de rage, sous l&#39;effet du bouillonnement encore renforcé de la potion. Vous sentez que les choses sont en train de vous échapper. Il faut vite que vous vous débrouilliez pour stabiliser la potion avant que tout ne dégénère davantage...
	
	[[Il est temps de faire preuve d&#39;un peu de connaissances alchimiques.-&gt;1er_ingrédient]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;/span&gt;

&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;/span&gt;

&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;

&lt;&lt;link &quot;Prendre le livre vert&quot;&gt;&gt;
&lt;&lt;replace &quot;#livre&quot;&gt;&gt;
	Vous délogez le livre à la couverture verte de son étagère et vous vous apprêtez à l&#39;ouvrir lorsque votre fenêtre s&#39;ouvre avec violence. Ce qui vous semble être un projectile lancé à toute vitesse exécute plusieurs cercles à raz de votre plafond avant de se poser au sommet de votre bibliothèque.
	Une fois la frayeur première passée, vous réalisez qu&#39;il s&#39;agit d&#39;un hibou, et qu&#39;il vous fixe d&#39;un regard intense qui n&#39;est pas sans vous mettre mal à l&#39;aise.
	
&lt;span id=&quot;choixhibou1&quot;&gt;
&lt;&lt;link &quot;Ignorer le hibou pour l&#39;instant et vous concentrer sur le livre que vous venez de récupérer&quot;&gt;&gt;
&lt;&lt;replace &quot;#choixhibou1&quot;&gt;&gt;
	Vous effectuez un petit mouvement réprobatif de la tête mais haussez les épaules et ouvrez votre livre, espérant y trouver les précieuses informations dont vous avez besoin. Pourtant, vous vous apercevez vite que vous n&#39;arrivez pas à vous concentrer sur votre lecture: vous n&#39;arrivez pas à arrêter de surveiller l&#39;oiseau du coin de l&#39;oeil. Celui-ci n&#39;arrête pas non plus de vous fixer, et un frisson monte le long de votre échine sous ce regard scrutateur. Serait-ce un mauvais esprit ou un démon déguisé en hibou et venu vous tourmenter ?... Ou pire ?
	Bientôt, vos pensées sont totalement obnubilées par l&#39;oiseau, l&#39;obsession vous prend, vous ne pouvez plus penser à rien d&#39;autre. Est-ce qu&#39;il vous regarde encore ? Et ce bec ? N&#39;est-il pas particulièrement aiguisé ? Trop acéré pour être  celui d&#39;un simple oiseau ?...
	
	Soudain, un ululement strident retentit et vous fait violemment sursauter, vous tirant enfin de vos pensées, mais faisant également bondir le livre que vous aviez oublié entre vos mains. A l&#39;issue d&#39;un vol plané auquel vous ne pouvez qu&#39;assister, le coeur battant, l&#39;ouvrage termine sa course dans la potion, non sans que vous ayez au moins eu le temps d&#39;enfin apercevoir son titre: &quot;L&#39;illusion du choix, tome 2&quot;. Vous restez estomaqué encore quelques secondes, lesquelles le hibou décide de mettre à profit pour repartir par la fenêtre aussi diligemment qu&#39;il était venu.
	Le chaudron quant à lui s&#39;est mis à trembler de plus belle, comme de rage, sous l&#39;effet du bouillonnement encore renforcé par l&#39;intrusion du livre dans la potion. Reprenant peu à peu vos esprits, vous sentez que les choses sont en train de vous échapper. Il faut vite que vous vous débrouilliez pour stabiliser la potion avant que tout ne dégénère davantage...
	
	[[Il est temps de faire preuve d&#39;un peu de connaissances alchimiques.-&gt;1er_ingrédient]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;

&lt;&lt;link &quot;Chasser l&#39;oiseau de votre demeure, vous n&#39;avez pas besoin d&#39;avoir à vous inquiéter de ça en plus&quot;&gt;&gt;
&lt;&lt;replace &quot;#choixhibou1&quot;&gt;&gt;
&lt;&lt;link &quot;Battre des bras dans les airs en lui criant dessus&quot;&gt;&gt;
&lt;&lt;replace &quot;#choixhibou1&quot;&gt;&gt;
	Prenant votre courage à deux mains, vous vous mettez à gesticuler avec force en criant sur le hibou.
-Du balai oiseau de malheur ! Tu ne vois donc pas que l&#39;heure est grave ?! Et puis qu&#39;est-ce que c&#39;est que ces façons ? On ne rentre pas comme ça, non invité, chez les gens ! Allez ouste !
	Le hibou n&#39;est visiblement pas ravi par vos cris et il semble froncer les sourcils en penchant sa tête latéralement. Vous ne relâchez pas la pression pour autant, et intensifiez même vos injures, qui deviennent trop indécentes pour être retranscrites. Finalement, l&#39;oiseau craque avant vous (vous êtes très têtu) et après s&#39;être ébroué les ailes d&#39;un air menaçant, il s&#39;élance...
	...Droit sur vous ! Vous n&#39;avez que le temps d&#39;esquisser une esquive, qui expose cependant votre livre aux serres redoutables du hibou qui s&#39;en empare et, après vous avoir lancé un dernier regard noir, le lâche dans la potion et s&#39;en va par là où il était venu. Juste avant que l&#39;ouvrage ne soit englouti par les eaux sombres de la décoction, vous avez le temps d&#39;enfin lire le titre de l&#39;ouvrage: &quot;L&#39;illusion du choix, tome 2&quot;.
	Tandis que vous redoublez d&#39;inventivité dans vos injures, boosté par ce nouvel affront, le chaudron quant à lui s&#39;est mis à trembler de plus belle, comme de rage, sous l&#39;effet du bouillonnement encore renforcé par l&#39;intrusion du livre dans la potion. Vous reconcentrant sur le danger le plus immédiat, vous sentez que les choses sont en train de vous échapper. Il faut vite que vous vous débrouilliez pour stabiliser la potion avant que tout ne dégénère davantage...
	
	[[Il est temps de faire preuve d&#39;un peu de connaissances alchimiques.-&gt;1er_ingrédient]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;

&lt;&lt;link &quot;Secouer la bibliothèque pour l&#39;en déloger&quot;&gt;&gt;
&lt;&lt;replace &quot;#choixhibou1&quot;&gt;&gt;
	Agacé par cet intrus à plumes, vous vous rapprochez de la bibliothèque et, plantant votre regard le plus noir dans celui, dédaigneux, du rapace, vous vous employez à secouer votre meuble avec énergie. Le hibou fronce les sourcils (enfin, c&#39;est ce qu&#39;il vous semble), et plante d&#39;autant plus fermement ses serres dans le bois de son support. Par on ne sait quelle magie (vous ne vous rappelez pas en avoir fait usage), aucun livre ne tombe, malgré vos efforts énergiques.
	Les minutes passent difficilement tandis que vous ahanez, haletez, grognez, rugissez, et que la sueur coule sur votre visage. Finalement, vous vous révélez plus têtu que l&#39;oiseau et il renonce à rester en place, manifestement agacé par ce jeu de rodéo. Après s&#39;être ébroué les ailes d&#39;un air menaçant, il s&#39;élance...
	...Droit sur vous ! Vous n&#39;avez que le temps d&#39;esquisser une esquive, qui expose cependant votre livre aux serres redoutables du hibou qui s&#39;en empare et, après vous avoir lancé un dernier regard noir, le lâche dans la potion et s&#39;en va par là où il était venu. Juste avant que l&#39;ouvrage ne soit englouti par les eaux sombres de la décoction, vous avez le temps d&#39;enfin lire le titre de l&#39;ouvrage: &quot;L&#39;illusion du choix, tome 2&quot;.
	Tandis que vous redoublez d&#39;inventivité dans vos injures, boosté par ce nouvel affront, le chaudron quant à lui s&#39;est mis à trembler de plus belle, comme de rage, sous l&#39;effet du bouillonnement encore renforcé par l&#39;intrusion du livre dans la potion. Vous reconcentrant sur le danger le plus immédiat, vous sentez que les choses sont en train de vous échapper. Il faut vite que vous vous débrouilliez pour stabiliser la potion avant que tout ne dégénère davantage...
	
	[[Il est temps de faire preuve d&#39;un peu de connaissances alchimiques.-&gt;1er_ingrédient]]
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;/span&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;

&lt;&lt;link &quot;Prendre le livre jaune&quot;&gt;&gt;
&lt;&lt;replace &quot;#livre&quot;&gt;&gt;
	Vous essayez d&#39;extraire le livre à la couverture jaune de son étagère, mais il semble qu&#39;une substance collante se soit déversée sur lui à un moment donné, et il refuse désormais de bouger. Y voyant un signe du destin vous assurant que c&#39;est exactement l&#39;ouvrage qu&#39;il vous faut, vous vous mettez à tirer plus &lt;span id=&quot;jaune1&quot;&gt;&lt;&lt;link &quot;fort...&quot;&gt;&gt;&lt;/span&gt;&lt;&lt;replace &quot;#jaune1&quot;&gt;&gt;fort...&lt;&lt;/replace&gt;&gt;
	&lt;&lt;append &quot;#livre&quot;&gt;&gt;
	...Et encore plus fort, jusqu&#39;à ce que votre visage devienne tout rouge sous l&#39;effort et que vous deviez finalement prendre appui sur la bibliothèque avec vos jambes, essayant de faire levier sur le livre qui résiste encore et toujours. Et puis &lt;span id=&quot;jaune2&quot;&gt;&lt;&lt;link &quot;soudain...&quot;&gt;&gt;&lt;/span&gt;&lt;&lt;replace &quot;#jaune2&quot;&gt;&gt;soudain...&lt;&lt;/replace&gt;&gt;
	&lt;&lt;append &quot;#livre&quot;&gt;&gt;
	... Le livre renonce à persister dans son état inamovible et, dans un terrible bruit de ventouse et de feuilles froissées, cède d&#39;un seul coup. Ne vous y attendant pas du tout, vous le laissez échapper en vous effondrant par terre, et le livre exécute un fantastique vol plané en cloche, atterrissant avec grâce en plein dans le chaudron, et ne vous laissant que le temps d&#39;apercevoir son titre: &quot;L&#39;illusion du choix, tome 3&quot;.
	Le chaudron se met à trembler de plus belle, comme de rage, sous l&#39;effet du bouillonnement encore renforcé par l&#39;intrusion du livre dans la potion. Reprenant peu à peu vos esprits et après vous être remis sur vos pieds, vous réalisez que les choses sont en train de vous échapper. Il faut vite que vous mettiez cette mésaventure derrière vous et que vous vous débrouilliez pour stabiliser la potion avant que tout ne dégénère davantage...
	
	[[Il est temps de faire preuve d&#39;un peu de connaissances alchimiques.-&gt;1er_ingrédient]]
	&lt;&lt;/append&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;/append&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;

&lt;/span&gt;</tw-passagedata>
<tw-passagedata pid="21" name="placard" tags="" position="182,1384">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $gateau to true&gt;&gt;
&lt;div id=&quot;chaudron_container&quot;&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 2&quot; data-zi=&quot;2&quot; src=&quot;media/pictures/illustrations/chaudron1.png&quot; alt=&quot;chaudron ok&quot; title=&quot;Tout va bien... pour le moment&quot;/&gt;
&lt;img class=&quot;chaudron&quot; style=&quot;z-index: 1&quot; data-zi=&quot;1&quot; src=&quot;media/pictures/illustrations/chaudron2.png&quot; alt=&quot;chaudron ok&quot; title=&quot;Ça commencer à chauffer...&quot;/&gt;
&lt;/div&gt;
&lt;&lt;/nobr&gt;&gt;
	N&#39;écoutant que l&#39;appel de votre ventre, vous partez chercher quelque chose à grignoter dans le garde-manger. Hélas, votre déception est grande lorsque vous n&#39;y découvrez qu&#39;un triste désert alimentaire, à l&#39;exception de ce qui semble être un muffin. Vous pestez à votre encontre, vous auriez dû penser à aller refaire vos provisions chez &quot;Les fins gourmets de la forêt&quot;. Avec un soupir d&#39;irritation vous vous emparez malgré tout du muffin et vous dirigez vers le chaudron.
	En vous penchant au-dessus de ce dernier vous vous rendez finalement compte que son bouillonnement est plus fort qu&#39;il ne devrait l&#39;être, ce qui, associé à l&#39;odeur étonnament désagréable qui s&#39;en échappe et la couleur verdâtre de la potion, vous fait froncer les sourcils. Serait-il possible que vous ayez fait une erreur dans votre préparation de la veille ? Soucieux, vous portez votre muffin à vos lèvres. Mais alors que vous mordez dedans, un horrible goût de moisissure vous donne un haut-le-coeur.
	Dans un geste rageur vous jetez violemment le gâteau par terre.
	&lt;span id=&quot;rebonds&quot;&gt;
		&lt;&lt;link &quot;Mais...&quot;&gt;&gt;
			&lt;&lt;replace &quot;#rebonds&quot;&gt;&gt;
				Il semble cependant que la dégradation du muffin l&#39;a rendu particulièrement caoutchouteux et le voilà qui rebondit contre le plancher, &lt;span id=&quot;r1&quot;&gt;&lt;&lt;link &quot;propulsé à toute vitesse vers votre bibliothèque...&quot;&gt;&gt;&lt;/span&gt;&lt;&lt;replace &quot;#r1&quot;&gt;&gt;propulsé à toute vitesse vers votre bibliothèque...&lt;&lt;/replace&gt;&gt;

					&lt;&lt;append &quot;#rebonds&quot;&gt;&gt;
					...Laquelle est dangereusement ébranlée par le choc avec le muffin, et vous avez l&#39;espace d&#39;un instant une vision d&#39;horreur de la lourde bibliothèque s&#39;effondrant sur le sol. Elle finit toutefois par se stabiliser tandis que le muffin, fort d&#39;un nouveau rebond, part plus vite encore à travers la pièce. Atterré par la propension tout à fait magique de ce muffin à défier les lois de la nature en gagnant en énergie cinétique à chaque heurt, &lt;span id=&quot;r2&quot;&gt;&lt;&lt;link &quot;vous assistez impuissant au parcours rebondissant du muffin...&quot;&gt;&gt;&lt;/span&gt;&lt;&lt;replace &quot;#r2&quot;&gt;&gt;vous assistez impuissant au parcours rebondissant du muffin...&lt;&lt;/replace&gt;&gt;

						&lt;&lt;append &quot;#rebonds&quot;&gt;&gt;
						&lt;&lt;audio &quot;boiling&quot; volume 0.25 fadeto 0.5&gt;&gt;
						&lt;&lt;script&gt;&gt;
						$(&#39;img.chaudron[data-zi=2]&#39;).animate({opacity: 0}, 1000);
						&lt;&lt;/script&gt;&gt;
							... Qui va à toute vitesse d&#39;une poutre au plancher, puis du plancher à la poignée de votre porte d&#39;entrée, puis de la poignée à un des pieds de votre table qui émet un craquement inquiétant, etc. Vous vous abritez quant à vous sous votre chapeau de magicien, terrifié à l&#39;idée d&#39;être touché par le projectile. Mais par chance (ou peut-être par terrible malchance ? Seul l&#39;avenir le dira...) le muffin termine finalement sa folle envolée par un magistral &quot;PLOUF!&quot; dans le chaudron.
							Alors que vous commencez à pousser un soupir de soulagement, la marmite, elle, ne semble pas avoir apprécié l&#39;offrande périmée et se met à trembler de manière menaçante sur son support, les bouillonnements se faisant de plus en plus fort.
							Vous voilà donc confronté le ventre vide à la nécessité de stabiliser la potion avant que les choses ne dégénèrent encore davantage...

							[[Il est temps de faire preuve d&#39;un peu de connaissances alchimiques.-&gt;1er_ingrédient]]
						&lt;&lt;/append&gt;&gt;
					&lt;&lt;/link&gt;&gt;
					&lt;&lt;/append&gt;&gt;
				&lt;&lt;/link&gt;&gt;
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;</tw-passagedata>
<tw-passagedata pid="22" name="os" tags="" position="935,1391">&lt;&lt;silently&gt;&gt;
&lt;!-- fera apparaître des fantômes d&#39;animaux dans la clairière--&gt;
&lt;&lt;set $os to true&gt;&gt;
&lt;&lt;audio &quot;:playing&quot; stop&gt;&gt;
&lt;&lt;audio &quot;2ndtimer_2&quot; volume 0.7 loop play&gt;&gt;
&lt;&lt;audio &quot;snoring&quot; loop volume 0.25 fadeto 0.5&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Prenant les os sur la table, obtenus par vos différents repas, du lapin à la moutarde, du faisant farci, et d&#39;autres mets appétissants. C&#39;est alors que vous vous remémorez les cours de votre enfance, où votre professeur vous avait fait recopier 100 fois les propriétés épaississante et anti-acidifiante des os. Secouant la tête par dépit, vous ajoutez cet ingrédient à la potion. La potion semblant se calmer et fatigué par les événements, vous décidez de vous allongez sur votre lit quelques instants, le temps de récupérer un peu.
Et c&#39;est lentement que vos yeux se ferment, et que vous retournez vous nicher dans les bras de Morphée...
[[Poursuivre l&#39;histoire-&gt;Phase2]] </tw-passagedata>
<tw-passagedata pid="23" name="corne" tags="" position="933,1540">&lt;&lt;silently&gt;&gt;
&lt;!-- fera intervenir un rhinocéros dans le procès--&gt;
&lt;&lt;set $corne to true&gt;&gt;
&lt;&lt;audio &quot;:playing&quot; stop&gt;&gt;
&lt;&lt;audio &quot;2ndtimer_2&quot; volume 0.7 loop play&gt;&gt;
&lt;&lt;set $sort_lance to false&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
À contre-coeur, vous ajoutez la corne de licorne, qui vous avait coûté un bras une dizaine d&#39;années auparavant auprès d&#39;un marchant ambulant garantissant des propriétés exceptionnelles. Alors qu&#39;elle tombe dans le liquide bouillonant, vous attendant à ce que la magie de la corne stabilise complètement la mixture, une réaction inattendue se produit.

&lt;span id=&quot;sortillege&quot;&gt;\
&lt;&lt;linkreplace &quot;Lancer un sortillège de protection&quot;&gt;&gt;\
&lt;&lt;set $sort_lance to true&gt;&gt;\
&lt;img class=&quot;illustration&quot; alt=&quot;chaudron qui explose&quot;
	src=&quot;media/pictures/illustrations/chaudron4.png&quot;/&gt;
	Sentant le danger arriver, vous lancez un sort de protection autour du chaudron. Une fraction de seconde après, vous pouvez le voir \
  &lt;&lt;linkappend &quot;exploser...&quot;&gt;&gt;\
  &lt;&lt;silently&gt;&gt;
  &lt;&lt;audio &quot;:playing&quot; fadeoverto 1 0&gt;&gt;
  &lt;&lt;audio &quot;explosion&quot; play&gt;&gt;
  &lt;&lt;script&gt;&gt;
  $(&quot;.black_overlay&quot;)
  .css(&#39;visibility&#39;, &#39;visible&#39;).hide().fadeIn(1000);
  &lt;&lt;/script&gt;&gt;
  &lt;&lt;timed 5s&gt;&gt;
  	&lt;&lt;goto &quot;Phase2&quot;&gt;&gt;
  &lt;&lt;/timed&gt;&gt;
  &lt;&lt;/silently&gt;&gt;
  &lt;&lt;/linkappend&gt;&gt;
&lt;&lt;/linkreplace&gt;&gt;
&lt;/span&gt;
&lt;div class=&quot;black_overlay&quot; style=&quot;visibility: hidden&quot;&gt;&lt;/div&gt;

&lt;!-- timer écoulé --&gt;
&lt;&lt;timed 12s&gt;&gt;
&lt;&lt;if $sort_lance eq false&gt;&gt;
&lt;&lt;replace &quot;#sortillege&quot;&gt;&gt;
&lt;&lt;set $cabaneexplose to true&gt;&gt;
&lt;img class=&quot;illustration&quot; alt=&quot;chaudron qui explose&quot;
	src=&quot;media/pictures/illustrations/chaudron4.png&quot;/&gt;
	N&#39;ayant pas eu le réflexe de lancer un sort de protection, vous voyez le chaudron \
&lt;&lt;linkappend &quot;exploser...&quot;&gt;&gt;\
&lt;&lt;silently&gt;&gt;
&lt;&lt;audio &quot;:playing&quot; fadeoverto 1 0&gt;&gt;
&lt;&lt;audio &quot;explosion&quot; play&gt;&gt;
&lt;div class=&quot;black_overlay&quot; style=&quot;opacity: 0&quot;&gt;&lt;/div&gt;
  &lt;&lt;script&gt;&gt;
  $(&quot;.black_overlay&quot;)
  .css(&#39;visibility&#39;, &#39;visible&#39;).hide().fadeIn(1000);
  &lt;&lt;/script&gt;&gt;
  &lt;&lt;timed 5s&gt;&gt;
  	&lt;&lt;goto &quot;Phase2&quot;&gt;&gt;
  &lt;&lt;/timed&gt;&gt;
  &lt;&lt;/silently&gt;&gt;
&lt;&lt;/linkappend&gt;&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/timed&gt;&gt;</tw-passagedata>
<tw-passagedata pid="24" name="StoryInit" tags="" position="9,996">&lt;!--ingrédients--&gt;

&lt;!--apparition annimaux savants dans la clairière--&gt;
&lt;&lt;set $livre to false&gt;&gt;

&lt;!--transformation dragon en mouton--&gt;
&lt;&lt;set $gateau to false&gt;&gt;

&lt;!--la rivière devient gelée--&gt;
&lt;&lt;set $glace to false&gt;&gt;

&lt;!--brûle le bâton s&#39;il est plongé dans la rivière--&gt;
&lt;&lt;set $poussièredefeu to false&gt;&gt;

&lt;!--agit sur le groupe de scout--&gt;
&lt;&lt;set $champignon to false&gt;&gt;

&lt;!--apparition d&#39;un rhinocéros dans le &quot;procès&quot;--&gt;
&lt;&lt;set $corne to false&gt;&gt;

&lt;!--fait tousser les nains de jardins--&gt;
&lt;&lt;set $tabac to false&gt;&gt;

&lt;!--augmente le risque de chute dans le raccourci--&gt;
&lt;&lt;set $bave to false&gt;&gt;

&lt;!--fait gratter les nains de jardin--&gt;
&lt;&lt;set $orties to false&gt;&gt;

&lt;!--apparition de fantômes d&#39;animaux dans la clairière--&gt;
&lt;&lt;set $os to false&gt;&gt;


&lt;!--objets--&gt;

&lt;!--pièce d&#39;or possiblement détecter avant l&#39;antre du dragon--&gt;
&lt;&lt;set $pieceor to false&gt;&gt;

&lt;!--découverte d&#39;une bague dans la clairière (sans animaux ni fantômes)--&gt;
&lt;&lt;set $tresor to false&gt;&gt;

&lt;!--peuvent être perdus (rivière gelée/fuite) ou humides (rivière)--&gt;
&lt;&lt;set $allumette to true&gt;&gt;

&lt;!--peut être perdue (rivière gelée/fuite) ou humide (rivière)--&gt;
&lt;&lt;set $lampe to true&gt;&gt;

&lt;!--peut être brûlé/perdu mais refait avec le couteau--&gt;
&lt;&lt;set $baton to true&gt;&gt;

&lt;!--peut être perdu--&gt;
&lt;&lt;set $couteau to true&gt;&gt;


&lt;!--États--&gt;

&lt;!--métamorphose ancienne du dragon par le sorcier--&gt;
&lt;&lt;set $dragon to &quot;moto&quot;&gt;&gt;
&lt;!--le scout perdu a été rencontré?--&gt;
&lt;&lt;set $scoutperduvu to false&gt;&gt;
&lt;&lt;set $livrescout to false&gt;&gt;

&lt;!--vous avez aidé le groupe de scout?--&gt;
&lt;&lt;set $scoutaide to false&gt;&gt;
&lt;&lt;set $aidernains to false&gt;&gt;
&lt;&lt;set $cabaneexplose to false&gt;&gt;


&lt;!--Succès--&gt;
&lt;&lt;set $bad_end to false&gt;&gt;
&lt;&lt;set $bad_ends to []&gt;&gt;
&lt;&lt;set $succes to []&gt;&gt;
&lt;&lt;set $succes_map to [
	{
		id: &quot;mouille&quot;,
		name: &quot;Mouillé&quot;,
		desc: &quot;être resté dans la glace plutôt que de chercher à survivre&quot;,
		img: false
	},
	{
		id: &quot;baratineur&quot;,
		name: &quot;Baratineur&quot;,
		desc: &quot;avoir voulu clouer le bec au lapin plutôt que de poursuivre votre route&quot;,
		img: false
	},
	{
		id: &quot;speleologue&quot;,
		name: &quot;Spéléologue&quot;,
		desc: &quot;avoir surestimé votre chance face au raccourci escarpé&quot;,
		img: false
	},
	{
		id: &quot;jambon&quot;,
		name: &quot;Jambon&quot;,
		desc: &quot;avoir sous-estimé les réflexes du vieux dragon&quot;,
		img: false
	},
	{
		id: &quot;dream&quot;,
		name: &quot;Rêveur&quot;,
		desc: &quot;avoir une imagination (trop ?) débordante&quot;,
		img: false
	},
	{
		id: &quot;default&quot;,
		name: &quot;SuperStar&quot;,
		desc: &quot;avoir réussi à rencontrer Zek sans encombre (ou presque)&quot;,
		img: false
	}
]
&gt;&gt;


&lt;!--Bruitages--&gt;

&lt;&lt;cacheaudio &quot;snoring&quot; &quot;media/audio/snoring.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;boiling&quot; &quot;media/audio/boiling.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;thunder&quot; &quot;media/audio/thunder.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;explosion&quot; &quot;media/audio/explosion.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;underwater&quot; &quot;media/audio/underwater.mp3&quot;&gt;&gt;

&lt;!--Musiques--&gt;

&lt;&lt;cacheaudio &quot;awaking&quot; &quot;media/audio/awaking.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;1sttimer&quot; &quot;media/audio/timer1.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;2ndtimer_1&quot; &quot;media/audio/timer2_1.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;2ndtimer_2&quot; &quot;media/audio/timer2_2.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;part2&quot; &quot;media/audio/part2.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;transition&quot; &quot;media/audio/transition.mp3&quot;&gt;&gt;
&lt;&lt;waitforaudio&gt;&gt;

&lt;!-- Pour un débug facile --&gt;
&lt;&lt;script&gt;&gt;
var $button = $(&quot;&lt;button style=&#39;position: absolute; bottom: 0; right: 0;&#39;&gt;UI&lt;/button&gt;&quot;);
$button.click(function() {
	if ($(&quot;#ui-bar:visible&quot;).length === 0)
		$(&quot;#ui-bar&quot;).show();
	else
		$(&quot;#ui-bar&quot;).hide();
})
$(&#39;body&#39;).append($button);
&lt;&lt;/script&gt;&gt;

[[lancer-&gt;menu]]</tw-passagedata>
<tw-passagedata pid="25" name="Phase2" tags="" position="1185,1262">&lt;div class=&quot;white_overlay&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;black_overlay&quot;&gt;&lt;/div&gt;
&lt;&lt;silently&gt;&gt;
&lt;&lt;audio &quot;:playing&quot; stop&gt;&gt;
&lt;&lt;audio &quot;transition&quot; play&gt;&gt;
&lt;&lt;script&gt;&gt;
setTimeout(function() {
	$(&#39;.white_overlay&#39;)
	.fadeOut(50).fadeIn(50).fadeOut(50).fadeIn(100)
	.delay(1500)
	.fadeOut(50).fadeIn(50).fadeOut(50).fadeIn(100)
	.delay(2000)
	.fadeOut(80).fadeIn(250).fadeOut(400);
}, 4000);
&lt;&lt;/script&gt;&gt;
&lt;&lt;/silently&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;span style=&quot;position: relative; z-index:10; color: white&quot; id=&quot;phase2-intro&quot;&gt;
Dans ==une galaxie== euh non, espace-temps &lt;&lt;linkappend &quot;pas si lointain...&quot;&gt;&gt;
&lt;&lt;audio &quot;part2&quot; loop play volume 0.6&gt;&gt;
&lt;&lt;script&gt;&gt;
$(&#39;.black_overlay&#39;).animate({opacity: 0}, 1000, &quot;swing&quot;, function() {
	$(&#39;#phase2-intro&#39;).css({color: &quot;black&quot;});
	$(this).remove();
	$(&#39;#phase2-text&#39;).fadeIn(1000);
});
&lt;&lt;/script&gt;&gt;
&lt;&lt;/linkappend&gt;&gt;
&lt;/span&gt;
&lt;&lt;/nobr&gt;&gt;\

&lt;span style=&quot;display: none&quot; id=&quot;phase2-text&quot;&gt;
Après avoir passé de nombreuses années à étudier les différentes facettes du droit, le diplôme en poche, Jean Charles de la Haute a décidé de visiter du pays. Il se retrouve ainsi à vaguer de ville en village et de village en ville, et à discuter avec diverses personnes, intellectuelles ou non, afin d&#39;argumenter sur tout sujet.

Il y a quelques semaines, durant vos habituelles argumentations vous avez eu vent d&#39;un sorcier. De par son comportement inconscient et des accidents qui ont découlés de ses expériences, il a été exilé par les habitants. Intéressé par l&#39;optique de parler avec une personne aussi inhabituelle, vous demandez le chemin de sa nouvelle demeure aux habitants, qui vous répondent tout en essayant de vous résonner.

Et c&#39;est ainsi que vous vous mettez en route, le sac sur le dos et le bâton à la main, afin de rencontrer ce mystérieux personnage à la réputation d&#39;enfant compulsif.

[[Suite-&gt;Rivière]]
&lt;/span&gt;</tw-passagedata>
<tw-passagedata pid="26" name="jardincabane" tags="" position="3583,1266">&lt;&lt;if $cabaneexplose eq true&gt;&gt;\
&lt;img class=&quot;illustration&quot; alt=&quot;cabane explosée&quot; src=&quot;media/pictures/illustrations/cabane_explosee.png&quot;/&gt;
&lt;&lt;else&gt;&gt;\
&lt;img class=&quot;illustration&quot; alt=&quot;cabane&quot; src=&quot;media/pictures/illustrations/cabane.png&quot;/&gt;
&lt;&lt;/if&gt;&gt;\
Votre périple arrivant à son terme, vous débouchez sur une prairie, où il fait bon vivre…
Soudains vous entendez des paroles alors qu’il n’y a personne à votre vue, mis à part des nains de jardins... À votre grande surprise, les paroles viennent d’eux…

&lt;img class=&quot;illustration&quot; alt=&quot;nains&quot; src=&quot;media/pictures/illustrations/nains.png&quot;/&gt;
&lt;&lt;if $orties eq true&gt;&gt;
-Oh ras le bol de ses expériences … qu’est-ce que ça gratte…
- Ça me fait penser à la fois où il nous a balancé du poil à gratter...
- Et moi le jour où je suis tombé dans les orties par sa faute...
- Ouais déjà qu’on était tranquille avant, il a fallu qu’il nous anime et qu’il nous jette un sort…
- C’en est trop, on va le chercher les gars
-Et c’est qui lui ?
Vous remarquant alors, les nains vous dévisage intensément avant d’enchaîner…
-Ça doit être le jeune diplômé dont a fait référence le maître lorsqu’il a regardé le miroir
-Oh mais ça tombe bien s’il y a quelqu’un qui fait du droit avec nous, pour nos revendications…
&lt;&lt;else&gt;&gt;
-Eh vous !!! Oui vous le grand nigaud, que fichez-vous là, vous ne savez pas qu’il s’agit d’une propriété privé ? … Oh excusez-moi vous devez être le jeune diplômé qui souhaite rencontrer le maître ? Non ne vous inquiétez pas on a entendu parlez le maître de vous, car il sait tout…
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $cabaneexplose eq true&gt;&gt;
Une pierre tombant d’un mur en ruine stoppe la conversation…
-Oh ne vous inquiétez pas c’est tout récent, à force d’expérimenter des trucs, ça a fait sauter sa maison mais il va bien, il s’en sort toujours …&lt;&lt;/if&gt;&gt;\
-Dites-nous, pourriez-vous nous représenter car on souhaite soumettre nos revendications à notre maître qui ne cesse avec ses expériences déplaisantes…
&lt;span id=&quot;reponse&quot;&gt;
	&lt;&lt;link &quot;Accepter de soutenir les nains&quot;&gt;&gt;
		&lt;&lt;replace &quot;#reponse&quot;&gt;&gt;
&lt;&lt;set $aidernains to true&gt;&gt;
-	Ah merci c’est sympa
-	Enfin on va pouvoir faire quelque chose…
&lt;&lt;if $cabaneexplose eq true&gt;&gt;
Accompagné des nains, vous longez les restes d’une maison en ruine pour vous diriger vers une silhouette assise sur une pierre…
[[Suite-&gt;cabaneexplose]]
&lt;&lt;else&gt;&gt;
Accompagné des nains, vous vous dirigez devant la porte de la cabane…
[[Toquer à la porte-&gt;cabane]]
&lt;&lt;/if&gt;&gt;
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;link &quot;Décliner&quot;&gt;&gt;
&lt;&lt;replace &quot;#reponse&quot;&gt;&gt;
-	Ok d’acc tant pis, j’espère que vous porterez votre choix longtemps sur la conscience…
-	Ah ça quand il faut aider il n’y a personne !!!
-	Tous des égoïstes…
-	Allez les gars, on se débrouillera, comme toujours…

&lt;&lt;if $cabaneexplose eq true&gt;&gt;
Les nains s’éloignant, vous longez les restes d’une maison en ruine pour vous diriger vers une silhouette assise sur une pierre…
[[Suite-&gt;cabaneexplose]]
&lt;&lt;else&gt;&gt;
Les nains s’éloignant, vous vous dirigez devant la porte de la cabane…
[[Toquer à la porte-&gt;cabane]]
&lt;&lt;/if&gt;&gt;
		&lt;&lt;/replace&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;/span&gt;
</tw-passagedata>
<tw-passagedata pid="27" name="retourdiscret" tags="" position="2074,1446">N&#39;écoutant que votre courage &lt;&lt;if $os eq true&gt;&gt;mais craignant la rencontre d’un squelette, votre plus grande phobie,  &lt;&lt;/if&gt;&gt;vous revenez sur vos pas, sans que les étranges créatures ne s&#39;en rendent compte.
[[Continuer-&gt;Groupe de scout]]
</tw-passagedata>
<tw-passagedata pid="28" name="retourfuite" tags="" position="2070,1595">Perdant tout courage &lt;&lt;if $os eq true&gt;&gt;avec la crainte de rencontrer un squelette, votre plus grande phobie,  &lt;&lt;/if&gt;&gt;vous prenez vos jambes à votre cou et vous partez sans vous retourner. Une fois à bonne distance, vous reprenez votre souffle ...
&lt;&lt;set $variable to random(1,10)&gt;&gt;
&lt;&lt;if $variable &gt;5&gt;&gt;
&lt;&lt;set $lampe to false&gt;&gt;
Vous vous rendez-compte que lors de votre fuite, votre lampe-torche a pris la poudre d&#39;escampette…
[[Suite-&gt;Groupe de scout]]
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $variable &gt;3&gt;&gt;
&lt;&lt;set $couteau to false&gt;&gt;
Fouillant vos poches, vous constatez la perte de votre couteau. C’est donc avec une certaine tristesse, due à la perte de cet objet hérité de votre grand-père, que vous reprenez la route…
[[Suite-&gt;Groupe de scout]]
	&lt;&lt;else&gt;&gt;
&lt;&lt;set $allumette to false&gt;&gt;
&lt;&lt;set $lampe to false&gt;&gt;
Retournant sur la route, vous vous sentez léger… trop léger… et en effet, durant votre fuite, votre sac s’était accroché à une branche. Vous voilà donc avec uniquement un couteau et votre bâton pour continuer le périple…
[[Suite-&gt;Groupe de scout]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
</tw-passagedata>
<tw-passagedata pid="29" name="Passer au travers de la glace" tags="" position="1479,1017">&lt;&lt;silently&gt;&gt;
&lt;&lt;set $nb_click to 0&gt;&gt;
&lt;&lt;script&gt;&gt;
$(&quot;#passages&quot;).css({
  &#39;filter&#39;: &#39;saturate(0%)&#39;,
  &#39;webkitFilter&#39;: &#39;saturate(0%)&#39;,
  &#39;mozFilter&#39;: &#39;saturate(0%)&#39;,
  &#39;oFilter&#39;: &#39;saturate(0%)&#39;,
  &#39;msFilter&#39;: &#39;saturate(0%)&#39;,
  &#39;transition&#39;: &#39;all .1s ease-out&#39;,
  &#39;-webkit-transition&#39;: &#39;all .1s ease-out&#39;,
  &#39;-moz-transition&#39;: &#39;all .1s ease-out&#39;,
  &#39;-o-transition&#39;: &#39;all .1s ease-out&#39;
});
&lt;&lt;/script&gt;&gt;
&lt;&lt;audio &quot;part2&quot; fadeoverto 1 0.15&gt;&gt;
&lt;&lt;audio &quot;underwater&quot; play volume 0.5 loop&gt;&gt;
&lt;&lt;/silently&gt;&gt;
&lt;&lt;nobr&gt;&gt;\
Alors que vous traversez cette rivière gelée, vous entendez des fissures se propager à chacun de vos pas. Alors que vous regrettez d&#39;avoir gardé autant de poids sur vous, la glace se brise sous vos pieds, vous retrouvant alors dans une eau gelée dont vous devez vite
&lt;&lt;linkappend &quot;vous extirper avant de mourir gelé...&quot;&gt;&gt;
	&lt;&lt;append &quot;#riviere_lutte&quot;&gt;&gt;
		&lt;&lt;link &quot;Luttez !!!&quot;&gt;&gt;
			&lt;&lt;set $nb_click to $nb_click + 1&gt;&gt;
			&lt;&lt;script&gt;&gt;
			var nb_click = state.active.variables.nb_click;
			$(&quot;#passages&quot;).css({
			&#39;filter&#39;: &#39;saturate(&#39;+nb_click*20+&#39;%)&#39;,
			&#39;webkitFilter&#39;: &#39;saturate(&#39;+nb_click*20+&#39;%)&#39;,
			&#39;mozFilter&#39;: &#39;saturate(&#39;+nb_click*20+&#39;%)&#39;,
			&#39;oFilter&#39;: &#39;saturate(&#39;+nb_click*20+&#39;%)&#39;,
			&#39;msFilter&#39;: &#39;saturate(&#39;+nb_click*20+&#39;%)&#39;
			});
			&lt;&lt;/script&gt;&gt;
			&lt;&lt;if $nb_click &gt;= 5&gt;&gt;
	&lt;&lt;append &quot;#riviere_result&quot;&gt;&gt;
	&lt;&lt;audio &quot;underwater&quot; fadeoverto 1 0&gt;&gt;
	&lt;&lt;audio &quot;part2&quot; fadeoverto 3 0.6&gt;&gt;
	Frigorifié, vous atteignez enfin l&#39;autre rive. Pour vous réchauffer, vous sortez la couverture de votre sac et vos vêtements séchant au soleil, vous vous demandez encore par quelle magie cette rivière peut être gelée.
	Vos vêtements secs, et réchauffé, vous pouvez reprendre votre périple...
	[[Reprendre la route-&gt;bruit]]
	&lt;&lt;/append&gt;&gt;
	&lt;&lt;remove &quot;#riviere_lutte&quot;&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/link&gt;&gt;
	&lt;&lt;/append&gt;&gt;
	&lt;&lt;timed 4s t8n&gt;&gt;
	&lt;&lt;if $nb_click &lt; 5&gt;&gt;
	&lt;&lt;remove &quot;#riviere_lutte&quot;&gt;&gt;
	&lt;&lt;append &quot;#riviere_result&quot;&gt;&gt;
	&lt;&lt;audio &quot;underwater&quot; fadeoverto 1 0&gt;&gt;
	Lentement, vous sentez vos membres s&#39;engourdir jusqu&#39;au point de ne plus pouvoir bouger. Petit à petit, vos yeux se ferment et vous partez à la dérive dans
	&lt;&lt;link [[un sommeil sans fin.-&gt;fin]]&gt;&gt;
		&lt;&lt;set $bad_end to &quot;riviere&quot;&gt;&gt;
		&lt;&lt;script&gt;&gt;
			$(&quot;#passages&quot;).css({
			&#39;filter&#39;: &#39;saturate(100%)&#39;,
			&#39;webkitFilter&#39;: &#39;saturate(100%)&#39;,
			&#39;mozFilter&#39;: &#39;saturate(100%)&#39;,
			&#39;oFilter&#39;: &#39;saturate(100%)&#39;,
			&#39;msFilter&#39;: &#39;saturate(100%)&#39;
			});
		&lt;&lt;/script&gt;&gt;
	&lt;&lt;/link&gt;&gt;
	&lt;&lt;/append&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;/timed&gt;&gt;
&lt;&lt;/linkappend&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;span id=&quot;riviere_lutte&quot;&gt;&lt;/span&gt;
&lt;span id=&quot;riviere_result&quot;&gt;&lt;/span&gt;</tw-passagedata>
<tw-passagedata pid="30" name="scoutperdu" tags="" position="30,833">&lt;img class=&quot;illustration&quot; alt=&quot;scout perdu&quot; src=&quot;media/pictures/illustrations/scout.png&quot;/&gt;
&lt;!-- Lieux d&#39;apparition possibles du scout :
- avant la rivière
- après l&#39;avoir franchie
- la clairière si pas d&#39;animaux ou fantômes (là où se situe la chevalière niveau secret, donc diminuerait encore plus la proba...)
- l&#39;embranchement
- après le raccourci
- avant la cabane du sorcier (de manière générale)
carte du chaudron retrouvée par le promeneur et utilisée dans le procès--&gt;
&lt;&lt;set $scoutperduvu to true&gt;&gt;
&lt;&lt;set $variable to random(1,2)&gt;&gt;
Alors que vous marchez, vous apercevez un scout en train de lire un bouquin. Dans son monde, il porte un écriteau autour de son cou indiquant qu’il est perdu (heureusement que ses compagnons sont prévoyants). 
&lt;span id=&quot;interagir&quot;&gt;
	&lt;&lt;link &quot;Arracher le scout à sa lecture&quot;&gt;&gt;
		&lt;&lt;replace &quot;#interagir&quot;&gt;&gt;
En vous rapprochant, il lève enfin son nez de son livre et vous interpelle…
-	Bonjour mon cher, alors on se promène ? J’étais en train de lire une bonne réflexion portée sur le droit et les devoirs du citoyen… Enfin je parle de ça a vous mais je suppose que vous n’y connaissez rien. 
&lt;&lt;if $variable is 1&gt;&gt;
Par exemple, pouvez-vous me dire qui faut-il contacter en premier pour récupérer un appartement dont le locataire n&#39;occupe pas les lieux et ne paie plus son loyer depuis plus de 12 mois ?
Répondre :
	&lt;span id=&quot;repondre1&quot;&gt;&lt;!—################Question 1######--&gt;
		&lt;&lt;link &quot;Un huissier&quot;&gt;&gt; &lt;!—#######Bonne réponse######--&gt;
			&lt;&lt;replace &quot;#repondre1&quot;&gt;&gt;
&lt;&lt;set $livrescout to true&gt;
-	Effectivement, vous avez vu juste, il faut d’abord faire constater que le logement est inoccupé … bon vous êtes plus à même de comprendre le livre que moi après tout… tenez. Je vous souhaite une bonne route, quant à moi je vais essayer de retrouver mon groupe…
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;
		&lt;&lt;link &quot;Un serrurier&quot;&gt;&gt;&lt;!—#######Mauvaise réponse######--&gt;
			&lt;&lt;replace &quot;#repondre1&quot;&gt;&gt;
-	Et beh mon vieux… je savais bien que vous n’y connaissiez rien en droit. Bonne continuation en tout cas …
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;
	&lt;/span&gt;
&lt;&lt;else&gt;&gt;
&lt;!—###############Question 2######--&gt;
Par exemple, pouvez-vous me dire quelle est la personne à contacter si une voiture vous empêche de circuler normalement sur la route ?
Répondre :
	&lt;span id=&quot;repondre2&quot;&gt;
		&lt;&lt;link &quot;La police&quot;&gt;&gt; &lt;!—#######Bonne réponse######--&gt;
			&lt;&lt;replace &quot;#repondre2&quot;&gt;&gt;
&lt;&lt;set $livrescout to true&gt;
-	Effectivement, vous avez vu juste… bon vous êtes plus à même de comprendre le livre que moi après tout… tenez. Je vous souhaite une bonne route, quant à moi je vais essayer de retrouver mon groupe…
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;
		&lt;&lt;link &quot;Le ministre de la justice&quot;&gt;&gt;&lt;!—#######Mauvaise réponse######--&gt;
			&lt;&lt;replace &quot;#repondre2&quot;&gt;&gt;
-	Et beh mon vieux… je savais bien que vous n’y connaissiez rien en droit. Bonne continuation en tout cas …
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;
	&lt;/span&gt;
&lt;&lt;/if&gt;&gt;
[[Suite]]
			&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;&lt;link &quot;Le laisser dans son monde&quot;&gt;&gt;
		&lt;&lt;replace &quot;#interagir&quot;&gt;&gt;
Le scout vous paraissant tellement intéressé par sa lecture, vous décidez de ne pas le déranger…
[[Suite]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;</tw-passagedata>
<tw-passagedata pid="31" name="Clairière" tags="" position="1881,1385">&lt;&lt;if $livre eq true&gt;&gt;\
&lt;img class=&quot;illustration&quot; alt=&quot;animaux&quot; src=&quot;media/pictures/illustrations/animaux.png&quot;/&gt;
Alors que vous avancez dans le sentier, les bruits deviennent de plus en plus clairs et vous devinez une conversation. Alors que vous alliez vous manifester, vous voyez des animaux parlant entre-eux. Étant troublé que des animaux puissent être instruits, vous rigolez silencieusement en les imaginant dans une classe en train d’étudier un livre. Absorbé par leur conversation, ils ne semblent pas vous avoir vu...
[[Se manifester-&gt;Manifestation]]
[[Repartir discrètement-&gt;retourdiscret]]
[[Fuir-&gt;retourfuite]]
&lt;&lt;elseif $os eq true&gt;&gt;\
&lt;img class=&quot;illustration&quot; alt=&quot;animaux fantômes&quot; src=&quot;media/pictures/illustrations/animaux_fantomes.png&quot;/&gt;
Alors que vous avancez dans le sentier, les bruits restent incompréhensibles et semble provenir d&#39;outre-tombe. C&#39;est alors que, du coin de l&#39;œil, vous apercevez des animaux à l&#39;aspect fantomatique...
[[Repartir discrètement-&gt;retourdiscret]]
[[Fuir-&gt;retourfuite]]
&lt;&lt;else&gt;&gt;\
&lt;&lt;set $tresor to true&gt;&gt;\
Empruntant le sentier, vous débouchez sur une paisible clairière  délimitée par une haute et épaisse haie. Après l&#39;avoir contemplée, alors que vous repartiez, vous apercevez un objet brillant dans l&#39;herbe. Vous découvrez alors une ancienne chevalière en or de très belle facture, portant comme sceau un chevalier. Content de cette trouvaille, vous repartez sur vos pas pour reprendre votre route...
[[Continuer-&gt;Groupe de scout]]
&lt;&lt;/if&gt;&gt;</tw-passagedata>
<tw-passagedata pid="32" name="Portesecrete" tags="" position="3417,1125">Alors que vous avancez sur ce paisible chemin, en comparaison du début, vous observez que sur votre gauche les arbres laissent place à un mur de plantes grimpantes. Longeant ce mur, un renfoncement apparait dans ce couvert végétal. Curieux, vous décidez de voir ce qui s’y cache derrière. Les fragiles plantes ne résistent pas bien longtemps et c’est ainsi que ce découvre une sorte de porte. Sur celle-ci, vous apercevez 11 étranges symboles composés d&#39;or et, en les examinant de plus près, il est possible de voir des chevaliers en armure et un emplacement vide entre le dixième et le onzième symbole.
&lt;span id=&quot;porte&quot;&gt;
&lt;&lt;if $tresor eq true&gt;&gt;
&lt;&lt;link &quot;Mettre la chevalière dans l’emplacement&quot;&gt;&gt;
&lt;&lt;replace &quot;#porte&quot;&gt;&gt;
Vous insérez la chevalière, trouvée dans la clairière, dans cette porte qui, après avoir entendu un bruit sourd, se met à pivoter pour laisser place à un passage sombre et étroit…
[[Entrer-&gt;lieusecret]]
[[Laisser le mystère à sa place et reprendre la route-&gt;jardincabane]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;link &quot;Poursuivre&quot;&gt;&gt;
&lt;&lt;replace &quot;#porte&quot;&gt;&gt;
Lassé de ne pas comprendre la présence d’une telle porte dans un endroit aussi discret (bien que vous sentiez la présence d’un ancien mystère), vous partez …
[[Suite-&gt;jardincabane]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;/span&gt;</tw-passagedata>
<tw-passagedata pid="33" name="lieusecret" tags="" position="3565,1065">Vous entrez donc dans ce tunnel où il ne fait pas froid. Au fur et à mesure de votre progression les torches accrochées au mur s&#39;allument. Alors que vous tournez dans ce couloir, vous débouchez sur un panneau où il est inscrit &quot;EN TRAVAUX DANGER !!!&quot;. Apparemment, les ouvriers devant construire cet endroit n&#39;ont pas terminé leur tâche car le couloir s&#39;arrête ici. Déçu, vous n&#39;avez plus qu&#39;à repartir...
[[Retourner sur vos pas-&gt;jardincabane]] </tw-passagedata>
<tw-passagedata pid="34" name="menu" tags="" position="234,866">&lt;&lt;audio &quot;:all&quot; stop&gt;&gt;
&lt;img id=&quot;game_title&quot; alt=&quot;Chaudron magique&quot; src=&quot;media/pictures/title.png&quot; /&gt;

Chaudron magique est un jeu narratif à embranchements qui vous confronte à la maladresse de Zek le sorcier. Oserez-vous l&#39;aider à maîtriser sa terrible décoction, ou serez-vous condamné(e) à en subir les effets des plus... //magiques// ?

Qui sait, à la fin de votre périple aurez-vous peut-être la chance de le raisonner...

&lt;div style=&quot;text-align: center&quot;&gt;\
[[Jouer-&gt;VarsReset]]
&lt;&lt;link &quot;Repartir de zéro&quot;&gt;&gt;\
&lt;&lt;script&gt;&gt;
var r = confirm(&quot;Êtes-vous sûr(e) de vouloir continuer ?&quot;);
if (r == true) {
	Engine.restart();
}
&lt;&lt;/script&gt;&gt;\
&lt;&lt;/link&gt;&gt;
[[Voir les succès débloqués-&gt;succes]]
[[Crédits]]\
&lt;/div&gt;</tw-passagedata>
<tw-passagedata pid="35" name="Crédits" tags="" position="383,1017">!Crédits

Jeu vidéo réalisé dans le cadre de l&#39;UV IC06 à l&#39;UTC au semestre d&#39;automne 2016 par les étudiants :
&lt;ul&gt;
&lt;li&gt;Fabien Boucaud&lt;/li&gt;
&lt;li&gt;Maxime Nivelle&lt;/li&gt;
&lt;li&gt;Baptiste Perraud&lt;/li&gt;
&lt;/ul&gt;
!!Ressources
&lt;ul&gt;
&lt;li&gt;les musiques ont toutes été composées par B. Perraud dans le cadre du projet ;&lt;/li&gt;
&lt;li&gt;de même pour les illustrations ;&lt;/li&gt;
&lt;li&gt;le fond utilisé est tiré d&#39;un pack gratuit de fonds d&#39;écran disponible &lt;a href=&quot;http://stuffpoint.com/nature/image/462712/magical-forest-wallpaper/&quot;&gt;ici&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
!!!Bruitages
&lt;ul&gt;
&lt;li&gt;Ronflements : http://soundbible.com/1634-Snoring.html &lt;/li&gt;
&lt;li&gt;Orage : http://soundbible.com/2016-Thunder-Strike-2.html &lt;/li&gt;
&lt;li&gt;Explosion : http://s1download-universal-soundbank.com/mp3/sounds/1426.mp3 &lt;/li&gt;
&lt;li&gt;Noyade : http://soundbible.com/1660-Underwater-Pool.html &lt;/li&gt;
&lt;/ul&gt;
[[Retourner au menu-&gt;menu]]</tw-passagedata>
<tw-passagedata pid="36" name="Intro" tags="" position="31,1229">&lt;&lt;nobr&gt;&gt;
&lt;&lt;audio &quot;awaking&quot; loop play volume 0.8&gt;&gt;
&lt;&lt;audio &quot;snoring&quot; loop volume 0.25 fadeto 0.5&gt;&gt;
&lt;span id=&quot;intro_text&quot;&gt;

Alors que doucement la forêt s&#39;éveille sous les doux et chauds rayons solaires de l&#39;aube, tout semble indiquer que la journée sera belle. La lumière matinale trouve son chemin jusqu&#39;à la fenêtre d&#39;une petite cabane où vous dormez d&#39;un sommeil manifestement agité. À mesure que l&#39;obscurité de la nuit est chassée de votre humble demeure vous vous arrachez
&lt;/span&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;linkreplace &quot; aux bras de Morphée...&quot;&gt;&gt;
	&lt;&lt;nobr&gt;&gt;
	&lt;&lt;remove &quot;#intro_text&quot;&gt;&gt;
  	&lt;&lt;audio &quot;snoring&quot; stop&gt;&gt;
	&lt;&lt;append &quot;#passages&quot;&gt;&gt;
  	&lt;div class=&quot;black_overlay&quot;&gt;&lt;/div&gt;
	&lt;&lt;/append&gt;&gt;
 	&lt;img class=&quot;illustration&quot; alt=&quot;reveil&quot; src=&quot;media/pictures/illustrations/reveil.png&quot;/&gt;
 	&lt;&lt;/nobr&gt;&gt;
	&lt;span id=&quot;waking-up-text&quot; style=&quot;opacity: 0&quot;&gt;
	Le réveil est toujours comme une nouvelle naissance : il vous semble que vous ne connaissez plus rien ni ne savez plus rien faire.
	&lt;&lt;linkreplace &quot;J&#39;suis qui déjà ?&quot; t8n&gt;&gt;
	Les dernières brumes du sommeil commençant à s&#39;évaporer, vous vous rappelez que vous êtes un magicien (&quot;et un bon !&quot; ajoutez-vous alors que les mots vous reviennent) vivant reclus dans la forêt depuis qu&#39;une malencontreuse formule magique a semé la zizanie dans votre précédente commune de résidence, bien des années plus tôt, et que vos concitoyens en ont eu assez de ces remue-ménages dont vous avez le secret.
	À ce souvenir vous ne pouvez réprimer un sourire de jubilation et un haussement d&#39;épaules. Vous êtes aussi bien ici à vrai dire, et la tranquilité est une composante importante de tout sortilège réussi. Vous hochez la tête, manifestement qu&#39;à moitié convaincu par vos propres arguments.

	Vous vous rendez compte qu&#39;un gargouillement se fait entendre de manière continue dans votre cabane et vous décidez d&#39;ouvrir vos yeux, tant bien que mal, pour en identifier l&#39;origine. C&#39;est votre chaudron. Il bouillonne apparemment tranquillement (enfin, il y a quand même une odeur bizarre) au-dessus d&#39;un feu que vous avez allumé la veille. Vous vous demandez où en est la cuisson de votre décoction. C&#39;est une potion extrêmement délicate à préparer à laquelle vous vous êtes attaqué, mais il vous semble que rien ne vous est impossible.
	Alors que vous commencez à remuer sur votre couchette, votre ventre se rappelle à vous avec un gros gargouilli. La faim vous tenaille. Par quoi commencer ?

	[[Aller chercher quelque chose à grignoter-&gt;placard]]
	[[Aller jeter un oeil à votre potion-&gt;marmite]]
	&lt;&lt;/linkreplace&gt;&gt;
	&lt;/span&gt;
	&lt;&lt;silently&gt;&gt;
	  &lt;&lt;script&gt;&gt;
	  $(&quot;.passage[data-passage=&#39;Intro&#39;]&quot;).css({
		 &quot;background-color&quot;: &quot;transparent&quot;,
		 &quot;color&quot;: &quot;black&quot;,
		 &quot;filter&quot;: &quot;blur(5px)&quot;
	  });
	  setTimeout(function() {
		  var $this = $(&quot;.black_overlay&quot;);
		  $this
		  .animate({opacity: 0.5}, 1000)
		  .animate({opacity: 1}, 1000)
		  .delay(2000)
		  .animate({opacity: 0.3}, 1000)
		  .animate({opacity: 1}, 1000)
		  .delay(2000)
		  .animate({opacity: 0}, 1000, &quot;swing&quot;, function() {
			  $(this).remove();
		  });
	  }, 1000);
	  &lt;&lt;/script&gt;&gt;
	  
	  &lt;&lt;timed 10.5s t8n&gt;&gt;
	  &lt;&lt;script&gt;&gt;
		setTimeout(function() {
		  $(&#39;#waking-up-text&#39;).animate({opacity: 1}, 400, &quot;swing&quot;, function () {
		  	blurElement(&quot;#passage-intro&quot;, 0, 1);
		  });
		}, 1000);
	  &lt;&lt;/script&gt;&gt;
	  &lt;&lt;/timed&gt;&gt;
	&lt;&lt;/silently&gt;&gt;
	
&lt;&lt;/linkreplace&gt;&gt;</tw-passagedata>
<tw-passagedata pid="37" name="Suite" tags="" position="152,708">Double-cliquez sur ce passage pour le modifier.</tw-passagedata>
<tw-passagedata pid="38" name="cabaneexplose" tags="" position="3789,1261">Avant même que vous ne vous présentiez, l&#39;individu se redresse et se tourne vers vous...
&lt;&lt;if $aidernains eq true&gt;&gt;&lt;!-- ####présence de nains########--&gt;
- Bonjour l&#39;ami... je vous attendais... 
Remarquant les nains, il s’adresse à eux :
- Tiens salut les nains alors ça va ?
- …
Se redressant, il ajoute :
- Ah quels compagnons agréables que les nains. Je suppose que votre périple fût intéressant car il se trouve que j’ai une potion qui a dégénérée mais je crois que quelque chose ne s&#39;est pas bien passé, vous savez avec l&#39;âge…
&lt;span id=&quot;repondre&quot;&gt;
	&lt;&lt;link &quot;Lui exprimer votre point de vue&quot;&gt;&gt;
		&lt;&lt;replace &quot;#repondre&quot;&gt;&gt;
- Oulla mon ami restez calme. Après tout c’est vous qui vouliez me voir, je ne vous ai pas invité. 
- Nous en avons marre de vos expériences vieux crouton…
Alors même que les nains allaient commencer à balancer une flopée de jurons, le sorcier leur jette un sort, les rendant muets…
	&lt;span id=&quot;agir&quot;&gt;
		&lt;&lt;link &quot;Soutenir les nains&quot;&gt;&gt;
			&lt;&lt;replace &quot;#agir&quot;&gt;&gt;
- Oh c’est bon, je n’ai pas le droit de m’amuser ? C’est moi qui leur ai donné vie donc je peux en faire ce que je veux … Attendez, vous me jugez ?? Donc votre venue était uniquement dans le but de me juger sur mes faits et non pas argumenter ?
[[Argumenter-&gt;argumentation]]
[[Juger-&gt;jugement]]
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;
		&lt;&lt;link &quot;Continuer comme si de rien n&#39;était&quot;&gt;&gt;
			&lt;&lt;replace &quot;#agir&quot;&gt;&gt;
- Aaaah le silence… ils peuvent être pénible parfois…. Alors que me vaut votre venue ? La présence des nains m’indique qu’ils vous ont racontés leur mécontentement mais je suppose que votre intérêt premier concerne l’argumentation… 
[[Argumenter-&gt;argumentation]]
[[Juger-&gt;jugement]]
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;
	&lt;/span&gt;
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;
&lt;&lt;else&gt;&gt; &lt;!-- ###########pas de nains#######################--&gt;
- Bonjour l&#39;ami... je vous attendais... Je suppose que votre périple fût intéressant car il se trouve que j’ai une potion qui a dégénérée mais je crois que quelque chose ne s&#39;est pas bien passé, vous savez avec l&#39;âge…
&lt;span id=&quot;repondre&quot;&gt;
	&lt;&lt;link &quot;Lui exprimer votre point de vue&quot;&gt;&gt;
		&lt;&lt;replace &quot;#repondre&quot;&gt;&gt;
- Oulla mon ami restez calme. Après tout c’est vous qui vouliez me voir, je ne vous ai pas invité.  Alors que me vaut votre venue ? Vous voulez me jugez sur mes actions ? Si je suis ici c’est que les villageois l’ont voté donc je ne vois pas ce que vous pourrez redire là-dessus… je suppose plutôt que votre intérêt premier concerne l’argumentation face à une personne aussi sage que moi … 
[[Argumenter-&gt;argumentation]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata>
<tw-passagedata pid="39" name="cabane" tags="" position="3787,1077">Avant même que vous commenciez à approcher votre main de la porte, la porte pivote sur elle-même, sans un bruit, pour laisser place à un individu...
&lt;&lt;if $aidernains eq true&gt;&gt;&lt;!-- ####présence de nains########--&gt;
- Bonjour l&#39;ami... je vous attendais... 
Remarquant les nains, il s’adresse à eux :
- Tiens salut les nains alors ça va ?
- …
Se redressant, il ajoute :
- Ah quels compagnons agréables que les nains. Je suppose que votre périple fût intéressant car il se trouve que j’ai une potion qui a dégénérée mais comme d’hab j’ai géré…
&lt;span id=&quot;repondre&quot;&gt;
	&lt;&lt;link &quot;Lui exprimer votre point de vue&quot;&gt;&gt;
		&lt;&lt;replace &quot;#repondre&quot;&gt;&gt;
- Oulla mon ami restez calme. Après tout c’est vous qui vouliez me voir, je ne vous ai pas invité. 
- Nous en avons marre de vos expériences vieux crouton…
Alors même que les nains allaient commencer à balancer une flopée de jurons, le sorcier leur jette un sort, les rendant muets…
	&lt;span id=&quot;agir&quot;&gt;
		&lt;&lt;link &quot;Soutenir les nains&quot;&gt;&gt;
			&lt;&lt;replace &quot;#agir&quot;&gt;&gt;
- Oh c’est bon, je n’ai pas le droit de m’amuser ? C’est moi qui leur ai donné vie donc je peux en faire ce que je veux … Attendez, vous me jugez ?? Donc votre venue était uniquement dans le but de me juger sur mes faits et non pas argumenter ?
[[Argumenter-&gt;argumentation]]
[[Juger-&gt;jugement]]
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;
		&lt;&lt;link &quot;Continuer comme si de rien n&#39;était&quot;&gt;&gt;
			&lt;&lt;replace &quot;#agir&quot;&gt;&gt;
- Aaaah le silence… ils peuvent être pénible parfois…. Alors que me vaut votre venue ? La présence des nains m’indique qu’ils vous ont racontés leur mécontentement mais je suppose que votre intérêt premier concerne l’argumentation… 
[[Argumenter-&gt;argumentation]]
[[Juger-&gt;jugement]]
			&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/link&gt;&gt;
	&lt;/span&gt;
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;
&lt;&lt;else&gt;&gt; &lt;!-- ###########pas de nains#######################--&gt;
- Bonjour l&#39;ami... je vous attendais... Je suppose que votre périple fût intéressant car il se trouve que j’ai une potion qui a dégénérée mais comme d’hab j’ai géré…
&lt;span id=&quot;repondre&quot;&gt;
	&lt;&lt;link &quot;Lui exprimer votre point de vue&quot;&gt;&gt;
		&lt;&lt;replace &quot;#repondre&quot;&gt;&gt;
- Oulla mon ami restez calme. Après tout c’est vous qui vouliez me voir, je ne vous ai pas invité.  Alors que me vaut votre venue ? Vous voulez me jugez sur mes actions ? Si je suis ici c’est que les villageois l’ont voté donc je ne vois pas ce que vous pourrez redire là-dessus… je suppose plutôt que votre intérêt premier concerne l’argumentation face à une personne aussi sage que moi … 
[[Argumenter-&gt;argumentation]]
		&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;/span&gt;
&lt;&lt;/if&gt;&gt;
</tw-passagedata>
<tw-passagedata pid="40" name="argumentation" tags="" position="4076,1344">Arrivant alors à votre but premier d’échanger avec cet étrange personnage, vous vous installez confortablement pour débuter votre échange, qui promet d&#39;être riche, quoique sans doute mouvementé. Vous commencez donc à discuter à propos de la sorcellerie. D’abord, argumentant chacun votre tour, pour défendre votre point de vue sur l’utilisation de sortilèges à tout bout de champ, votre discussion diverge rapidement pour traiter de sujets de plus en plus vastes. Le temps défilant alors, la conversation se poursuit jour et nuit et nuit et jour… À ce jour, personne ne sait de qui, du sorcier ou du promeneur, a réussi à clouer le bec de l’autre.
[[The End-&gt;fin]]</tw-passagedata>
<tw-passagedata pid="41" name="jugement" tags="" position="4046,657">&lt;&lt;set $variable to random(1,5)&gt;&gt;

C&#39;est alors que le sorcier jette un sort et que tous les individus impliqués dans ses actions se matérialisent devant vous :

Les nains &lt;&lt;if $os eq true&gt;&gt;, des fantômes d&#39;animaux&lt;&lt;/if&gt;&gt;&lt;&lt;if $dragon eq &quot;dragon&quot;&gt;&gt;, un dragon&lt;&lt;/if&gt;&gt;&lt;&lt;if $livre eq true&gt;&gt;, des animaux qui discutent entre eux&lt;&lt;/if&gt;&gt;&lt;&lt;if $dragon eq &quot;mouton&quot;&gt;&gt;, un mouton&lt;&lt;/if&gt;&gt;&lt;&lt;if $champignon eq true&gt;&gt;, le groupe de scouts&lt;&lt;/if&gt;&gt;&lt;&lt;if $scoutaide  eq true&gt;&gt;, le groupe de scouts&lt;&lt;/if&gt;&gt;&lt;&lt;if $corne eq true&gt;&gt; et un rhinocéros... Regardant sa corne, le sorcier comprend alors qu&#39;il s&#39;est fait berner et que la corne incorporée précédemment ne provenait pas d&#39;une licorne&lt;&lt;/if&gt;&gt;.

Maintenant que toute cette étonnante ménagerie se présente dans son intégralité sous vos yeux, vous ne pouvez vous empêcher de vous demander si tout ceci est bien réel et si vous n&#39;êtes pas en train de rêver depuis le début de toute cette histoire... Vous pouvez vous &lt;span id=&quot;pincement&quot;&gt;&lt;&lt;link &quot;pincer&quot;&gt;&gt;&lt;&lt;if $variable eq 2&gt;&gt;&lt;&lt;set $dream to true&gt;&gt;&lt;&lt;goto &quot;fin&quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;replace &quot;#pincement&quot;&gt;&gt;pincer (Aïe !!)&lt;&lt;/replace&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;/span&gt;, juste histoire d&#39;être sûr.

-Eh bien ! s&#39;exclama le vieux magicien, je ne m&#39;attendais pas à voir autant de monde rappliquer ! Enfin je veux dire, les nains, je m&#39;en doutais, mais... pas le reste.

L&#39;air fort contrarié, chacun des intéressés y va alors de ses réclamations et de ses injures, dans un brouhaha difficile à décrypter.

- Cette fois, fichu vieillard, vous ne pourrez pas ignorer nos réclamations ! s&#39;écrient les nains de jardin en sortant leur longue liste d&#39;exigences.
&lt;&lt;if $os eq true&gt;&gt;- ... Bouuuuuuuuuuuuuh ??!!!! s&#39;exclament quant à eux les animaux fantômes, quelque peu surpris d&#39;apparaître ainsi à un endroit inconnu.
Ils ne tardent cependant pas à reprendre leurs esprits (hohoho, un comble pour des fantômes) et à s&#39;appliquer à essayer d&#39;effrayer les individus présents, quitte à se prendre les pattes dans leurs draps blancs, occasionnellement.&lt;&lt;/if&gt;&gt;
&lt;&lt;if $dragon eq &quot;dragon&quot;&gt;&gt;- Qu&#39;est-ce que... ? Ne serait-ce pas ce vulgaire et ***** de sorcier qui m&#39;avait métamorphosé en monture dédiée à son bon plaisir ?! Retenez-moi, ou je vous jure que je le carbonise sur le champ ! s&#39;insurgeait quant à lui le dragon, avant de se laisser distraire. Oh ! Quels mignons mais bruyants petits personnages barbus...&lt;&lt;/if&gt;&gt;
&lt;&lt;if $livre eq true&gt;&gt;- Hmm, quelle fascinante chose que la magie, n&#39;est-ce pas ?
- Je n&#39;aurais pas mieux dit cher ami animal, répondit un lapin à un cerf. Une chose fantastique que j&#39;ai envie d&#39;apprendre au plus vite ! Il me semble que les individus de mon espèce sont souvent impliqués dans les tours, il est temps pour moi de montrer que nous pouvons également devenir de brillants magiciens !&lt;&lt;/if&gt;&gt;
&lt;&lt;if $gateau eq true&gt;&gt;- Bêêêêêê, fit le mouton à l&#39;air draconin avant de se mettre à brouter.&lt;&lt;/if&gt;&gt;
&lt;&lt;if $champignon eq true&gt;&gt;- WOUAW Qu&#39;est-ce que c&#39;est que cette horde de démons ?! s&#39;exclamèrent en coeur les scouts hallucinés, avant de prendre leurs jambes à leur cou...&lt;&lt;/if&gt;&gt;
&lt;&lt;if $scoutaide  eq true&gt;&gt;- SCOUTS A LA RESCOUSSE ! s&#39;exclamèrent en coeur les scouts auxquels vous aviez donné un coup de main bienvenu.&lt;&lt;/if&gt;&gt;
&lt;&lt;if $corne eq true&gt;&gt;Quant au rhinocéros, il ne fit pas grand&#39;chose, visiblement très surpris et loin d&#39;être une lumière. Il battait de la queue nerveusement.&lt;&lt;/if&gt;&gt;

Satisfait de voir tous ces nouveaux venus aussi loquaces, vous restez un instant à écouter cette cacophonie le sourire aux lèvres. Puis vous réalisez que ça va être à vous d&#39;organiser la mise en justice de magicien.

- Un peu de calme s&#39;il vous plaît !! vous écriez-vous, non sans froncer les sourcils (ce n&#39;est guère dans votre nature de hausser la voix et vous trouvez cela tout à fait désagréable).
Une fois un semblant de silence revenu, vous reprenez, en vous adressant au sorcier:
- Voici mes témoins ! Je propose de les laisser s&#39;exprimer quant à vos méfaits. Nous verrons bien ce que vous aurez à répondre !
- Hmpffff ! répondit simplement le magicien, croisant les bras avec un air de défi.

Qui appeler à s&#39;exprimer ?
&lt;&lt;if $dragon eq &quot;dragon&quot;&gt;&gt;[[Le dragon ! C&#39;est sûr qu&#39;il clouera le bec au magicien, il en impose.-&gt;finDragon]]&lt;&lt;/if&gt;&gt;

&lt;&lt;if $livre eq true&gt;&gt;[[Ces animaux intelligents semblent extrêmement réfléchis, ils arriveront sans doute à lui faire entendre raison.-&gt;finAnimauxIntel]]&lt;&lt;/if&gt;&gt;

&lt;&lt;if $dragon eq &quot;mouton&quot;&gt;&gt;[[Le mouton ?!?... Il a un quelque chose d&#39;attendrissant, peut-être...-&gt;finMouton]]&lt;&lt;/if&gt;&gt;

&lt;&lt;if $scoutaide  eq true&gt;&gt;[[Ces scouts pleins de joie de vivre pourraient peut-être lui montrer, dans la bonne humeur, qu&#39;il faut qu&#39;il soit plus prudent à l&#39;avenir.-&gt;finScouts]]&lt;&lt;/if&gt;&gt;

&lt;&lt;if $corne eq true&gt;&gt;[[Le rhinocéros semble vous regarder d&#39;un air à la fois ennuyé et menaçant et vous ne voyez pas bien ce qu&#39;il pourrait faire pour vous mais, après tout, dans l&#39;absolu : pourquoi pas ?-&gt;finRhino]]&lt;&lt;/if&gt;&gt;</tw-passagedata>
<tw-passagedata pid="42" name="fin" tags="" position="5007,1063">&lt;&lt;if $bad_end != false&gt;&gt;\
&lt;&lt;nobr&gt;&gt;
	&lt;&lt;if !$bad_ends.includes($bad_end)&gt;&gt;
		&lt;&lt;set $bad_ends.push($bad_end)&gt;&gt;

		&lt;&lt;switch $bad_end&gt;&gt;
		&lt;&lt;case &quot;riviere&quot;&gt;&gt;
		&lt;&lt;set $succes.push(&quot;mouille&quot;)&gt;&gt;
		Félicitations, vous avez débloqué le succès
		&quot;&#39;&#39;Mouillé&#39;&#39;&quot;, pour être resté dans la glace plutôt que de chercher à survivre, correspondant à la fin prématurée n°1 sur 4.
		&lt;&lt;case &quot;discussion&quot;&gt;&gt;
		&lt;&lt;set $succes.push(&quot;baratineur&quot;)&gt;&gt;
		Félicitations, vous avez débloqué le succès
		&quot;&#39;&#39;Baratineur&#39;&#39;&quot;, pour avoir voulu clouer le bec au lapin plutôt que de poursuivre votre route, correspondant à la fin prématurée n°2 sur 4.
		&lt;&lt;case &quot;ravin&quot;&gt;&gt;
		&lt;&lt;set $succes.push(&quot;speleologue&quot;)&gt;&gt;
		Félicitations, vous avez débloqué le succès
		&quot;&#39;&#39;Spéléologue&#39;&#39;&quot;, pour avoir surestimé votre chance face au raccourci escarpé, correspondant à la fin prématurée n°3 sur 4.
		&lt;&lt;case &quot;mange&quot;&gt;&gt;
		&lt;&lt;set $succes.push(&quot;jambon&quot;)&gt;&gt;
		Félicitations, vous avez débloqué le succès
		&quot;&#39;&#39;Jambon&#39;&#39;&quot;, pour avoir sous-estimé les réflexes du vieux dragon, correspondant à la fin prématurée n°4 sur 4.
		&lt;&lt;/switch&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

Malheureusement pour vous, vous n’avez pas réussi à finir le jeu. Vous pouvez recommencer l’histoire qui comporte 18 combinaisons d&#39;ingrédients différentes, modifiant alors l&#39;environnement du promeneur...

&lt;&lt;elseif $dream eq true&gt;&gt;
&lt;&lt;set $succes.push(&quot;dream&quot;)&gt;&gt;
Vous vous éveillez brusquement dans la chambre de l&#39;auberge //Au Sanglier Chaud// que vous aviez louée la veille au sein du petit village de Spass-Riain-Issy. Durant à peine une seconde quelques images de votre rêve vous reviennent à l&#39;esprit, puis son souvenir vous échappe, définitivement. Cela vous agace et vous passez de longues minutes à essayer de vous rappeler ce dont il s&#39;agissait. Mais l&#39;échec répété a raison de vous et vous finissez par abandonner la partie. Vous vous levez et quittez votre chambre pour aller prendre un petit-déjeûner et vous préparer à reprendre vos pérégrinations de promeneur éclairé.

Au loin dans la forêt, à votre insu, une explosion retentit...

Félicitations, vous avez terminé le jeu (quoique d&#39;une façon très particulière) !!! Il ne s&#39;agissait que de la version bêta mais nous espérons qu’il vous a plu ! Vous pouvez recommencer l’histoire qui comporte 18 combinaisons d&#39;ingrédients différentes, modifiant alors l&#39;environnement du promeneur... N&#39;hésitez pas à nous faire un retour.

&lt;&lt;else&gt;&gt;
&lt;&lt;set $succes.push(&quot;default&quot;)&gt;&gt;
Félicitations, vous avez terminé le jeu !!! Il ne s&#39;agissait que de la version bêta mais nous espérons qu’il vous a plu ! Vous pouvez recommencer l’histoire qui comporte 18 combinaisons d&#39;ingrédients différentes, modifiant alors l&#39;environnement du promeneur... N&#39;hésitez pas à nous faire un retour.
&lt;&lt;/if&gt;&gt;\

[[Retourner au menu-&gt;menu]]</tw-passagedata>
<tw-passagedata pid="43" name="finDragon" tags="" position="4669,415">Comme vous avez bien compris que discuter avec le dragon peut s&#39;avérer être dangereux à qui n&#39;est pas prudent, vous vous approchez de l&#39;imposante créature et lui criez:

-Ô Noble Dragon ! Voudrez-vous bien expliquer à ce Magicien ce que vous pensez de sa magie ?!

Visiblement flattée, la bête découvre des dents aiguisées comme des rasoirs, sa bouche se déformant en un inquiétant rictus réptilien qu&#39;il devait imaginer ressemblant à un sourire.

-Avec plaisir ! rugit-il en s&#39;approchant du Sorcier occupé à se curer les dents, visiblement peu inquiété par la créature ancestrale. Magicien ! Il y a longtemps tu m&#39;as jeté un sort, métamorphosé en une vulgaire monture inanimée que tu pouvais utiliser à ta guise, je n&#39;étais plus rien et mon trésor a été volé ! Tu dois répondre de tes actes et je propose de te... DÉVORER !!!!

Le dragon étend alors brusquement son long cou écailleux, à la surprise générale, toutes dents dehors, en direction du vieillard barbu. Tout le monde est choqué, terrifié, et c&#39;est la débandade: chacun part en criant, sûr qu&#39;il est le prochain à passer à la casserolle. Tout le monde sauf le magicien, qui n&#39;en est pas à sa première rencontre avec ce genre de canaille, et vous-même, qui avez prêté serment devant l&#39;ordre des promeneurs de ne jamais courir (il faut partir à point). Vous assistez alors à une scène incroyable: le magicien, d&#39;un mouvement des bras et d&#39;une formule bien énoncée, métamorphose le dragon furieux en un docile petit lézard qui disparaît de votre vue dans l&#39;herbe. Tout s&#39;est passé en l&#39;espace d&#39;un souffle.

Les fuyards reviennent peu à peu près de vous, après avoir constaté que le danger était écarté, mais plus personne ne semble très motivé par l&#39;idée de demander des comptes au magicien. La démonstration de force était très claire. Celui-ci, s&#39;en rendant bien compte, retourne vers son domicile en ricanant.

- À une prochaine fois, les ploucs !

Dépité, vous décidez de faire de même que vos compagnons, qui commencent déjà à se disperser, gênés, et vous vous mettez en route pour d&#39;autres contrées, et d&#39;autres aventures...

[[The End-&gt;fin]]</tw-passagedata>
<tw-passagedata pid="44" name="finAnimauxIntel" tags="" position="4176,883">Les animaux intelligents sont un peu surpris que vous les ayez choisis mais n&#39;en sont pas moins ravis. Ils entament une conversation animée avec le magicien, non sans l&#39;avoir d&#39;abord remercié pour l&#39;intelligence qui les anime désormais. Vous réalisez alors que vous avez sans nul doute fait une terrible erreur.

Et en effet, la conversation se poursuit, et se poursuit, et le magicien accepte de prendre le lapin pour apprenti, et le cerf fait une blague sur les cerf-volants, et vous ne trouvez jamais d&#39;ouverture pour les interrompre...

Certains prétendent que cette conversation se poursuit encore aujourd&#39;hui et qu&#39;on peut en entendre les éclats en collant son oreille au tronc d&#39;un arbre de forêt.

[[The End-&gt;fin]]</tw-passagedata>
<tw-passagedata pid="45" name="finMouton" tags="" position="4380,846">Vous envoyez le mouton ailé. Il bêle. Le sorcier rigole. Tout le monde, et vous le premier, pense que vous êtes idiot. Chacun rentre chez soi.

[[The End-&gt;fin]]</tw-passagedata>
<tw-passagedata pid="46" name="finScouts" tags="" position="4568,740">Les scouts vous font un petit clin d&#39;oeil complice. Ils vous en doivent une après le coup de main que vous leur avez filé plus tôt.

- On s&#39;en occupe !

Vous les regardez s&#39;en aller tout souriant près du magicien, comme s&#39;ils allaient essayer de lui vendre des cookies. A son oeil rieur, vous pouvez constater que le concerné ne se sent guère menacé.

Et pourtant, d&#39;un seul coup, les petits anges se transforment en démon. Tout arrive si vite que votre vision devient floue, vous ne comprenez pas ce qui se passe. Puis il ne reste plus que les scouts, toujours aussi souriants, assis sur un magicien ligoté et bayonné.

-Nous l&#39;avons jugé coupable de magie exercée inconsciemment et nous l&#39;avons fait prisonnier !

Autour de vous, c&#39;est la fête.

Vous souriez en réponse aux heureuses têtes blondes.

[[The End-&gt;fin]]</tw-passagedata>
<tw-passagedata pid="47" name="finRhino" tags="" position="4543,588">Pas bien sûr de comment vous allez pouvoir faire comprendre au rhinocéros ce que vous attendez de lui (mais qu&#39;y a-t-il à attendre de lui, vous demandez-vous alors en secouant la tête devant votre propre choix tout à fait incongru), vous vous avancez prudemment de lui. Il reste toutefois immobile, se contentant de vous suivre du regard, ce qui vous rassure un peu.

Une fois arrivé à son côté. Vous restez un moment interdit, à l&#39;instar de tous les autres spectateurs présents, qui vous regardent l&#39;air dépité. Vous haussez les épaules puis pointez le magicien du doigt et faîtes un petit signe de tête d&#39;encouragement au rhino. Celui-ci continue à vous regarder sans faire mine de bouger. Vous froncez les sourcils et refaîtes un mouvemement de tête insistant. Toujours pas de réaction.

Puisque vous ne pouvez pas simplement renoncer, vous prenez une longue inspiration puis, sans hésiter mais en fermant très fort les yeux, vous assénez une grande claque à l&#39;arrière-train du rhinocéros. Cette fois, la réaction ne se fait pas attendre, bien que ce ne soit pas du tout celle à laquelle vous vous attendiez. Vous sentez une soudaine chaleur près de vous et entrouvrez un oeil. Vous êtes face à un rhinocéros luminescent dont la corne est devenue multicolore et brillante. Définitivement, il y a quelque chose de magique avec ce rhinocéros. Cela dit c&#39;est plutôt joli.

Toutefois, les choses ne s&#39;arrêtent pas là : voilà que le rhinocéros se met maintenant à grandir. En un instant, il fait deux fois sa taille précédente, et cela continue jusqu&#39;à ce qu&#39;il soit aussi haut que la cîme des arbres. Vous vous éloignez en vitesse de la créature, qui ne semble pas pour autant plus motivée à bouger. Un regard autour de vous vous rassure au moins quant au fait que vous n&#39;êtes pas le seul surpris.

- Bon... dit soudain le magicien, après un long moment de silence médusé. Je crois que là je commence à voir pourquoi il faut faire attention avec la magie...

[[The End-&gt;fin]]</tw-passagedata>
<tw-passagedata pid="48" name="succes" tags="" position="438,791">!Succès déverrouillés
&lt;ul style=&quot;list-style-type: none&quot;&gt;
&lt;&lt;for _i=0; _i&lt;$succes_map.length; _i++&gt;&gt;
&lt;&lt;if $succes.includes($succes_map[_i][&quot;id&quot;])&gt;&gt;\
&lt;li&gt;\
&lt;&lt;print &quot;&lt;img class=&#39;badge&#39; src=&#39;media/pictures/badges/&quot; + $succes_map[_i][&#39;id&#39;] + &quot;_true.png&#39; alt=&#39;badge&#39;/&gt;&quot;&gt;&gt; \
&#39;&#39;&lt;&lt;print $succes_map[_i][&quot;name&quot;]&gt;&gt;&#39;&#39; : \
&lt;&lt;print $succes_map[_i][&quot;desc&quot;]&gt;&gt;&lt;/li&gt;\
&lt;&lt;else&gt;&gt;\
&lt;li style=&quot;color: grey&quot;&gt;\
&lt;&lt;print &quot;&lt;img class=&#39;badge&#39; src=&#39;media/pictures/badges/&quot; + $succes_map[_i][&#39;id&#39;] + &quot;.png&#39; alt=&#39;badge&#39;/&gt;&quot;&gt;&gt; \
&#39;&#39;&lt;&lt;print $succes_map[_i][&quot;name&quot;]&gt;&gt;&#39;&#39; : Vous n&#39;avez pas encore débloqué ce succès !&lt;/li&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/for&gt;&gt;
&lt;/ul&gt;
[[Retour au menu-&gt;menu]]</tw-passagedata>
<tw-passagedata pid="49" name="VarsReset" tags="" position="150,1021">&lt;!--ingrédients--&gt;

&lt;&lt;set $livre to false&gt;&gt;
&lt;&lt;set $gateau to false&gt;&gt;

&lt;&lt;set $glace to false&gt;&gt;
&lt;&lt;set $poussièredefeu to false&gt;&gt;
&lt;&lt;set $champignon to false&gt;&gt;

&lt;&lt;set $corne to false&gt;&gt;
&lt;&lt;set $tabac to false&gt;&gt;
&lt;&lt;set $bave to false&gt;&gt;
&lt;&lt;set $orties to false&gt;&gt;
&lt;&lt;set $os to false&gt;&gt;


&lt;!--objets--&gt;

&lt;&lt;set $pieceor to false&gt;&gt;
&lt;&lt;set $tresor to false&gt;&gt;

&lt;&lt;set $allumette to true&gt;&gt;
&lt;&lt;set $lampe to true&gt;&gt;
&lt;&lt;set $baton to true&gt;&gt;
&lt;&lt;set $couteau to true&gt;&gt;


&lt;!--États--&gt;

&lt;&lt;set $dragon to &quot;moto&quot;&gt;&gt;
&lt;&lt;set $scoutperduvu to false&gt;&gt;
&lt;&lt;set $livrescout to false&gt;&gt;

&lt;&lt;set $scoutaide to false&gt;&gt;
&lt;&lt;set $aidernains to false&gt;&gt;
&lt;&lt;set $cabaneexplose to false&gt;&gt;

&lt;!--Succès--&gt;

&lt;&lt;set $bad_end to false&gt;&gt;

&lt;&lt;goto &quot;Intro&quot;&gt;&gt;</tw-passagedata>
</tw-storydata>
</div>
	<script id="script-sugarcube" type="text/javascript">
	/*! SugarCube JS

	SugarCube includes code from TiddlyWiki 1.2.39, which has the following license:
	--------------------------------------------------------------------------------
	TiddlyWiki 1.2.39 by Jeremy Ruston, (jeremy [at] osmosoft [dot] com)

	Published under a BSD open source license

	Copyright (c) Osmosoft Limited 2005

	Redistribution and use in source and binary forms, with or without modification,
	are permitted provided that the following conditions are met:

	Redistributions of source code must retain the above copyright notice, this list
	of conditions and the following disclaimer.

	Redistributions in binary form must reproduce the above copyright notice, this
	list of conditions and the following disclaimer in the documentation and/or
	other materials provided with the distribution.

	Neither the name of the Osmosoft Limited nor the names of its contributors may
	be used to endorse or promote products derived from this software without
	specific prior written permission.

	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
	ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
	WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
	DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
	ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
	(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
	LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
	ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	--------------------------------------------------------------------------------
	*/
	if(document.documentElement.classList.contains('init-loading')){!function(window,document,jQuery,undefined){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function safeActiveElement(){try{return document.activeElement||null}catch(e){return null}}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),_slicedToArray=function(){function e(e,t){var r=[],a=!0,n=!1,i=undefined;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},Alert=function(){function e(e,t,r,a){var n="fatal"===e,i="Apologies! "+(n?"A fatal":"An")+" error has occurred.";i+=n?" Aborting.":" You may be able to continue, but some parts may not work properly.",null==t&&null==r||(i+="\n\nError",null!=t&&(i+=" ["+t+"]"),i+=null!=r?": "+r.replace(/^(?:(?:uncaught\s+(?:exception:\s+)?)?error:\s+)+/i,"")+".":": unknown error."),a&&a.stack&&(i+="\n\nStack Trace:\n"+a.stack),window.alert(i)}function t(t,r,a){e(null,t,r,a)}function r(t,r,a){e("fatal",t,r,a)}return function(e){window.onerror=function(a,n,i,o,s){"complete"===document.readyState?t(null,a,s):(r(null,a,s),window.onerror=e,"function"==typeof window.onerror&&window.onerror.apply(this,arguments))}}(window.onerror),Object.freeze(Object.defineProperties({},{error:{value:t},fatal:{value:r}}))}();!function(){Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");if(0===arguments.length)return!1;var e=this.length>>>0;if(0===e)return!1;var t=arguments[0],r=Number(arguments[1])||0;for(r<0&&(r=Math.max(0,e+r));r<e;++r){var a=this[r];if(t===a||t!==t&&a!==a)return!0}return!1}}),String.prototype.trimLeft||Object.defineProperty(String.prototype,"trimLeft",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimLeft called on null or undefined");return this.replace(/^[\s\uFEFF\u00A0]+/,"")}}),String.prototype.trimStart||Object.defineProperty(String.prototype,"trimStart",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimStart called on null or undefined");return this.trimLeft()}}),String.prototype.trimRight||Object.defineProperty(String.prototype,"trimRight",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimRight called on null or undefined");return this.replace(/[\s\uFEFF\u00A0]+$/,"")}}),String.prototype.trimEnd||Object.defineProperty(String.prototype,"trimEnd",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimEnd called on null or undefined");return this.trimRight()}})}(),function(){function _random(){if(0===arguments.length)throw new Error("_random called with insufficient parameters");var e=void 0,t=void 0;if(1===arguments.length?(e=0,t=arguments[0]):(e=arguments[0],t=arguments[1]),e>t){var r=[t,e];e=r[0],t=r[1]}return Math.floor(_nativeMathRandom()*(t-e+1))+e}function _getCodePointStartAndEnd(e,t){var r=e.charCodeAt(t);if(Number.isNaN(r))return{char:"",start:-1,end:-1};if(r<55296||r>57343)return{char:e.charAt(t),start:t,end:t};if(r>=55296&&r<=56319){var a=t+1;if(a>=e.length)throw new Error("high surrogate without trailing low surrogate");var n=e.charCodeAt(a);if(n<56320||n>57343)throw new Error("high surrogate without trailing low surrogate");return{char:e.charAt(t)+e.charAt(a),start:t,end:a}}if(0===t)throw new Error("low surrogate without leading high surrogate");var i=t-1,o=e.charCodeAt(i);if(o<55296||o>56319)throw new Error("low surrogate without leading high surrogate");return{char:e.charAt(i)+e.charAt(t),start:i,end:t}}var _nativeMathRandom=Math.random;Object.defineProperty(Array,"random",{configurable:!0,writable:!0,value:function(e,t,r){var a=t,n=r;return 2===arguments.length&&(n=a,a=0),Array.isArray(e)?e.random(a,n):e.hasOwnProperty("length")?[].concat(_toConsumableArray(e)).random(a,n):void 0}}),Object.defineProperty(Array.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.count called on null or undefined");for(var e=Array.prototype.indexOf,t=arguments[0],r=Number(arguments[1])||0,a=0;(r=e.call(this,t,r))!==-1;)++a,++r;return a}}),Object.defineProperty(Array.prototype,"delete",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.delete called on null or undefined");if(0===arguments.length)return[];var e=this.length>>>0;if(0===e)return[];for(var t=Array.prototype.indexOf,r=Array.prototype.push,a=Array.prototype.splice,n=Array.prototype.concat.apply([],arguments),i=[],o=0,s=n.length;o<s;++o)for(var u=n[o],l=0;(l=t.call(this,u,l))!==-1;)r.apply(i,a.call(this,l,1));return i}}),Object.defineProperty(Array.prototype,"deleteAt",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.deleteAt called on null or undefined");if(0===arguments.length)return[];var e=this.length>>>0;if(0===e)return[];for(var t=Array.prototype.splice,r=[].concat(_toConsumableArray(new Set(Array.prototype.concat.apply([],arguments).map(function(t){return t<0?Math.max(0,e+t):t})).values())),a=[].concat(_toConsumableArray(r)).sort(function(e,t){return t-e}),n=[],i=0,o=r.length;i<o;++i)n[i]=this[r[i]];for(var s=0,u=a.length;s<u;++s)t.call(this,a[s],1);return n}}),Object.defineProperty(Array.prototype,"flatten",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatten called on null or undefined");return Array.prototype.reduce.call(this,function(e,t){return e.concat(Array.isArray(t)?t.flatten():t)},[])}}),Object.defineProperty(Array.prototype,"includesAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAll called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAll.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var e=0,t=arguments.length;e<t;++e)if(!Array.prototype.some.call(this,function(e){return e===this.val||e!==e&&this.val!==this.val},{val:arguments[e]}))return!1;return!0}}),Object.defineProperty(Array.prototype,"includesAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAny called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAny.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var e=0,t=arguments.length;e<t;++e)if(Array.prototype.some.call(this,function(e){return e===this.val||e!==e&&this.val!==this.val},{val:arguments[e]}))return!0;return!1}}),Object.defineProperty(Array.prototype,"pluck",{configurable:!0,writable:!0,value:function(e,t){if(null==this)throw new TypeError("Array.prototype.pluck called on null or undefined");var r=this.length>>>0;if(0!==r){var a=e,n=t;return 1===arguments.length&&(n=a,a=0),null==a?a=0:a<0?(a=r+a,a<0&&(a=0)):a>=r&&(a=r-1),null==n?n=r-1:n<0?(n=r+n,n<0&&(n=r-1)):n>=r&&(n=r-1),Array.prototype.splice.call(this,_random(a,n),1)[0]}}}),Object.defineProperty(Array.prototype,"random",{configurable:!0,writable:!0,value:function(e,t){if(null==this)throw new TypeError("Array.prototype.random called on null or undefined");var r=this.length>>>0;if(0!==r){var a=e,n=t;return 1===arguments.length&&(n=a,a=0),null==a?a=0:a<0?(a=r+a,a<0&&(a=0)):a>=r&&(a=r-1),null==n?n=r-1:n<0?(n=r+n,n<0&&(n=r-1)):n>=r&&(n=r-1),this[_random(a,n)]}}}),Object.defineProperty(Array.prototype,"shuffle",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.shuffle called on null or undefined");var e=this.length>>>0;if(0!==e){for(var t=e-1;t>0;--t){var r=Math.floor(_nativeMathRandom()*(t+1)),a=this[t];this[t]=this[r],this[r]=a}return this}}}),Object.defineProperty(Function.prototype,"partial",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Function.prototype.partial called on null or undefined");var e=Array.prototype.slice,t=this,r=e.call(arguments,0);return function(){for(var a=[],n=0,i=0;i<r.length;++i)a.push(r[i]===undefined?arguments[n++]:r[i]);return t.apply(this,a.concat(e.call(arguments,n)))}}}),Object.defineProperty(Math,"clamp",{configurable:!0,writable:!0,value:function e(t,r,a){var e=Number(t);return Number.isNaN(e)?NaN:e.clamp(r,a)}}),Object.defineProperty(Math,"easeInOut",{configurable:!0,writable:!0,value:function(e){return 1-(Math.cos(Number(e)*Math.PI)+1)/2}}),Object.defineProperty(Number.prototype,"clamp",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Number.prototype.clamp called on null or undefined");if(2!==arguments.length)throw new Error("Number.prototype.clamp called with an incorrect number of parameters");var e=Number(arguments[0]),t=Number(arguments[1]);if(e>t){var r=[t,e];e=r[0],t=r[1]}return Math.min(Math.max(this,e),t)}}),RegExp.escape||!function(){var e=/[\\^$*+?.()|[\]{}]/g,t=new RegExp(e.source);Object.defineProperty(RegExp,"escape",{configurable:!0,writable:!0,value:function(r){var a=String(r);return a&&t.test(a)?a.replace(e,"\\$&"):a}})}(),function(){var e=/{(\d+)(?:,([+-]?\d+))?}/g,t=new RegExp(e.source);Object.defineProperty(String,"format",{configurable:!0,writable:!0,value:function(r){function a(e,t,r){if(!t)return e;var a=Math.abs(t)-e.length;if(a<1)return e;var n=String(r).repeat(a);return t<0?e+n:n+e}if(arguments.length<2)return 0===arguments.length?"":r;var n=2===arguments.length&&Array.isArray(arguments[1])?[].concat(_toConsumableArray(arguments[1])):Array.prototype.slice.call(arguments,1);return 0===n.length?r:t.test(r)?(e.lastIndex=0,r.replace(e,function(e,t,r){var i=n[t];if(null==i)return"";for(;"function"==typeof i;)i=i();switch("undefined"==typeof i?"undefined":_typeof(i)){case"string":break;case"object":i=JSON.stringify(i);break;default:i=String(i)}return a(i,r?Number.parseInt(r,10):0," ")})):r}})}(),Object.defineProperty(String.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.contains called on null or undefined");return String.prototype.indexOf.apply(this,arguments)!==-1}}),Object.defineProperty(String.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.count called on null or undefined");var e=String(arguments[0]||"");if(""===e)return 0;for(var t=String.prototype.indexOf,r=e.length,a=Number(arguments[1])||0,n=0;(a=t.call(this,e,a))!==-1;)++n,a+=r;return n}}),Object.defineProperty(String.prototype,"splice",{configurable:!0,writable:!0,value:function(e,t,r){if(null==this)throw new TypeError("String.prototype.splice called on null or undefined");var a=this.length>>>0;if(0===a)return"";var n=Number(e);Number.isSafeInteger(n)?n<0&&(n+=a,n<0&&(n=0)):n=0,n>a&&(n=a);var i=Number(t);(!Number.isSafeInteger(i)||i<0)&&(i=0);var o=this.slice(0,n);return"undefined"!=typeof r&&(o+=r),n+i<a&&(o+=this.slice(n+i)),o}}),Object.defineProperty(String.prototype,"splitOrEmpty",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.splitOrEmpty called on null or undefined");return""===String(this)?[]:String.prototype.split.apply(this,arguments)}}),Object.defineProperty(String.prototype,"toLocaleUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toLocaleUpperFirst called on null or undefined");var e=String(this),t=_getCodePointStartAndEnd(e,0),r=t.char,a=t.end;return a===-1?"":r.toLocaleUpperCase()+e.slice(a+1)}}),Object.defineProperty(String.prototype,"toUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toUpperFirst called on null or undefined");var e=String(this),t=_getCodePointStartAndEnd(e,0),r=t.char,a=t.end;return a===-1?"":r.toUpperCase()+e.slice(a+1)}}),Object.defineProperty(Date.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:date)",this.toISOString()]}}),Object.defineProperty(Function.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)","("+this.toString()+")"]}}),Object.defineProperty(Map.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:map)",[].concat(_toConsumableArray(this))]}}),Object.defineProperty(RegExp.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)",this.toString()]}}),Object.defineProperty(Set.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:set)",[].concat(_toConsumableArray(this))]}}),Object.defineProperty(JSON,"reviveWrapper",{configurable:!0,writable:!0,value:function(e,t){if("string"!=typeof e)throw new TypeError("JSON.reviveWrapper code parameter must be a string");return["(revive:eval)",[e,t]]}}),Object.defineProperty(JSON,"_real_parse",{value:JSON.parse}),Object.defineProperty(JSON,"parse",{configurable:!0,writable:!0,value:function value(text,reviver){return JSON._real_parse(text,function(key,val){var value=val;if(Array.isArray(value)&&2===value.length)switch(value[0]){case"(revive:set)":value=new Set(value[1]);break;case"(revive:map)":value=new Map(value[1]);break;case"(revive:date)":value=new Date(value[1]);break;case"(revive:eval)":try{if(Array.isArray(value[1])){var $ReviveData$=value[1][1];value=eval(value[1][0])}else value=eval(value[1])}catch(e){}}else if("string"==typeof value&&"@@revive@@"===value.slice(0,10))try{value=eval(value.slice(10))}catch(e){}if("function"==typeof reviver)try{value=reviver(key,value)}catch(e){}return value})}}),Object.defineProperty(Array.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.contains called on null or undefined");return Array.prototype.includes.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAll called on null or undefined");return Array.prototype.includesAll.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAny called on null or undefined");return Array.prototype.includesAny.apply(this,arguments)}}),Object.defineProperty(String.prototype,"readBracketedList",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.readBracketedList called on null or undefined");for(var e=new RegExp("(?:\\[\\[((?:\\s|\\S)*?)\\]\\])|([^\"'\\s]\\S*)","gm"),t=[],r=void 0;null!==(r=e.exec(this));)r[1]?t.push(r[1]):r[2]&&t.push(r[2]);return t}})}(),function(){function e(e){13!==e.which&&32!==e.which||(e.preventDefault(),jQuery(safeActiveElement()||this).trigger("click"))}function t(e){return function(){var t=jQuery(this);t.is("[aria-pressed]")&&t.attr("aria-pressed","true"===t.attr("aria-pressed")?"false":"true"),e.apply(this,arguments)}}function r(e){return t(function(){jQuery(this).off(".aria-clickable").removeAttr("tabindex aria-controls aria-pressed").not("a,button").removeAttr("role").end().filter("button").prop("disabled",!0),e.apply(this,arguments)})}jQuery.fn.extend({ariaClick:function(a,n){if(0===this.length||0===arguments.length)return this;var i=a,o=n;return null==o&&(o=i,i=undefined),i=jQuery.extend({namespace:undefined,one:!1,selector:undefined,data:undefined,controls:undefined,pressed:undefined,label:undefined},i),"string"!=typeof i.namespace?i.namespace="":"."!==i.namespace[0]&&(i.namespace="."+i.namespace),"boolean"==typeof i.pressed&&(i.pressed=i.pressed?"true":"false"),this.filter("button").prop("type","button"),this.not("a,button").attr("role","button"),this.attr("tabindex",0),null!=i.controls&&this.attr("aria-controls",i.controls),null!=i.pressed&&this.attr("aria-pressed",i.pressed),null!=i.label&&this.attr({"aria-label":i.label,title:i.label}),this.not("button").on("keypress.aria-clickable"+i.namespace,i.selector,e),this.on("click.aria-clickable"+i.namespace,i.selector,i.data,i.one?r(o):t(o)),this}})}(),function(){jQuery.fn.extend({wiki:function(){if(0===this.length||0===arguments.length)return this;var e=document.createDocumentFragment();return Array.from(arguments).forEach(function(t){return new Wikifier(e,t)}),this.append(e),this}})}();var Browser=function(){var e={userAgent:navigator.userAgent.toLowerCase()};return e.isGecko=navigator&&"Gecko"===navigator.product&&!/webkit|trident/.test(e.userAgent),e.isIE=/msie|trident/.test(e.userAgent)&&!e.userAgent.includes("opera"),e.ieVersion=function(){var t=/(?:msie\s+|rv:)(\d{1,2}\.\d)/.exec(e.userAgent);return t?Number([1]):0}(),e.isOpera=e.userAgent.includes("opera")||e.userAgent.includes(" opr/"),e.operaVersion=function(){var t=new RegExp((/applewebkit|chrome/.test(e.userAgent)?"opr":"version")+"\\/(\\d{1,2}\\.\\d+)"),r=t.exec(e.userAgent);return r?Number(r[1]):0}(),e.isMobile=Object.freeze({Android:/android/.test(e.userAgent),BlackBerry:/blackberry/.test(e.userAgent),iOS:/ip(?:hone|ad|od)/.test(e.userAgent),Windows:/iemobile/.test(e.userAgent),any:function(){var t=e.isMobile;return t.Android||t.BlackBerry||t.iOS||t.Windows}}),Object.freeze(e)}(),Has=function(){function e(e){try{if(null!=e&&e.length>=0){var t="SugarCube.WebStorage.test",r="1701 Guilty Scott";if(e.setItem(t,r),e.getItem(t)===r)return e.removeItem(t),!0}}catch(e){}return!1}return Object.freeze({audio:"function"==typeof document.createElement("audio").canPlayType,fileAPI:"File"in window&&"FileList"in window&&"FileReader"in window&&!Browser.isMobile.any()&&(!Browser.isOpera||Browser.operaVersion>=15),geolocation:"geolocation"in navigator&&"function"==typeof navigator.geolocation.getCurrentPosition&&"function"==typeof navigator.geolocation.watchPosition,localStorage:"localStorage"in window&&e(window.localStorage),sessionStorage:"sessionStorage"in window&&e(window.sessionStorage)})}(),_ref3=function(){function e(e){var t=document.getElementById("style-story");null===t&&(t=document.createElement("style"),t.id="style-story",t.type="text/css",document.head.appendChild(t)),t=new StyleWrapper(t),t.add(e)}function t(e){if("object"!==("undefined"==typeof e?"undefined":_typeof(e))||null==e)return e;if("function"==typeof e.clone)return e.clone(!0);if(e.nodeType&&"function"==typeof e.cloneNode)return e.cloneNode(!0);var r=void 0;return Array.isArray(e)?r=[]:e instanceof Date?r=new Date(e.getTime()):e instanceof Map?(r=new Map,e.forEach(function(e,a){r.set(a,t(e))})):e instanceof RegExp?r=new RegExp(e):e instanceof Set?(r=new Set,e.forEach(function(e){r.add(t(e))})):r=Object.create(Object.getPrototypeOf(e)),Object.keys(e).forEach(function(a){return r[a]=t(e[a])}),r}function r(e){for(var t=document.createDocumentFragment(),r=document.createElement("p"),a=void 0;null!==(a=e.firstChild);){if(a.nodeType===Node.ELEMENT_NODE){var n=a.nodeName.toUpperCase();switch(n){case"BR":if(null!==a.nextSibling&&a.nextSibling.nodeType===Node.ELEMENT_NODE&&"BR"===a.nextSibling.nodeName.toUpperCase()){e.removeChild(a.nextSibling),e.removeChild(a),t.appendChild(r),r=document.createElement("p");continue}if(!r.hasChildNodes()){e.removeChild(a);continue}break;case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":r.hasChildNodes()&&(t.appendChild(r),r=document.createElement("p")),t.appendChild(a);continue}}r.appendChild(a)}r.hasChildNodes()&&t.appendChild(r),e.appendChild(t)}function a(e,t,r){var a="object"===("undefined"==typeof e?"undefined":_typeof(e))?e:document.getElementById(e);if(null==a)return null;var n=Array.isArray(t)?t:[t];jQuery(a).empty();for(var i=0,o=n.length;i<o;++i)if(Story.has(n[i]))return new Wikifier(a,Story.get(n[i]).processText().trim()),a;if(null!=r){var s=String(r).trim();""!==s&&new Wikifier(a,s)}return a}function n(e,t,r){return jQuery(document.createElement("span")).addClass("error").attr("title",r).text(L10n.get("errorTitle")+": "+(t||"unknown error")).appendTo(e),!1}function i(e,t){switch("undefined"==typeof e?"undefined":_typeof(e)){case"number":if(Number.isNaN(e))return t;break;case"object":if(null===e)return t;if(Array.isArray(e)||e instanceof Set)return[].concat(_toConsumableArray(e)).map(function(e){return i(e,t)}).join(", ");if(e instanceof Map){var r=function(){var r=i,a=[].concat(_toConsumableArray(e)).map(function(e){return r(e[0],t)+" ⇒ "+r(e[1],t)}).join("; ");return{v:"( "+a+" )"}}();if("object"===("undefined"==typeof r?"undefined":_typeof(r)))return r.v}else{if(e instanceof Date)return e.toLocaleString();if("function"==typeof e.toString)return e.toString()}return Object.prototype.toString.call(e);case"function":case"undefined":return t}return String(e)}return Object.freeze(Object.defineProperties({},{addStyle:{value:e},clone:{value:t},convertBreaks:{value:r},setPageElement:{value:a},throwError:{value:n},toStringOrDefault:{value:i}}))}(),addStyle=_ref3.addStyle,clone=_ref3.clone,convertBreaks=_ref3.convertBreaks,setPageElement=_ref3.setPageElement,throwError=_ref3.throwError,toStringOrDefault=_ref3.toStringOrDefault,Util=function(){function e(e){var t=void 0;switch("undefined"==typeof e?"undefined":_typeof(e)){case"number":t=e;break;case"string":t=Number(e);break;default:return!1}return!Number.isNaN(t)&&Number.isFinite(t)}function t(e){return"boolean"==typeof e||"string"==typeof e&&("true"===e||"false"===e)}function r(e){return String(e).trim().replace(/[^\w\s\u2013\u2014-]+/g,"").replace(/[_\s\u2013\u2014-]+/g,"-").toLocaleLowerCase()}function a(e){if(null==e)return"";var t=String(e);return t&&h.test(t)?t.replace(d,function(e){return p[e]}):t}function n(e){if(null==e)return"";var t=String(e);return t&&g.test(t)?t.replace(f,function(e){return m[e]}):t}function i(e){var t=/^([+-]?(?:\d*\.)?\d+)([Mm]?[Ss])$/,r=t.exec(String(e));if(null===r)throw new SyntaxError('invalid time value syntax: "'+e+'"');var a=Number(r[1]);if(/^[Ss]$/.test(r[2])&&(a*=1e3),Number.isNaN(a)||!Number.isFinite(a))throw new RangeError('invalid time value: "'+e+'"');return a}function o(e){if("number"!=typeof e||Number.isNaN(e)||!Number.isFinite(e)){var t=void 0;switch("undefined"==typeof e?"undefined":_typeof(e)){case"string":t='"'+e+'"';break;case"number":t=String(e);break;default:t=Object.prototype.toString.call(e)}throw new Error("invalid milliseconds: "+t)}return e+"ms"}function s(e){if(!e.includes("-"))switch(e){case"bgcolor":return"backgroundColor";case"float":return"cssFloat";default:return e}var t="-ms-"===e.slice(0,4)?e.slice(1):e;return t.split("-").map(function(e,t){return 0===t?e:e.toUpperFirst()}).join("")}function u(e){var t=document.createElement("a"),r=Object.create(null);t.href=e,t.search&&t.search.replace(/^\?/,"").splitOrEmpty(/(?:&(?:amp;)?|;)/).forEach(function(e){var t=e.split("="),a=_slicedToArray(t,2),n=a[0],i=a[1];r[n]=i});var a=t.host&&"/"!==t.pathname[0]?"/"+t.pathname:t.pathname;return{href:t.href,protocol:t.protocol,host:t.host,hostname:t.hostname,port:t.port,path:""+a+t.search,pathname:a,query:t.search,search:t.search,queries:r,searches:r,hash:t.hash}}function l(e,t){for(var r=Object.prototype.toString,a=Array.isArray(e),n=[].concat(Object.keys(e),Object.keys(t)).sort().filter(function(e,t,r){return 0===t||r[t-1]!==e}),i={},o=void 0,s=function(e){return e===o},u=0,l=n.length;u<l;++u){var c=n[u],d=e[c],h=t[c];if(e.hasOwnProperty(c))if(t.hasOwnProperty(c)){if(d===h)continue;if(("undefined"==typeof d?"undefined":_typeof(d))===("undefined"==typeof h?"undefined":_typeof(h)))if("function"==typeof d)d.toString()!==h.toString()&&(i[c]=[v.Copy,h]);else if("object"!==("undefined"==typeof d?"undefined":_typeof(d))||null===d)i[c]=[v.Copy,h];else{var p=r.call(d),f=r.call(h);if(p===f)if("[object Date]"===p){var g=Number(h);Number(d)!==g&&(i[c]=[v.CopyDate,g])}else if("[object RegExp]"===p)d.toString()!==h.toString()&&(i[c]=[v.Copy,clone(h)]);else{var m=Util.diff(d,h);null!==m&&(i[c]=m)}else i[c]=[v.Copy,clone(h)]}else i[c]=[v.Copy,"object"!==("undefined"==typeof h?"undefined":_typeof(h))||null===h?h:clone(h)]}else if(a&&Util.isNumeric(c)){var y=Number(c);if(!o){o="";do o+="~";while(n.some(s));i[o]=[v.SpliceArray,y,y]}y<i[o][1]&&(i[o][1]=y),y>i[o][2]&&(i[o][2]=y)}else i[c]=v.Delete;else i[c]=[v.Copy,"object"!==("undefined"==typeof h?"undefined":_typeof(h))||null===h?h:clone(h)]}return Object.keys(i).length>0?i:null}function c(e,t){for(var r=Object.keys(t||{}),a=clone(e),n=0,i=r.length;n<i;++n){var o=r[n],s=t[o];if(s===v.Delete)delete a[o];else if(Array.isArray(s))switch(s[0]){case v.SpliceArray:a.splice(s[1],1+(s[2]-s[1]));break;case v.Copy:a[o]=clone(s[1]);break;case v.CopyDate:a[o]=new Date(s[1])}else a[o]=Util.patch(a[o],s)}return a}var d=/[&<>"'`]/g,h=new RegExp(d.source),p=Object.freeze({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"}),f=/&(?:amp|lt|gt|quot|apos|#39|#x27|#96|#x60);/g,g=new RegExp(f.source),m=Object.freeze({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&#39;":"'","&#x27;":"'","&#96;":"`","&#x60;":"`"}),v=Object.freeze({Delete:0,SpliceArray:1,Copy:2,CopyDate:3});return Object.freeze(Object.defineProperties({},{isNumeric:{value:e},isBoolean:{value:t},slugify:{value:r},escape:{value:a},unescape:{value:n},fromCssTime:{value:i},toCssTime:{value:o},fromCssProperty:{value:s},parseUrl:{value:u},DiffOp:{value:v},diff:{value:l},patch:{value:c},random:{value:Math.random},entityEncode:{value:a},entityDecode:{value:n},evalExpression:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),SimpleAudio=function(){function e(){return g}function t(e){g=!!e,l("mute",g)}function r(){return p}function a(e){p=Math.clamp(e,.2,5),l("rate",p)}function n(){return f}function i(e){f=Math.clamp(e,0,1),l("volume",f)}function o(){l("stop")}function s(e,t){if("function"!=typeof t)throw new Error("callback parameter must be a function");h.set(e,t)}function u(e){h.delete(e)}function l(e,t){h.forEach(function(r){return r(e,t)})}function c(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(m,[null].concat(t)))}function d(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(v,[null].concat(t)))}var h=new Map,p=1,f=1,g=!1,m=function(){function e(t){if(_classCallCheck(this,e),Array.isArray(t))this._create(t);else{if(!(t instanceof e))throw new Error("sources parameter must be an array of either URLs or source objects");this._copy(t)}}return _createClass(e,[{key:"_create",value:function(t){if(!Array.isArray(t)||0===t.length)throw new Error("sources parameter must be an array of either URLs or source objects");var r=/^data:\s*audio\/([^;,]+)\s*[;,]/i,a=/\.([^\.\/\\]+)$/,n=e.getType,i=[],o=document.createElement("audio");t.forEach(function(e){var t=null;switch("undefined"==typeof e?"undefined":_typeof(e)){case"string":var s=void 0;if("data:"===e.slice(0,5)){if(s=r.exec(e),null===s)throw new Error("source data URI missing media type")}else if(s=a.exec(Util.parseUrl(e).pathname),null===s)throw new Error("source URL missing file extension");var u=n(s[1]);null!==u&&(t={src:e,type:u});break;case"object":if(null===e)throw new Error("source object cannot be null");if(!e.hasOwnProperty("src"))throw new Error('source object missing required "src" property');if(!e.hasOwnProperty("format"))throw new Error('source object missing required "format" property');var l=n(e.format);null!==l&&(t={src:e.src,type:l});break;default:throw new Error("invalid source value (type: "+("undefined"==typeof e?"undefined":_typeof(e))+")")}if(null!==t){var c=document.createElement("source");c.src=t.src,c.type=t.type,o.appendChild(c),i.push(t)}}),this._finalize(o,i,clone(t))}},{key:"_copy",value:function(t){if(!(t instanceof e))throw new Error("original parameter must be an instance of AudioWrapper");this._finalize(t.audio.cloneNode(!0),clone(t.sources),clone(t.originalSources))}},{key:"_finalize",value:function(e,t,r){var a=this;Object.defineProperties(this,{audio:{configurable:!0,value:e},sources:{configurable:!0,value:Object.freeze(t)},originalSources:{configurable:!0,value:Object.freeze(r)},_error:{writable:!0,value:!1},_faderId:{writable:!0,value:null},_mute:{writable:!0,value:!1},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1}}),jQuery(this.audio).on("loadstart",function(){return a._error=!1}).find("source:last-of-type").on("error",function(){a._error=!0,a._trigger("error")}),SimpleAudio.subscribe(this,function(e){switch(e){case"mute":a._updateAudioMute();break;case"rate":a._updateAudioRate();break;case"stop":a.stop();break;case"volume":a._updateAudioVolume()}}),this.load()}},{key:"_trigger",value:function(e){jQuery(this.audio).triggerHandler(e)}},{key:"clone",value:function(){return new e(this)}},{key:"destroy",value:function(){null!==this._faderId&&(clearInterval(this._faderId),this._faderId=null),this.stop();var e=this.audio;for(jQuery(e).off();e.hasChildNodes();)e.removeChild(e.firstChild);e.load(),this._error=!0,delete this.audio,delete this.sources,delete this.originalSources}},{key:"_updateAudioMute",value:function(){this.audio.muted=this._mute||SimpleAudio.mute}},{key:"_updateAudioRate",value:function(){this.audio.playbackRate=this._rate*SimpleAudio.rate}},{key:"_updateAudioVolume",value:function(){this.audio.volume=this._volume*SimpleAudio.volume}},{key:"hasSource",value:function(){return this.sources.length>0}},{key:"hasNoData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_NOTHING}},{key:"hasMetadata",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_METADATA}},{key:"hasSomeData",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA}},{key:"hasData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA}},{key:"isFailed",value:function(){return this._error}},{key:"isLoading",value:function(){return this.audio.networkState===HTMLMediaElement.NETWORK_LOADING}},{key:"isPlaying",value:function(){return!(this.audio.ended||this.audio.paused||!this.hasSomeData())}},{key:"isEnded",value:function(){return this.audio.ended}},{key:"isPaused",value:function(){return this.audio.paused&&(this.audio.duration===1/0||this.audio.currentTime>0)&&!this.audio.ended}},{key:"isMuted",value:function(){return this._mute}},{key:"isLooped",value:function(){return this.audio.loop}},{key:"load",value:function(){"auto"!==this.audio.preload&&(this.audio.preload="auto"),this.isLoading()||this.audio.load()}},{key:"play",value:function(){this.hasData()||this.load(),this.audio.play()}},{key:"pause",value:function(){this.audio.pause()}},{key:"stop",value:function(){this.audio.pause(),this.time=0,this._trigger("aw:stop")}},{key:"fadeWithDuration",value:function(e,t,r){var a=this;null!==this._faderId&&(clearInterval(this._faderId),this._faderId=null);var n=Math.clamp(null==r?this.volume:r,0,1),i=Math.clamp(t,0,1);
n!==i&&(this.volume=n,jQuery(this.audio).off("timeupdate.AudioWrapper:fadeWithDuration").one("timeupdate.AudioWrapper:fadeWithDuration",function(){var t=void 0,r=void 0;n<i?(t=n,r=i):(t=i,r=n);var o=Math.clamp(e,1,a.remaining),s=25,u=(i-n)/(o/(s/1e3));a._faderId=setInterval(function(){return a.isPlaying()?(a.volume=Math.clamp(a.volume+u,t,r),0===a.volume&&a.pause(),void(a.volume===i&&(clearInterval(a._faderId),a._faderId=null,a._trigger("aw:fade")))):(clearInterval(a._faderId),void(a._faderId=null))},s)}),this.play())}},{key:"fade",value:function(e,t){this.fadeWithDuration(5,e,t)}},{key:"fadeIn",value:function(){this.fade(1)}},{key:"fadeOut",value:function(){this.fade(0)}},{key:"on",value:function(t,r){if("function"!=typeof r)throw new Error("listener parameter must be a function");var a=e._events,n=t.trim().splitOrEmpty(/\s+/).map(function(e){var t=e.split(".",1)[0];if(!a.hasOwnProperty(t))throw new Error('unknown event "'+t+'"; valid: '+Object.keys(a).join(", "));return e.replace(t,a[t])+".AudioWrapperEvent"}).join(" ");if(""===n)throw new Error('invalid eventNames parameter "'+t+'"');return jQuery(this.audio).on(n,r),this}},{key:"one",value:function(t,r){if("function"!=typeof r)throw new Error("listener parameter must be a function");var a=e._events,n=t.trim().splitOrEmpty(/\s+/).map(function(e){var t=e.split(".",1)[0];if(!a.hasOwnProperty(t))throw new Error('unknown event "'+t+'"; valid: '+Object.keys(a).join(", "));return e.replace(t,a[t])+".AudioWrapperEvent"}).join(" ");if(""===n)throw new Error('invalid eventNames parameter "'+t+'"');return jQuery(this.audio).one(n,r),this}},{key:"off",value:function(t,r){if(r&&"function"!=typeof r)throw new Error("listener parameter must be a function");if(!t)return jQuery(this.audio).off(".AudioWrapperEvent",r);var a=e._events,n=t.trim().splitOrEmpty(/\s+/).map(function(e){var t=e.split(".",1)[0];if(t){if(!a.hasOwnProperty(t))throw new Error('unknown event "'+t+'"; valid: '+Object.keys(a).join(", "));return e.replace(t,a[t])+".AudioWrapperEvent"}return e+".AudioWrapperEvent"}).join(" ");if(""===n)throw new Error('invalid eventNames parameter "'+t+'"');return jQuery(this.audio).off(n,r),this}},{key:"duration",get:function(){return this.audio.duration}},{key:"ended",get:function(){return this.audio.ended}},{key:"loop",get:function(){return this.audio.loop},set:function(e){this.audio.loop=!!e}},{key:"mute",get:function(){return this._mute},set:function(e){this._mute=!!e,this._updateAudioMute()}},{key:"paused",get:function(){return this.audio.paused}},{key:"rate",get:function(){return this._rate},set:function(e){this._rate=Math.clamp(e,.2,5),this._updateAudioRate()}},{key:"remaining",get:function(){return this.audio.duration-this.audio.currentTime}},{key:"time",get:function(){return this.audio.currentTime},set:function(e){var t=this;try{this.audio.currentTime=e}catch(r){jQuery(this.audio).off("loadedmetadata.AudioWrapper:time").one("loadedmetadata.AudioWrapper:time",function(){return t.audio.currentTime=e})}}},{key:"volume",get:function(){return this._volume},set:function(e){this._volume=Math.clamp(e,0,1),this._updateAudioVolume()}}],[{key:"_verifyType",value:function(t){if(!t||!Has.audio)return null;var r=e._types;if(!r.hasOwnProperty(t)){var a=document.createElement("audio");r[t]=""!==a.canPlayType(t).replace(/^no$/i,"")}return r[t]?t:null}},{key:"getType",value:function(t){if(!t||!Has.audio)return null;var r=e.formats,a=t.toLowerCase(),n=r.hasOwnProperty(a)?r[a]:"audio/"+a;return e._verifyType(n)}},{key:"canPlayFormat",value:function(t){return null!==e.getType(t)}},{key:"canPlayType",value:function(t){return null!==e._verifyType(t)}}]),e}();Object.defineProperties(m,{formats:{value:{aac:"audio/aac",caf:"audio/x-caf","x-caf":"audio/x-caf",mp3:'audio/mpeg; codecs="mp3"',mpeg:'audio/mpeg; codecs="mp3"',m4a:"audio/mp4",mp4:"audio/mp4","x-m4a":"audio/mp4","x-mp4":"audio/mp4",oga:"audio/ogg",ogg:"audio/ogg",opus:'audio/ogg; codecs="opus"',wav:"audio/wav",wave:"audio/wav",weba:"audio/webm",webm:"audio/webm"}},_types:{value:{}},_events:{value:Object.freeze({canplay:"canplaythrough",end:"ended",error:"error",fade:"aw:fade",pause:"pause",play:"playing",rate:"ratechange",seek:"seeked",stop:"aw:stop",volume:"volumechange"})}});var v=function(){function e(t){var r=this;_classCallCheck(this,e),Object.defineProperties(this,{tracks:{configurable:!0,value:[]},queue:{configurable:!0,value:[]},current:{writable:!0,value:null},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1},_mute:{writable:!0,value:!1},_loop:{writable:!0,value:!1},_shuffle:{writable:!0,value:!1}}),Array.isArray(t)?t.forEach(function(e){return r.add(e)}):t instanceof e&&t.tracks.forEach(function(e){return r.add(e)})}return _createClass(e,[{key:"add",value:function(e){var t=this;if(null==e||"object"!==("undefined"==typeof e?"undefined":_typeof(e)))throw new Error("track parameter must be an object");var r=void 0,a=void 0,n=void 0,i=void 0;if(e instanceof m)r=!0,a=e.clone(),n=e.volume,i=e.rate;else{if(!e.hasOwnProperty("track"))throw new Error('track object missing required "track" property');if(!(e.track instanceof m))throw new Error('track object\'s "track" property must be an AudioWrapper object');r=e.hasOwnProperty("copy")&&e.copy,a=r?e.track.clone():e.track,n=e.hasOwnProperty("volume")?e.volume:e.track.volume,i=e.hasOwnProperty("rate")?e.rate:e.track.rate}a.stop(),a.loop=!1,a.mute=!1,a.volume=n,a.rate=i,a.on("end.AudioListEvent",function(){return t._onEnd()}),this.tracks.push({copy:r,track:a,volume:n,rate:i})}},{key:"destroy",value:function(){this.stop(),this.tracks.filter(function(e){return e.copy}).forEach(function(e){return e.track.destroy()}),delete this.tracks,delete this.queue}},{key:"isPlaying",value:function(){return null!==this.current&&this.current.track.isPlaying()}},{key:"isEnded",value:function(){return 0===this.queue.length&&(null===this.current||this.current.track.isEnded())}},{key:"isPaused",value:function(){return null===this.current||this.current.track.isPaused()}},{key:"isMuted",value:function(){return this._mute}},{key:"isLooped",value:function(){return this._loop}},{key:"isShuffled",value:function(){return this._shuffle}},{key:"play",value:function(){(null!==this.current&&!this.current.track.isEnded()||(0===this.queue.length&&this._buildList(),this._next()))&&this.current.track.play()}},{key:"pause",value:function(){null!==this.current&&this.current.track.pause()}},{key:"stop",value:function(){null!==this.current&&(this.current.track.stop(),this.current=null),this.queue.splice(0)}},{key:"skip",value:function(){this._next()?this.current.track.play():this._loop&&this.play()}},{key:"fadeWithDuration",value:function(e,t,r){if(0===this.queue.length&&this._buildList(),null!==this.current&&!this.current.track.isEnded()||this._next()){var a=Math.clamp(t,0,1)*this.current.volume,n=void 0;null!=r&&(n=Math.clamp(r,0,1)*this.current.volume),this.current.track.fadeWithDuration(e,a,n),this._volume=t}}},{key:"fade",value:function(e,t){this.fadeWithDuration(5,e,t)}},{key:"fadeIn",value:function(){this.fade(1)}},{key:"fadeOut",value:function(){this.fade(0)}},{key:"_next",value:function(){return null!==this.current&&this.current.track.stop(),0===this.queue.length?(this.current=null,!1):(this.current=this.queue.shift(),!this.current.track.hasSource()||this.current.track.isFailed()?this._next():(this.current.track.mute=this._mute,this.current.track.rate=this.rate*this.current.rate,this.current.track.volume=this.volume*this.current.volume,!0))}},{key:"_onEnd",value:function(){if(0===this.queue.length){if(!this._loop)return;this._buildList()}this._next()&&this.current.track.play()}},{key:"_buildList",value:function(){var e;this.queue.splice(0),(e=this.queue).push.apply(e,_toConsumableArray(this.tracks)),0!==this.queue.length&&this._shuffle&&(this.queue.shuffle(),this.queue.length>1&&this.queue[0]===this.current&&this.queue.push(this.queue.shift()))}},{key:"duration",get:function(){return this.tracks.map(function(e){return e.track.duration}).reduce(function(e,t){return e+t},0)}},{key:"loop",get:function(){return this._loop},set:function(e){this._loop=!!e}},{key:"mute",get:function(){return this._mute},set:function(e){this._mute=!!e,null!==this.current&&(this.current.track.mute=this._mute)}},{key:"rate",get:function(){return this._rate},set:function(e){this._rate=Math.clamp(e,.2,5),null!==this.current&&(this.current.track.rate=this.rate*this.current.rate)}},{key:"remaining",get:function(){var e=this.queue.map(function(e){return e.track.duration}).reduce(function(e,t){return e+t},0);return null!==this.current&&(e+=this.current.track.remaining),e}},{key:"shuffle",get:function(){return this._shuffle},set:function(e){this._shuffle=!!e}},{key:"time",get:function(){return this.duration-this.remaining}},{key:"volume",get:function(){return this._volume},set:function(e){this._volume=Math.clamp(e,0,1),null!==this.current&&(this.current.track.volume=this.volume*this.current.volume)}}]),e}();return Object.freeze(Object.defineProperties({},{mute:{get:e,set:t},rate:{get:r,set:a},volume:{get:n,set:i},stop:{value:o},subscribe:{value:s},unsubscribe:{value:u},publish:{value:l},create:{value:c},createList:{value:d}}))}(),DebugView=function(){var e=function(){function e(t,r,a,n){_classCallCheck(this,e),Object.defineProperties(this,{parent:{value:t},view:{value:document.createElement("span")},break:{value:document.createElement("wbr")}}),jQuery(this.view).attr({title:n,"aria-label":n,"data-type":null!=r?r:"","data-name":null!=a?a:""}).addClass("debug"),this.parent.appendChild(this.view),this.parent.appendChild(this.break)}return _createClass(e,[{key:"append",value:function(e){return jQuery(this.view).append(e),this}},{key:"modes",value:function(e){var t=this;if(null!=e){if("object"===("undefined"==typeof e?"undefined":_typeof(e)))return Object.keys(e).forEach(function(t){this[e[t]?"addClass":"removeClass"](t)},jQuery(this.view)),this;throw new Error("DebugView.prototype.modes options parameter must be an object or null/undefined")}var r=function(){var e={};return t.view.className.splitOrEmpty(/\s+/).forEach(function(t){"debug"!==t&&(e[t]=!0)}),{v:e}}();if("object"===("undefined"==typeof r?"undefined":_typeof(r)))return r.v}},{key:"remove",value:function(){var e=jQuery(this.view);this.view.hasChildNodes()&&e.contents().appendTo(this.parent),e.remove(),jQuery(this.break).remove()}},{key:"output",get:function(){return this.view}},{key:"type",get:function(){return this.view.getAttribute("data-type")},set:function(e){this.view.setAttribute("data-type",null!=e?e:"")}},{key:"name",get:function(){return this.view.getAttribute("data-name")},set:function(e){this.view.setAttribute("data-name",null!=e?e:"")}},{key:"title",get:function(){return this.view.title},set:function(e){this.view.title=e}}],[{key:"init",value:function(){jQuery('<button id="debug-view-toggle">'+L10n.get("debugViewTitle")+"</button>").ariaClick({label:L10n.get("debugViewToggle")},function(){return e.toggle()}).prependTo("#ui-bar-body"),e.enable()}},{key:"enable",value:function(){jQuery(document.documentElement).addClass("debug-view"),jQuery.event.trigger("tw:debugviewupdate")}},{key:"disable",value:function(){jQuery(document.documentElement).removeClass("debug-view"),jQuery.event.trigger("tw:debugviewupdate")}},{key:"toggle",value:function(){jQuery(document.documentElement).toggleClass("debug-view"),jQuery.event.trigger("tw:debugviewupdate")}}]),e}();return e}(),KeyValueStore=function(){var e=function(){function e(t,r){_classCallCheck(this,e);var a=r+".",n=null,i=null;t?Has.localStorage&&(n=window.localStorage,i="localStorage"):Has.sessionStorage&&(n=window.sessionStorage,i="sessionStorage"),Object.defineProperties(this,{_ok:{value:null!==n},_engine:{value:n},_prefix:{value:a},_prefixRe:{value:new RegExp("^"+RegExp.escape(a))},name:{value:i},id:{value:r},persist:{value:!!t}})}return _createClass(e,[{key:"keys",value:function e(){if(!this._ok)return[];for(var e=[],t=0;t<this._engine.length;++t){var r=this._engine.key(t);this._prefixRe.test(r)&&e.push(r.replace(this._prefixRe,""))}return e}},{key:"has",value:function(e){return!(!e||!this._ok)&&null!=this._engine.getItem(this._prefix+e)}},{key:"get",value:function(t){if(!t||!this._ok)return null;var r=this._engine.getItem(this._prefix+t);return null==r?null:e._deserialize(r)}},{key:"set",value:function(t,r){if(!t||!this._ok)return!1;try{this._engine.setItem(this._prefix+t,e._serialize(r))}catch(e){throw/quota_?(?:exceeded|reached)/i.test(e.name)&&(e.message=this.name+" quota exceeded"),e}return!0}},{key:"delete",value:function(e){return!(!e||!this._ok)&&(this._engine.removeItem(this._prefix+e),!0)}},{key:"length",get:function(){return this.keys().length}}],[{key:"_serialize",value:function(e){return LZString.compressToUTF16(JSON.stringify(e))}},{key:"_deserialize",value:function(e){return JSON.parse(LZString.decompressFromUTF16(e))}}]),e}(),t=function(){function e(t,r){_classCallCheck(this,e);var a=r+".";Object.defineProperties(this,{_ok:{value:"cookie"in document},_prefix:{value:a},_prefixRe:{value:new RegExp("^"+RegExp.escape(a))},name:{value:"cookie"},id:{value:r},persist:{value:!!t}})}return _createClass(e,[{key:"keys",value:function(){return this._ok?Object.keys(this._getAllCookies()):[]}},{key:"has",value:function(e){return!(!e||!this._ok)&&null!==this._getCookie(this._prefix+e)}},{key:"get",value:function(t){if(!t||!this._ok)return null;var r=this._getCookie(this._prefix+t);return null===r?null:e._deserialize(r)}},{key:"set",value:function(t,r){if(!t||!this._ok)return!1;try{if(this._setCookie(this._prefix+t,e._serialize(r),this.persist?"Tue, 19 Jan 2038 03:14:07 GMT":undefined),!this.has(t))throw new Error("unknown validation error")}catch(e){throw e.message="cookie error: "+e.message,e}return!0}},{key:"delete",value:function(e){if(!e||!this._ok||!this.has(e))return!1;try{if(this._setCookie(this._prefix+e,undefined,"Thu, 01 Jan 1970 00:00:00 GMT"),this.has(e))throw new Error("unknown validation error")}catch(e){throw e.message="cookie error: "+e.message,e}return!0}},{key:"_getAllCookies",value:function(){if(!this._ok||""===document.cookie)return{};for(var e=document.cookie.split(/;\s*/),t={},r=0;r<e.length;++r){var a=e[r].split("="),n=decodeURIComponent(a[0]);if(this._prefixRe.test(n)){var i=decodeURIComponent(a[1]);t[n]=i||null}}return t}},{key:"_getCookie",value:function(e){if(!e||!this._ok||""===document.cookie)return null;for(var t=document.cookie.split(/;\s*/),r=0;r<t.length;++r){var a=t[r].split("="),n=decodeURIComponent(a[0]);if(e===n){var i=decodeURIComponent(a[1]);return i||null}}return null}},{key:"_setCookie",value:function(e,t,r){if(e&&this._ok){var a=encodeURIComponent(e)+"=";null!=t&&(a+=encodeURIComponent(t)),null!=r&&(a+="; "+r),a+="; path=/",document.cookie=a}}},{key:"length",get:function(){return this.keys().length}}],[{key:"_serialize",value:function(e){return LZString.compressToBase64(JSON.stringify(e))}},{key:"_deserialize",value:function(e){return JSON.parse(LZString.decompressFromBase64(e))}}]),e}(),r=function(){function r(a,n,i){_classCallCheck(this,r);var o=null;switch(a){case"cookie":o=new t(n,i);break;case"webStorage":o=new e(n,i),o._ok||(o=new t(n,i));break;default:throw new Error("unknown driver type")}if(!o._ok)throw new Error("unknown driver error");Object.defineProperties(this,{_driver:{value:o},name:{value:o.name},type:{value:a},id:{value:i},persist:{value:n}})}return _createClass(r,[{key:"keys",value:function(){return null===this._driver?[]:this._driver.keys()}},{key:"clear",value:function(){if(null===this._driver)return!1;for(var e=this.keys(),t=0;t<e.length;++t)this.delete(e[t]);return!0}},{key:"has",value:function(e,t){if(null===this._driver||!e)return!1;try{return this._driver.has(e)}catch(r){return t||Alert.error(null,'unable to check key "'+e+'"; '+r.message,r),!1}}},{key:"get",value:function(e,t){if(null===this._driver||!e)return null;try{return this._driver.get(e)}catch(r){return t||Alert.error(null,'unable to get key "'+e+'"; '+r.message,r),null}}},{key:"set",value:function(e,t,r){if(null===this._driver||!e)return!1;try{return this._driver.set(e,t,r)}catch(t){return r||Alert.error(null,'unable to set key "'+e+'"; '+t.message,t),!1}}},{key:"delete",value:function(e,t){if(null===this._driver||!e)return!1;try{return this._driver.delete(e,t)}catch(r){return t||Alert.error(null,'unable to delete key "'+e+'"; '+r.message,r),!1}}},{key:"deleteMatching",value:function(e,t){if(null===this._driver||!e)return!1;for(var r=this.keys(),a=new RegExp("^"+RegExp.escape(e)),n=0;n<r.length;++n)a.test(r[n])&&this.delete(r[n],t);return!0}},{key:"length",get:function(){return null===this._driver?0:this._driver.length}}]),r}();return r}(),PRNGWrapper=function(){var e=function(){function e(t,r){_classCallCheck(this,e),Object.defineProperties(this,new Math.seedrandom(t,r,function(e,t){return{_prng:{value:e},seed:{writable:!0,value:t},pull:{writable:!0,value:0},random:{value:function(){return++this.pull,this._prng()}}}}))}return _createClass(e,null,[{key:"marshal",value:function(e){if(!e||!e.hasOwnProperty("seed")||!e.hasOwnProperty("pull"))throw new Error("PRNG is missing required data");return{seed:e.seed,pull:e.pull}}},{key:"unmarshal",value:function(t){if(!t||!t.hasOwnProperty("seed")||!t.hasOwnProperty("pull"))throw new Error("PRNG object is missing required data");for(var r=new e(t.seed,!1),a=t.pull;a>0;--a)r.random();return r}}]),e}();return e}(),StyleWrapper=function(){var e=/\[[<>]?[Ii][Mm][Gg]\[(?:\s|\S)*?\]\]+/g,t=new RegExp(e.source),r=function(){function r(e){if(_classCallCheck(this,r),null==e)throw new TypeError("StyleWrapper style parameter must be an HTMLStyleElement object");Object.defineProperties(this,{style:{value:e}})}return _createClass(r,[{key:"isEmpty",value:function(){return 0===this.style.cssRules.length}},{key:"set",value:function(e){this.clear(),this.add(e)}},{key:"add",value:function(r){var a=r;t.test(a)&&(e.lastIndex=0,a=a.replace(e,function(e){var t=Wikifier.helpers.parseSquareBracketedMarkup({source:e,matchStart:0});if(t.hasOwnProperty("error")||t.pos<e.length)return e;var r=t.source;if("data:"!==r.slice(0,5)&&Story.has(r)){var a=Story.get(r);a.tags.includes("Twine.image")&&(r=a.text)}return'url("'+r.replace(/"/g,"%22")+'")'})),this.style.styleSheet?this.style.styleSheet.cssText+=a:this.style.appendChild(document.createTextNode(a))}},{key:"clear",value:function(){this.style.styleSheet?this.style.styleSheet.cssText="":jQuery(this.style).empty()}}]),r}();return r}(),L10n=function(){function e(){r()}function t(e,t){if(!e)return"";var r=function(e){var t=void 0;return e.some(function(e){return!!l10nStrings.hasOwnProperty(e)&&(t=e,!0)}),t}(Array.isArray(e)?e:[e]);if(!r)return"";for(var i=50,o=l10nStrings[r],s=0;n.test(o);){if(++s>i)throw new Error("L10n.get exceeded maximum replacement iterations, probable infinite loop");a.lastIndex=0,o=o.replace(a,function(e){var r=e.slice(1,-1);return t&&t.hasOwnProperty(r)?t[r]:l10nStrings.hasOwnProperty(r)?l10nStrings[r]:void 0})}return o}function r(){strings&&Object.keys(strings).length>0&&Object.keys(l10nStrings).forEach(function(e){try{var t=void 0;switch(e){case"identity":t=strings.identity;break;case"aborting":t=strings.aborting;break;case"cancel":t=strings.cancel;break;case"close":t=strings.close;break;case"ok":t=strings.ok;break;case"errorTitle":t=strings.errors.title;break;case"errorNonexistentPassage":t=strings.errors.nonexistentPassage;break;case"errorSaveMissingData":t=strings.errors.saveMissingData;break;case"errorSaveIdMismatch":t=strings.errors.saveIdMismatch;break;case"warningDegraded":t=strings.warnings.degraded;break;case"debugViewTitle":t=strings.debugView.title;break;case"debugViewToggle":t=strings.debugView.toggle;break;case"uiBarToggle":t=strings.uiBar.toggle;break;case"uiBarBackward":t=strings.uiBar.backward;break;case"uiBarForward":t=strings.uiBar.forward;break;case"uiBarJumpto":t=strings.uiBar.jumpto;break;case"jumptoTitle":t=strings.jumpto.title;break;case"jumptoTurn":t=strings.jumpto.turn;break;case"jumptoUnavailable":t=strings.jumpto.unavailable;break;case"savesTitle":t=strings.saves.title;break;case"savesDisallowed":t=strings.saves.disallowed;break;case"savesEmptySlot":t=strings.saves.emptySlot;break;case"savesIncapable":t=strings.saves.incapable;break;case"savesLabelAuto":t=strings.saves.labelAuto;break;case"savesLabelDelete":t=strings.saves.labelDelete;break;case"savesLabelExport":t=strings.saves.labelExport;break;case"savesLabelImport":t=strings.saves.labelImport;break;case"savesLabelLoad":t=strings.saves.labelLoad;break;case"savesLabelClear":t=strings.saves.labelClear;break;case"savesLabelSave":t=strings.saves.labelSave;break;case"savesLabelSlot":t=strings.saves.labelSlot;break;case"savesSavedOn":t=strings.saves.savedOn;break;case"savesUnavailable":t=strings.saves.unavailable;break;case"savesUnknownDate":t=strings.saves.unknownDate;break;case"settingsTitle":t=strings.settings.title;break;case"settingsOff":t=strings.settings.off;break;case"settingsOn":t=strings.settings.on;break;case"settingsReset":t=strings.settings.reset;break;case"restartTitle":t=strings.restart.title;break;case"restartPrompt":t=strings.restart.prompt;break;case"shareTitle":t=strings.share.title;break;case"autoloadTitle":t=strings.autoload.title;break;case"autoloadCancel":t=strings.autoload.cancel;break;case"autoloadOk":t=strings.autoload.ok;break;case"autoloadPrompt":t=strings.autoload.prompt;break;case"macroBackText":t=strings.macros.back.text;break;case"macroReturnText":t=strings.macros.return.text}t&&(l10nStrings[e]=t.replace(/%\w+%/g,function(e){return"{"+e.slice(1,-1)+"}"}))}catch(e){}})}var a=/\{\w+\}/g,n=new RegExp(a.source);return Object.freeze(Object.defineProperties({},{init:{value:e},get:{value:t}}))}(),strings={errors:{},warnings:{},debugView:{},uiBar:{},jumpto:{},saves:{},settings:{},restart:{},share:{},autoload:{},macros:{back:{},return:{}}},l10nStrings={identity:"game",aborting:"Aborting",cancel:"Cancel",close:"Close",ok:"OK",errorTitle:"Error",errorNonexistentPassage:'the passage "{passage}" does not exist',errorSaveMissingData:"save is missing required data. Either the loaded file is not a save or the save has become corrupted",errorSaveIdMismatch:"save is from the wrong {identity}",_warningIntroLacking:"Apologies! Your browser either lacks or has disabled",_warningOutroDegraded:", so this {identity} is running in a degraded mode. You may be able to continue, however, some parts may not work properly.",warningNoWebStorage:"{_warningIntroLacking} the Web Storage API{_warningOutroDegraded}",warningDegraded:"{_warningIntroLacking} some of the capabilities required by this {identity}{_warningOutroDegraded}",debugViewTitle:"Debug View",debugViewToggle:"Toggle the debug view",uiBarToggle:"Toggle the UI bar",uiBarBackward:"Go backward within the {identity} history",uiBarForward:"Go forward within the {identity} history",uiBarJumpto:"Jump to a specific point within the {identity} history",jumptoTitle:"Jump To",jumptoTurn:"Turn",jumptoUnavailable:"No jump points currently available…",savesTitle:"Saves",savesDisallowed:"Saving has been disallowed on this passage.",savesEmptySlot:"— slot empty —",savesIncapable:"{_warningIntroLacking} the capabilities required to support saves, so saves have been disabled for this session.",savesLabelAuto:"Autosave",savesLabelDelete:"Delete",savesLabelExport:"Save to Disk…",savesLabelImport:"Load from Disk…",savesLabelLoad:"Load",savesLabelClear:"Delete All",savesLabelSave:"Save",savesLabelSlot:"Slot",savesSavedOn:"Saved on",savesUnavailable:"No save slots found…",savesUnknownDate:"unknown",settingsTitle:"Settings",settingsOff:"Off",settingsOn:"On",settingsReset:"Reset to Defaults",restartTitle:"Restart",restartPrompt:"Are you sure that you want to restart? Unsaved progress will be lost.",shareTitle:"Share",autoloadTitle:"Autoload",autoloadCancel:"Go to start",autoloadOk:"Load autosave",autoloadPrompt:"An autosave exists. Load it now or go to the start?",macroBackText:"Back",macroReturnText:"Return"},Config=function(){function e(){throw new Error("Config.history.mode has been deprecated and is no longer used by SugarCube, please remove it from your code")}function t(){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")}var r=Object.seal({debug:!1,addVisitedLinkClass:!1,cleanupWikifierOutput:!1,loadDelay:0,history:Object.seal({controls:!0,maxStates:100,get mode(){e()},set mode(t){e()},get tracking(){t()},set tracking(e){t()}}),macros:Object.seal({ifAssignmentError:!0,maxLoopIterations:1e3}),passages:Object.seal({descriptions:undefined,displayTitles:!1,start:undefined,transitionOut:undefined}),saves:Object.seal({autoload:undefined,autosave:undefined,id:"untitled-story",isAllowed:undefined,onLoad:undefined,onSave:undefined,slots:8,version:undefined}),ui:Object.seal({stowBarInitially:!1,updateStoryElements:!0}),transitionEndEventName:function(){for(var e=new Map([["transition","transitionend"],["MSTransition","msTransitionEnd"],["WebkitTransition","webkitTransitionEnd"],["MozTransition","transitionend"]]),t=[].concat(_toConsumableArray(e.keys())),r=document.createElement("div"),a=0;a<t.length;++a)if(r.style[t[a]]!==undefined)return e.get(t[a]);return""}()});return r}(),Patterns=function(){var e=/[\u0150\u0170]/g.test("Ő"),t="[\\s\\u00A0\\u2028\\u2029]",r="[0-9A-Z_a-z\\-\\u00C0-\\u00D6\\u00D8-\\u00DE\\u00DF-\\u00F6\\u00F8-\\u00FF"+(e?"\\u0150\\u0170\\u0151\\u0171":"")+"]",a=r.replace("\\-",""),n="[$A-Z_a-z]",i=n+"[$0-9A-Z_a-z]*",o="[$_]",s=o+i,u="("+r+"+)\\(([^\\)\\|\\n]+)\\):",l="("+r+"+):([^;\\|\\n]+);",c="((?:\\."+r+"+)+);",d="((?:#"+r+"+)+);",h=u+"|"+l+"|"+c+"|"+d,p="(?:file|https?|mailto|ftp|javascript|irc|news|data):[^\\s'\"]+";return Object.freeze({space:t,anyLetter:r,anyLetterStrict:a,identifierFirstChar:n,identifier:i,variableSigil:o,variable:s,inlineCss:h,url:p})}(),Scripting=function(){function addAccessibleClickHandler(e,t,r,a,n){if(arguments.length<2)throw new Error("addAccessibleClickHandler insufficient number of parameters");var i=void 0,o=void 0;if("function"==typeof t?(i=t,o={namespace:a,one:!!r}):(i=r,o={namespace:n,one:!!a,selector:t}),"function"!=typeof i)throw new TypeError("addAccessibleClickHandler handler parameter must be a function");return jQuery(e).ariaClick(o,i)}function insertElement(e,t,r,a,n,i){var o=jQuery(document.createElement(t));return r&&o.attr("id",r),a&&o.addClass(a),i&&o.attr("title",i),n&&o.text(n),e&&o.appendTo(e),o[0]}function insertText(e,t){jQuery(e).append(document.createTextNode(t))}function removeChildren(e){jQuery(e).empty()}function removeElement(e){jQuery(e).remove()}function fade(e,t){function r(){i+=.05*n,a(o,Math.easeInOut(i)),(1===n&&i>=1||n===-1&&i<=0)&&(e.style.visibility="in"===t.fade?"visible":"hidden",o.parentNode.replaceChild(e,o),o=null,window.clearInterval(s),t.onComplete&&t.onComplete())}function a(e,t){e.style.zoom=1,e.style.filter="alpha(opacity="+Math.floor(100*t)+")",e.style.opacity=t}var n="in"===t.fade?1:-1,i=void 0,o=e.cloneNode(!0),s=void 0;e.parentNode.replaceChild(o,e),"in"===t.fade?(i=0,o.style.visibility="visible"):i=1,a(o,i),s=window.setInterval(r,25)}function scrollWindowTo(e,t){function r(){c+=i,window.scroll(0,o+l*(u*Math.easeInOut(c))),c>=1&&window.clearInterval(d)}function a(e){for(var t=0;e.offsetParent;)t+=e.offsetTop,e=e.offsetParent;return t}function n(e){var t=a(e),r=t+e.offsetHeight,n=window.scrollY?window.scrollY:document.body.scrollTop,i=window.innerHeight?window.innerHeight:document.body.clientHeight,o=n+i;return t<n?t:r>o&&e.offsetHeight<i?t-(i-e.offsetHeight)+20:t}var i=null!=t?Number(t):.1;Number.isNaN(i)||!Number.isFinite(i)||i<0?i=.1:i>1&&(i=1);var o=window.scrollY?window.scrollY:document.body.scrollTop,s=n(e),u=Math.abs(o-s),l=o>s?-1:1,c=0,d=void 0;d=window.setInterval(r,25)}function either(){if(0!==arguments.length)return Array.prototype.concat.apply([],arguments).random()}function hasVisited(){if(0===arguments.length)throw new Error("hasVisited called with insufficient parameters");if(State.isEmpty())return!1;for(var e=Array.prototype.concat.apply([],arguments),t=State.passages,r=0,a=e.length;r<a;++r)if(!t.includes(e[r]))return!1;return!0}function lastVisited(){if(0===arguments.length)throw new Error("lastVisited called with insufficient parameters");if(State.isEmpty())return-1;for(var e=Array.prototype.concat.apply([],arguments),t=State.passages,r=t.length-1,a=State.turns,n=0,i=e.length;n<i&&a>-1;++n){var o=t.lastIndexOf(e[n]);a=Math.min(a,o===-1?-1:r-o)}return a}function passage(){return State.passage}function previous(){var e=State.passages;if(arguments.length>0){var t=Number(arguments[0]);if(!Number.isSafeInteger(t)||t<1)throw new RangeError("previous offset parameter must be a positive integer greater than zero");return e.length>t?e[e.length-1-t]:""}for(var r=e.length-2;r>=0;--r)if(e[r]!==State.passage)return e[r];return""}function random(){if(0===arguments.length)throw new Error("random called with insufficient parameters");var e=void 0,t=void 0;if(1===arguments.length?(e=0,t=arguments[0]):(e=arguments[0],t=arguments[1]),e>t){var r=[t,e];e=r[0],t=r[1]}return Math.floor(State.random()*(t-e+1))+e}function randomFloat(){if(0===arguments.length)throw new Error("randomFloat called with insufficient parameters");var e=void 0,t=void 0;if(1===arguments.length?(e=0,t=arguments[0]):(e=arguments[0],t=arguments[1]),e>t){var r=[t,e];e=r[0],t=r[1]}return State.random()*(t-e)+e}function tags(){if(0===arguments.length)return Story.get(State.passage).tags.slice(0);for(var e=Array.prototype.concat.apply([],arguments),t=[],r=0,a=e.length;r<a;++r)t=t.concat(Story.get(e[r]).tags);return t}function time(){return null===Engine.lastPlay?0:Date.now()-Engine.lastPlay}function turns(){return State.turns}function variables(){return State.variables}function visited(){if(State.isEmpty())return 0;for(var e=Array.prototype.concat.apply([],0===arguments.length?[State.passage]:arguments),t=State.passages,r=State.turns,a=0,n=e.length;a<n&&r>0;++a)r=Math.min(r,t.count(e[a]));return r}function visitedTags(){if(0===arguments.length)throw new Error("visitedTags called with insufficient parameters");if(State.isEmpty())return 0;for(var e=Array.prototype.concat.apply([],arguments),t=e.length,r=State.passages,a=new Map,n=0,i=0,o=r.length;i<o;++i){var s=r[i];if(a.has(s))a.get(s)&&++n;else{var u=Story.get(s).tags;if(u.length>0){for(var l=0,c=0;c<t;++c)u.includes(e[c])&&++l;l===t?(++n,a.set(s,!0)):a.set(s,!1)}}}return n}function evalJavaScript(code,output){return function(code,output){return eval(code)}.call(output?{output:output}:null,String(code),output)}function evalTwineScript(code,output){return function(code,output){return eval(code)}.call(output?{output:output}:null,parse(String(code)),output)}var parse=function(){function e(e){if(0!==r.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start");for(var n=e,i=void 0;null!==(i=r.exec(n));)if(i[5]){var o=i[5];if("$"===o||"_"===o)continue;if(a.test(o))o=o[0];else if("is"===o){var s=r.lastIndex,u=n.slice(s);/^\s+not\b/.test(u)&&(n=n.splice(s,u.search(/\S/)),o="isnot")}t.hasOwnProperty(o)&&(n=n.splice(i.index,o.length,t[o]),r.lastIndex+=t[o].length-o.length)}return n}var t=Object.freeze({$:"State.variables.",_:"TempVariables.",to:"=",eq:"==",neq:"!=",is:"===",isnot:"!==",gt:">",gte:">=",lt:"<",lte:"<=",and:"&&",or:"||",not:"!",def:'"undefined" !== typeof',ndef:'"undefined" === typeof'}),r=new RegExp(["(\"\"|'')",'("(?:\\\\.|[^"\\\\])+")',"('(?:\\\\.|[^'\\\\])+')","([=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}]+)","([^\"'=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}\\s]+)"].join("|"),"g"),a=new RegExp("^"+Patterns.variable);return e}();return Object.freeze(Object.defineProperties({},{parse:{value:parse},evalJavaScript:{value:evalJavaScript},evalTwineScript:{value:evalTwineScript}}))}(),Wikifier=function(){var e=void 0,t=function(){function t(r,a){_classCallCheck(this,t),Object.defineProperties(this,{formatter:{value:e||t.compileFormatters()},source:{value:String(a)},nextMatch:{writable:!0,value:0},output:{
writable:!0,value:null},_rawArgs:{writable:!0,value:""},_nobr:{writable:!0,value:[]}}),null==r?this.output=document.createDocumentFragment():r.jquery?this.output=r[0]:this.output=r,this.subWikify(this.output)}return _createClass(t,[{key:"subWikify",value:function(e,t,r){var a=this.output;this.output=e;var n=t?new RegExp("(?:"+t+")",r?"gim":"gm"):null,i=void 0,o=void 0;do{if(this.formatter.formatterRegExp.lastIndex=this.nextMatch,n&&(n.lastIndex=this.nextMatch),o=this.formatter.formatterRegExp.exec(this.source),i=n?n.exec(this.source):null,i&&(!o||i.index<=o.index))return i.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,i.index),this.matchStart=i.index,this.matchLength=i[0].length,this.matchText=i[0],this.nextMatch=n.lastIndex,void(this.output=a);if(o){o.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,o.index),this.matchStart=o.index,this.matchLength=o[0].length,this.matchText=o[0],this.nextMatch=this.formatter.formatterRegExp.lastIndex;for(var s=void 0,u=1,l=o.length;u<l;++u)if(o[u]){s=u-1;break}if(this.formatter.formatters[s].handler(this),null!=TempState.break)break}}while(i||o);null==TempState.break?this.nextMatch<this.source.length&&(this.outputText(this.output,this.nextMatch,this.source.length),this.nextMatch=this.source.length):this.output.lastChild&&this.output.lastChild.nodeType===Node.ELEMENT_NODE&&"BR"===this.output.lastChild.nodeName.toUpperCase()&&jQuery(this.output.lastChild).remove(),this.output=a}},{key:"outputText",value:function(e,t,r){jQuery(e).append(document.createTextNode(this.source.substring(t,r)))}},{key:"rawArgs",value:function(){return this._rawArgs}},{key:"fullArgs",value:function(){return Scripting.parse(this.rawArgs())}}],[{key:"compileFormatters",value:function(){var r=t.formatters;return e={formatters:r,formatterRegExp:new RegExp(r.map(function(e){return"("+e.match+")"}).join("|"),"gm")}}},{key:"getValue",value:function(e){var r=t.parseStoryVariable(e),a=void 0;if(null!==r){a=r.store;for(var n=r.names,i=0,o=n.length;i<o;++i){if("undefined"==typeof a[n[i]]){a=undefined;break}a=a[n[i]]}}return a}},{key:"setValue",value:function(e,r){var a=t.parseStoryVariable(e);if(null!==a){for(var n=a.names,i=n.pop(),o=a.store,s=0,u=n.length;s<u;++s){if("undefined"==typeof o[n[s]]){o=undefined;break}o=o[n[s]]}if(o!==undefined)return o[i]=r,!0}return!1}},{key:"parseStoryVariable",value:function(e){for(var r={store:"$"===e[0]?State.variables:TempVariables,names:[]},a=e,n=void 0;null!==(n=t._parseVarRegExp.exec(a));)a=a.slice(n[0].length),n[1]?r.names.push(n[1]):n[2]?r.names.push(n[2]):n[3]?r.names.push(n[3]):n[4]?r.names.push(n[4]):n[5]?r.names.push(t.getValue(n[5])):n[6]&&r.names.push(Number(n[6]));return""===a?r:null}},{key:"wikifyEval",value:function(e){var r=document.createDocumentFragment();new t(r,e);var a=r.querySelector(".error");if(null!==a)throw new Error(a.textContent.replace(/^(?:(?:Uncaught\s+)?Error:\s+)+/,""));return r}},{key:"createInternalLink",value:function(e,t,r,a){var n=jQuery(document.createElement("a"));return null!=t&&(n.attr("data-passage",t),Story.has(t)?(n.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(t)&&n.addClass("link-visited")):n.addClass("link-broken"),n.ariaClick({one:!0},function(){"function"==typeof a&&a(),Engine.play(t)})),r&&n.append(document.createTextNode(r)),e&&n.appendTo(e),n[0]}},{key:"createExternalLink",value:function(e,t,r){var a=jQuery(document.createElement("a")).attr("target","_blank").addClass("link-external").text(r).appendTo(e);return null!=t&&a.attr({href:t,tabindex:0}),a[0]}},{key:"isExternalLink",value:function(e){if(Story.has(e))return!1;var t=new RegExp("^"+Patterns.url,"gim");return t.test(e)||/[\/\.\?#]/.test(e)}}]),t}();return Object.defineProperties(t,{_parseVarRegExp:{value:new RegExp(["^(?:",Patterns.variableSigil,"(",Patterns.identifier,")|\\.(",Patterns.identifier,")|\\[(?:(?:\"((?:\\\\.|[^\"\\\\])+)\")|(?:'((?:\\\\.|[^'\\\\])+)')|(",Patterns.variableSigil,Patterns.identifierFirstChar,".*)|(\\d+))\\])"].join(""))},helpers:{value:{}},parse:{value:Scripting.parse},evalExpression:{value:Scripting.evalTwineScript},evalStatements:{value:Scripting.evalTwineScript},textPrimitives:{value:Patterns}}),Object.defineProperties(t.helpers,{_inlineCssLookahead:{value:new RegExp(Patterns.inlineCss,"gm")},inlineCss:{value:function(e){var t={classes:[],id:"",styles:{}},r=this._inlineCssLookahead,a=void 0;do{r.lastIndex=e.nextMatch;var n=r.exec(e.source);a=n&&n.index===e.nextMatch,a&&(n[1]?t.styles[Util.fromCssProperty(n[1])]=n[2].trim():n[3]?t.styles[Util.fromCssProperty(n[3])]=n[4].trim():n[5]?t.classes=t.classes.concat(n[5].slice(1).split(/\./)):n[6]&&(t.id=n[6].slice(1).split(/#/).pop()),e.nextMatch=r.lastIndex)}while(a);return t}},evalText:{value:function(e){var t=void 0;try{t=Scripting.evalTwineScript(e),null==t||"function"==typeof t?t=e:(t=String(t),/\[(?:object(?:\s+[^\]]+)?|native\s+code)\]/.test(t)&&(t=e))}catch(r){t=e}return t}},evalPassageId:{value:function(e){return null==e||Story.has(e)?e:t.helpers.evalText(e)}},parseSquareBracketedMarkup:{value:function(e){function t(){return d>=e.source.length?u:e.source[d++]}function r(){return d>=e.source.length?u:e.source[d]}function a(t){return t<1||d+t>=e.source.length?u:e.source[d+t]}function n(){return{error:String.format.apply(String,arguments),pos:d}}function i(){c=d}function o(t){var r=e.source.slice(c,d).trim();if(""===r)throw new Error("malformed wiki "+(f?"link":"image")+", empty "+t+" component");"link"===t&&"~"===r[0]?(l.forceInternal=!0,l.link=r.slice(1)):l[t]=r,c=d}function s(e){++d;e:for(;;){switch(r()){case"\\":++d;var t=r();if(t!==u&&"\n"!==t)break;case u:case"\n":return u;case e:break e}++d}return d}var u=-1,l={},c=e.matchStart,d=c+1,h=void 0,p=void 0,f=void 0,g=void 0;if(g=r(),"["===g)f=l.isLink=!0;else{switch(f=!1,g){case"<":l.align="left",++d;break;case">":l.align="right",++d}if(!/^[Ii][Mm][Gg]$/.test(e.source.slice(d,d+3)))return n("malformed square-bracketed wiki markup");d+=3,l.isImage=!0}if("["!==t())return n("malformed wiki {0}",f?"link":"image");h=1,p=0,i();try{e:for(;;){switch(g=r()){case u:case"\n":return n("unterminated wiki {0}",f?"link":"image");case'"':if(s(g)===u)return n("unterminated double quoted string in wiki {0}",f?"link":"image");break;case"'":if((4===p||3===p&&f)&&s(g)===u)return n("unterminated single quoted string in wiki {0}",f?"link":"image");break;case"|":0===p&&(o(f?"text":"title"),++c,p=1);break;case"-":0===p&&">"===a(1)&&(o(f?"text":"title"),++d,c+=2,p=1);break;case"<":0===p&&"-"===a(1)&&(o(f?"link":"source"),++d,c+=2,p=2);break;case"[":if(p===-1)return n("unexpected left square bracket '['");++h,1===h&&(i(),++c);break;case"]":if(--h,0===h){switch(p){case 0:case 1:o(f?"link":"source"),p=3;break;case 2:o(f?"text":"title"),p=3;break;case 3:f?(o("setter"),p=-1):(o("link"),p=4);break;case 4:o("setter"),p=-1}if(++d,"]"===r()){++d;break e}--d}}++d}}catch(e){return n(e.message)}return l.pos=d,l}}}),Object.defineProperty(t,"formatters",{value:[{name:"macro",match:"<<",lookahead:/<<(\/?[A-Za-z][^>\s]*|[=-])(?:\s*)((?:(?:"(?:\\.|[^"\\])*")|(?:'(?:\\.|[^'\\])*')|(?:\[(?:[<>]?[Ii][Mm][Gg])?\[[^\r\n]*?\]\]+)|[^>]|(?:>(?!>)))*)>>/gm,argsPattern:["(``)","`((?:\\\\.|[^`\\\\])+)`","(\"\"|'')",'("(?:\\\\.|[^"\\\\])+")',"('(?:\\\\.|[^'\\\\])+')","(\\[(?:[<>]?[Ii][Mm][Gg])?\\[[^\\r\\n]*?\\]\\]+)","([^`\"'\\s]+)","(`|\"|')"].join("|"),working:{source:"",name:"",arguments:"",index:0},context:null,handler:function(e){var t=this.lookahead.lastIndex=e.matchStart;if(this.parseTag(e)){var r=e.nextMatch,a=this.working.source,n=this.working.name,i=this.working.arguments,o=void 0;try{if(o=Macro.get(n),!o){if(Macro.tags.has(n)){var s=Macro.tags.get(n);return throwError(e.output,"child tag <<"+n+">> was found outside of a call to its parent macro"+(1===s.length?"":"s")+" <<"+s.join(">>, <<")+">>",e.source.slice(t,e.nextMatch))}return throwError(e.output,"macro <<"+n+">> does not exist",e.source.slice(t,e.nextMatch))}var u=null;if(o.hasOwnProperty("tags")&&(u=this.parseBody(e,o),!u))return e.nextMatch=r,throwError(e.output,"cannot find a closing tag for macro <<"+n+">>",e.source.slice(t,e.nextMatch)+"…");if("function"!=typeof o.handler)return throwError(e.output,"macro <<"+n+">> handler function "+(o.hasOwnProperty("handler")?"is not a function":"does not exist"),e.source.slice(t,e.nextMatch));var l=u?u[0].args:this.createArgs(i,o.hasOwnProperty("skipArgs")&&!!o.skipArgs||o.hasOwnProperty("skipArg0")&&!!o.skipArg0);if(o.hasOwnProperty("_MACRO_API")){this.context=new MacroContext({parent:this.context,macro:o,name:n,args:l,payload:u,parser:e,source:a});try{o.handler.call(this.context)}finally{this.context=this.context.parent}}else{var c=e._rawArgs;e._rawArgs=i,o.handler(e.output,n,l,e,u),e._rawArgs=c}}catch(r){return throwError(e.output,"cannot execute "+(o&&o.isWidget?"widget":"macro")+" <<"+n+">>: "+r.message,e.source.slice(t,e.nextMatch))}finally{this.working.source="",this.working.name="",this.working.arguments="",this.working.index=0}}else e.outputText(e.output,e.matchStart,e.nextMatch)},parseTag:function(e){var t=this.lookahead.exec(e.source);return!(!t||t.index!==e.matchStart||!t[1])&&(e.nextMatch=this.lookahead.lastIndex,this.working.source=e.source.slice(t.index,this.lookahead.lastIndex),this.working.name=t[1],this.working.arguments=t[2],this.working.index=t.index,!0)},parseBody:function(e,t){for(var r=this.working.name,a="/"+r,n="end"+r,i=!!Array.isArray(t.tags)&&t.tags,o=[],s=t.hasOwnProperty("skipArgs")&&t.skipArgs,u=t.hasOwnProperty("skipArg0")&&t.skipArg0,l=-1,c=1,d=this.working.source,h=this.working.name,p=this.working.arguments,f=e.nextMatch;(e.matchStart=e.source.indexOf(this.match,e.nextMatch))!==-1;)if(this.parseTag(e)){var g=this.working.source,m=this.working.name,v=this.working.arguments,y=this.working.index,b=e.nextMatch;switch(m){case r:++c;break;case n:case a:--c;break;default:if(1===c&&i)for(var w=0,k=i.length;w<k;++w)m===i[w]&&(o.push({source:d,name:h,arguments:p,args:this.createArgs(p,s||0===o.length&&u),contents:e.source.slice(f,y)}),d=g,h=m,p=v,f=b)}if(0===c){o.push({source:d,name:h,arguments:p,args:this.createArgs(p,s||0===o.length&&u),contents:e.source.slice(f,y)}),l=b;break}}else this.lookahead.lastIndex=e.nextMatch=e.matchStart+this.match.length;return l!==-1?(e.nextMatch=l,o):null},createArgs:function(e,t){var r=t?[]:this.parseArgs(e);return Object.defineProperties(r,{raw:{value:e},full:{value:Scripting.parse(e)}}),r},parseArgs:function(e){for(var r=new RegExp(this.argsPattern,"gm"),a=[],n=new RegExp("^"+Patterns.variable),i=void 0;null!==(i=r.exec(e));){var o=void 0;if(i[1])o=undefined;else if(i[2]){o=i[2];try{o=Scripting.evalTwineScript(o)}catch(e){throw new Error('unable to parse macro argument "'+o+'": '+e.message)}}else if(i[3])o="";else if(i[4]){o=i[4];try{o=Scripting.evalJavaScript(o)}catch(e){throw new Error("unable to parse macro argument '"+o+"': "+e.message)}}else if(i[5]){o=i[5];try{o=Scripting.evalJavaScript(o)}catch(e){throw new Error('unable to parse macro argument "'+o+'": '+e.message)}}else if(i[6]){o=i[6];var s=t.helpers.parseSquareBracketedMarkup({source:o,matchStart:0});if(s.hasOwnProperty("error"))throw new Error('unable to parse macro argument "'+o+'": '+s.error);if(s.pos<o.length)throw new Error('unable to parse macro argument "'+o+'": unexpected character(s) "'+o.slice(s.pos)+'" (pos: '+s.pos+")");s.isLink?(o={isLink:!0},o.count=s.hasOwnProperty("text")?2:1,o.link=t.helpers.evalPassageId(s.link),o.text=s.hasOwnProperty("text")?t.helpers.evalText(s.text):o.link,o.external=!s.forceInternal&&t.isExternalLink(o.link),o.setFn=s.hasOwnProperty("setter")?function(e){return function(){return Scripting.evalJavaScript(e)}}(Scripting.parse(s.setter)):null):s.isImage&&(o=function(e){var t={source:e,isImage:!0};if("data:"!==e.slice(0,5)&&Story.has(e)){var r=Story.get(e);r.tags.includes("Twine.image")&&(t.source=r.text,t.passage=r.title)}return t}(s.source),s.hasOwnProperty("align")&&(o.align=s.align),s.hasOwnProperty("title")&&(o.title=t.helpers.evalText(s.title)),s.hasOwnProperty("link")&&(o.link=t.helpers.evalPassageId(s.link),o.external=!s.forceInternal&&t.isExternalLink(o.link)),o.setFn=s.hasOwnProperty("setter")?function(e){return function(){return Scripting.evalJavaScript(e)}}(Scripting.parse(s.setter)):null)}else if(i[7])if(o=i[7],n.test(o))o=t.getValue(o);else if(/^(?:settings|setup)[\.\[]/.test(o))try{o=Scripting.evalTwineScript(o)}catch(e){throw new Error('unable to parse macro argument "'+o+'": '+e.message)}else if("null"===o)o=null;else if("undefined"===o)o=undefined;else if("true"===o)o=!0;else if("false"===o)o=!1;else{var u=Number(o);Number.isNaN(u)||(o=u)}else if(i[8]){var l=void 0;switch(i[8]){case"`":l="backtick expression";break;case'"':l="double quoted string";break;case"'":l="single quoted string"}throw new Error("unterminated "+l+" in macro argument string")}a.push(o)}return a}},{name:"prettyLink",match:"\\[\\[[^[]",handler:function(e){var r=t.helpers.parseSquareBracketedMarkup(e);if(r.hasOwnProperty("error"))return void e.outputText(e.output,e.matchStart,e.nextMatch);e.nextMatch=r.pos;var a=t.helpers.evalPassageId(r.link),n=r.hasOwnProperty("text")?t.helpers.evalText(r.text):a,i=r.hasOwnProperty("setter")?function(e){return function(){return Scripting.evalJavaScript(e)}}(Scripting.parse(r.setter)):null,o=(Config.debug?new DebugView(e.output,"wiki-link","[[link]]",e.source.slice(e.matchStart,e.nextMatch)):e).output;r.forceInternal||!t.isExternalLink(a)?t.createInternalLink(o,a,n,i):t.createExternalLink(o,a,n)}},{name:"urlLink",match:Patterns.url,handler:function(e){e.outputText(t.createExternalLink(e.output,e.matchText),e.matchStart,e.nextMatch)}},{name:"image",match:"\\[[<>]?[Ii][Mm][Gg]\\[",handler:function(e){var r=t.helpers.parseSquareBracketedMarkup(e);if(r.hasOwnProperty("error"))return void e.outputText(e.output,e.matchStart,e.nextMatch);e.nextMatch=r.pos;var a=void 0;Config.debug&&(a=new DebugView(e.output,"wiki-image",r.hasOwnProperty("link")?"[img[][link]]":"[img[]]",e.source.slice(e.matchStart,e.nextMatch)),a.modes({block:!0}));var n=r.hasOwnProperty("setter")?function(e){return function(){return Scripting.evalJavaScript(e)}}(Scripting.parse(r.setter)):null,i=(Config.debug?a:e).output,o=void 0;if(r.hasOwnProperty("link")){var s=t.helpers.evalPassageId(r.link);i=r.forceInternal||!t.isExternalLink(s)?t.createInternalLink(i,s,null,n):t.createExternalLink(i,s),i.classList.add("link-image")}if(i=jQuery(document.createElement("img")).appendTo(i).get(0),o=t.helpers.evalPassageId(r.source),"data:"!==o.slice(0,5)&&Story.has(o)){var u=Story.get(o);u.tags.includes("Twine.image")&&(i.setAttribute("data-passage",u.title),o=u.text)}i.src=o,r.hasOwnProperty("title")&&(i.title=t.helpers.evalText(r.title)),r.hasOwnProperty("align")&&(i.align=r.align)}},{name:"monospacedByLine",match:"^\\{\\{\\{\\n",lookahead:/^\{\{\{\n((?:^[^\n]*\n)+?)(^\}\}\}$\n?)/gm,handler:function(e){this.lookahead.lastIndex=e.matchStart;var t=this.lookahead.exec(e.source);t&&t.index===e.matchStart&&(jQuery(document.createElement("pre")).text(t[1]).appendTo(e.output),e.nextMatch=this.lookahead.lastIndex)}},{name:"formatByChar",match:"''|//|__|\\^\\^|~~|==|\\{\\{\\{",handler:function(e){switch(e.matchText){case"''":e.subWikify(jQuery(document.createElement("strong")).appendTo(e.output).get(0),"''");break;case"//":e.subWikify(jQuery(document.createElement("em")).appendTo(e.output).get(0),"//");break;case"__":e.subWikify(jQuery(document.createElement("u")).appendTo(e.output).get(0),"__");break;case"^^":e.subWikify(jQuery(document.createElement("sup")).appendTo(e.output).get(0),"\\^\\^");break;case"~~":e.subWikify(jQuery(document.createElement("sub")).appendTo(e.output).get(0),"~~");break;case"==":e.subWikify(jQuery(document.createElement("s")).appendTo(e.output).get(0),"==");break;case"{{{":var t=/\{\{\{((?:.|\n)*?)\}\}\}/gm;t.lastIndex=e.matchStart;var r=t.exec(e.source);r&&r.index===e.matchStart&&(jQuery(document.createElement("code")).text(r[1]).appendTo(e.output),e.nextMatch=t.lastIndex)}}},{name:"customStyle",match:"@@",terminator:"@@",blockRegExp:/\s*\n/gm,handler:function(e){var r=t.helpers.inlineCss(e);this.blockRegExp.lastIndex=e.nextMatch;var a=this.blockRegExp.exec(e.source),n=a&&a.index===e.nextMatch,i=jQuery(document.createElement(n?"div":"span")).appendTo(e.output);0===r.classes.length&&""===r.id&&0===Object.keys(r.styles).length?i.addClass("marked"):(r.classes.forEach(function(e){return i.addClass(e)}),""!==r.id&&i.attr("id",r.id),i.css(r.styles)),n?(e.nextMatch+=a[0].length,e.subWikify(i[0],"\\n?"+this.terminator)):e.subWikify(i[0],this.terminator)}},{name:"verbatimText",match:'"{3}|<nowiki>',lookahead:/(?:"{3}((?:.|\n)*?)"{3})|(?:<nowiki>((?:.|\n)*?)<\/nowiki>)/gm,handler:function(e){this.lookahead.lastIndex=e.matchStart;var t=this.lookahead.exec(e.source);t&&t.index===e.matchStart&&(jQuery(document.createElement("span")).addClass("verbatim").text(t[1]||t[2]).appendTo(e.output),e.nextMatch=this.lookahead.lastIndex)}},{name:"rule",match:"^----+$\\n?|<hr\\s*/?>\\n?",handler:function(e){jQuery(document.createElement("hr")).appendTo(e.output)}},{name:"emdash",match:"--",handler:function(e){jQuery(document.createTextNode("—")).appendTo(e.output)}},{name:"doubleDollarSign",match:"\\${2}",handler:function(e){jQuery(document.createTextNode("$")).appendTo(e.output)}},{name:"nakedVariable",match:[Patterns.variable,"(?:(?:\\.",Patterns.identifier,")|(?:\\[\\d+\\])|(?:\\[\"(?:\\\\.|[^\"\\\\])+\"\\])|(?:\\['(?:\\\\.|[^'\\\\])+'\\])|(?:\\[",Patterns.variable,"\\]))*"].join(""),handler:function(e){var r=toStringOrDefault(t.getValue(e.matchText),null);null===r?jQuery(document.createTextNode(e.matchText)).appendTo(e.output):new t((Config.debug?new DebugView(e.output,"variable",e.matchText,e.matchText):e).output,r)}},{name:"heading",match:"^!{1,6}",terminator:"\\n",handler:function(e){var t=function(e){for(var t="function"==typeof window.getComputedStyle,r=e.length-1;r>=0;--r){var a=e[r];switch(a.nodeType){case Node.ELEMENT_NODE:var n=a.nodeName.toUpperCase();if("BR"===n)return!0;var i=t?window.getComputedStyle(a,null):a.currentStyle;if(i&&i.display){if("none"===i.display)continue;return"block"===i.display}switch(n){case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":return!0}return!1;case Node.COMMENT_NODE:continue;default:return!1}}return!0}(e.output.childNodes);t?e.subWikify(jQuery(document.createElement("h"+e.matchLength)).appendTo(e.output).get(0),this.terminator):jQuery(e.output).append(document.createTextNode(e.matchText))}},{name:"table",match:"^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",lookahead:/^\|([^\n]*)\|([fhck]?)$/gm,rowTerminator:"\\|(?:[cfhk]?)$\\n?",cellPattern:"(?:\\|([^\\n\\|]*)\\|)|(\\|[cfhk]?$\\n?)",cellTerminator:"(?:\\u0020*)\\|",rowTypes:{c:"caption",f:"tfoot",h:"thead","":"tbody"},handler:function(e){var t=jQuery(document.createElement("table")).appendTo(e.output).get(0),r=[],a=null,n=null,i=0,o=void 0;e.nextMatch=e.matchStart;do{this.lookahead.lastIndex=e.nextMatch;var s=this.lookahead.exec(e.source);if(o=s&&s.index===e.nextMatch){var u=s[2];"k"===u?(t.className=s[1],e.nextMatch+=s[0].length+1):(u!==a&&(a=u,n=jQuery(document.createElement(this.rowTypes[u])).appendTo(t)),"c"===a?(n.css("caption-side",0===i?"top":"bottom"),e.nextMatch+=1,e.subWikify(n[0],this.rowTerminator)):this.rowHandler(e,jQuery(document.createElement("tr")).appendTo(n).get(0),r),++i)}}while(o)},rowHandler:function(e,r,a){var n=this,i=new RegExp(this.cellPattern,"gm"),o=0,s=1,u=void 0;do{i.lastIndex=e.nextMatch;var l=i.exec(e.source);if(u=l&&l.index===e.nextMatch){if("~"===l[1]){var c=a[o];c&&(++c.rowCount,c.$element.attr("rowspan",c.rowCount).css("vertical-align","middle")),e.nextMatch=l.index+l[0].length-1}else if(">"===l[1])++s,e.nextMatch=l.index+l[0].length-1;else{if(l[2]){e.nextMatch=l.index+l[0].length;break}!function(){++e.nextMatch;for(var i=t.helpers.inlineCss(e),u=!1,l=!1,c=void 0;" "===e.source.substr(e.nextMatch,1);)u=!0,++e.nextMatch;"!"===e.source.substr(e.nextMatch,1)?(c=jQuery(document.createElement("th")).appendTo(r),++e.nextMatch):c=jQuery(document.createElement("td")).appendTo(r),a[o]={rowCount:1,$element:c},s>1&&(c.attr("colspan",s),s=1),e.subWikify(c[0],n.cellTerminator)," "===e.matchText.substr(e.matchText.length-2,1)&&(l=!0),i.classes.forEach(function(e){return c.addClass(e)}),""!==i.id&&c.attr("id",i.id),u&&l?i.styles["text-align"]="center":u?i.styles["text-align"]="right":l&&(i.styles["text-align"]="left"),c.css(i.styles),e.nextMatch=e.nextMatch-1}()}++o}}while(u)}},{name:"list",match:"^(?:(?:\\*+)|(?:#+))",lookahead:/^(?:(\*+)|(#+))/gm,terminator:"\\n",handler:function(e){e.nextMatch=e.matchStart;var t=[e.output],r=null,a=0,n=void 0,i=void 0;do{this.lookahead.lastIndex=e.nextMatch;var o=this.lookahead.exec(e.source);if(n=o&&o.index===e.nextMatch){var s=o[2]?"ol":"ul",u=o[0].length;if(e.nextMatch+=o[0].length,u>a)for(i=a;i<u;++i)t.push(jQuery(document.createElement(s)).appendTo(t[t.length-1]).get(0));else if(u<a)for(i=a;i>u;--i)t.pop();else u===a&&s!==r&&(t.pop(),t.push(jQuery(document.createElement(s)).appendTo(t[t.length-1]).get(0)));a=u,r=s,e.subWikify(jQuery(document.createElement("li")).appendTo(t[t.length-1]).get(0),this.terminator)}}while(n)}},{name:"quoteByBlock",match:"^<<<\\n",terminator:"^<<<\\n",handler:function(e){e.subWikify(jQuery(document.createElement("blockquote")).appendTo(e.output).get(0),this.terminator)}},{name:"quoteByLine",match:"^>+",lookahead:/^>+/gm,terminator:"\\n",element:"blockquote",handler:function(e){var t=[e.output],r=0,a=e.matchLength,n=void 0,i=void 0;do{if(a>r)for(i=r;i<a;++i)t.push(jQuery(document.createElement(this.element)).appendTo(t[t.length-1]).get(0));else if(a<r)for(i=r;i>a;--i)t.pop();r=a,e.subWikify(t[t.length-1],this.terminator),jQuery(document.createElement("br")).appendTo(t[t.length-1]),this.lookahead.lastIndex=e.nextMatch;var o=this.lookahead.exec(e.source);n=o&&o.index===e.nextMatch,n&&(a=o[0].length,e.nextMatch+=o[0].length)}while(n)}},{name:"html",match:"<[Hh][Tt][Mm][Ll]>",lookahead:/<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/gm,handler:function(e){this.lookahead.lastIndex=e.matchStart;var t=this.lookahead.exec(e.source);t&&t.index===e.matchStart&&(e.nextMatch=this.lookahead.lastIndex,jQuery(document.createDocumentFragment()).append(t[1]).appendTo(e.output))}},{name:"commentByBlock",match:"(?:/(?:%|\\*))|(?:<!--)",lookahead:/(?:\/(%|\*)(?:(?:.|\n)*?)\1\/)|(?:<!--(?:(?:.|\n)*?)-->)/gm,handler:function(e){this.lookahead.lastIndex=e.matchStart;var t=this.lookahead.exec(e.source);t&&t.index===e.matchStart&&(e.nextMatch=this.lookahead.lastIndex)}},{name:"lineContinuation",match:"\\\\"+Patterns.space+"*?(?:\\n|$)|(?:^|\\n)"+Patterns.space+"*?\\\\",handler:function(e){e.nextMatch=e.matchStart+e.matchLength}},{name:"lineBreak",match:"\\n|<br\\s*/?>",handler:function(e){0!==e._nobr.length&&e._nobr[0]||jQuery(document.createElement("br")).appendTo(e.output)}},{name:"htmlCharacterReference",match:"(?:(?:&#?[0-9A-Za-z]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9A-Fa-f]|1D[C-Fc-f][0-9A-Fa-f]|20[D-Fd-f][0-9A-Fa-f]|FE2[0-9A-Fa-f])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[0-9A-Za-z]{2,8};)",handler:function(e){jQuery(document.createDocumentFragment()).append(e.matchText).appendTo(e.output)}},{name:"htmlTag",match:"<\\w+(?:\\s+[^\\u0000-\\u001F\\u007F-\\u009F\\s\"'>\\/=]+(?:\\s*=\\s*(?:\"[^\"]*?\"|'[^']*?'|[^\\s\"'=<>`]+))?)*\\s*\\/?>",tagPattern:"<(\\w+)",voidElements:["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],nobrElements:["colgroup","datalist","dl","figure","ol","optgroup","select","table","tbody","tfoot","thead","tr","ul"],handler:function(e){var t=new RegExp(this.tagPattern).exec(e.matchText),r=t&&t[1],a=r&&r.toLowerCase();if(a){var n=this.voidElements.includes(a),i=this.nobrElements.includes(a),o=void 0,s=void 0;if(!n){o="<\\/"+a+"\\s*>";var u=new RegExp(o,"gim");u.lastIndex=e.matchStart,s=u.exec(e.source)}if(n||s){var l=e.output,c=document.createElement(e.output.tagName),d=void 0;for(c.innerHTML=e.matchText;c.firstChild;)c=c.firstChild;if(c.hasAttribute("data-passage")&&(this.processDataAttributes(c),Config.debug&&(d=new DebugView(e.output,"html-"+a,a,e.matchText),d.modes({block:"img"===a,nonvoid:s}),l=d.output)),s){i?e._nobr.unshift(!0):e._nobr.length>0&&e._nobr.unshift(!1);try{e.subWikify(c,o,!0),d&&jQuery(c).find(".debug.block").length>0&&d.modes({block:!0})}finally{e._nobr.length>0&&e._nobr.shift()}}l.appendChild(c)}else throwError(e.output,'HTML tag "'+r+'" is not closed',e.matchText+"…")}},processDataAttributes:function(e){var r=e.getAttribute("data-passage");if(null!=r){var a=t.helpers.evalPassageId(r);a!==r&&(r=a,e.setAttribute("data-passage",a)),""!==r&&("IMG"===e.tagName.toUpperCase()?"data:"!==r.slice(0,5)&&Story.has(r)&&(r=Story.get(r),r.tags.includes("Twine.image")&&(e.src=r.text.trim())):!function(){var t=e.getAttribute("data-setter"),a=void 0;null!=t&&(t=String(t).trim(),""!==t&&(a=function(e){return function(){return Scripting.evalJavaScript(e)}}(Scripting.parse(t)))),Story.has(r)?(e.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(r)&&e.classList.add("link-visited")):e.classList.add("link-broken"),jQuery(e).ariaClick({one:!0},function(){"function"==typeof a&&a.call(this),Engine.play(r)})}())}}}]}),t}(),Macro=function(){function e(t,r,n){if(Array.isArray(t))return void t.forEach(function(t){return e(t,r,n)});if(a(t))throw new Error("cannot clobber existing macro <<"+t+">>");if(u(t))throw new Error(String.format("cannot clobber child tag <<{0}>> of parent macro{1} <<{2}>>",t,1===d[t].length?"":"s",d[t].join(">>, <<")));try{if("object"===("undefined"==typeof r?"undefined":_typeof(r)))c[t]=n?clone(r):r;else{if(!a(r))throw new Error("cannot create alias of nonexistent macro <<"+r+">>");c[t]=n?clone(c[r]):c[r]}Object.defineProperty(c,t,{writable:!1}),c[t]._MACRO_API=!0}catch(e){throw"TypeError"===e.name?new Error("cannot clobber protected macro <<"+t+">>"):new Error("unknown error when attempting to add macro <<"+t+">>: ["+e.name+"] "+e.message)}if(c[t].hasOwnProperty("tags"))if(null==c[t].tags)o(t);else{if(!Array.isArray(c[t].tags))throw new Error('bad value for "tags" property of macro <<'+t+">>");o(t,c[t].tags)}}function t(e){if(Array.isArray(e))return void e.forEach(function(e){return t(e)});if(a(e)){c[e].hasOwnProperty("tags")&&s(e);try{Object.defineProperty(c,e,{writable:!0}),delete c[e]}catch(t){throw new Error("unknown error removing macro <<"+e+">>: "+t.message)}}else if(u(e))throw new Error("cannot remove child tag <<"+e+">> of parent macro <<"+d[e]+">>")}function r(){return 0===Object.keys(c).length}function a(e){return c.hasOwnProperty(e)}function n(e){var t=null;return a(e)&&"function"==typeof c[e].handler?t=c[e]:macros.hasOwnProperty(e)&&"function"==typeof macros[e].handler&&(t=macros[e]),t}function i(){var e=arguments.length<=0||arguments[0]===undefined?"init":arguments[0];Object.keys(c).forEach(function(t){"function"==typeof c[t][e]&&c[t][e](t)}),Object.keys(macros).forEach(function(t){"function"==typeof macros[t][e]&&macros[t][e](t)})}function o(e,t){if(!e)throw new Error("no parent specified");for(var r=["/"+e,"end"+e],n=[].concat(r,Array.isArray(t)?t:[]),i=0;i<n.length;++i){var o=n[i];if(a(o))throw new Error("cannot register tag for an existing macro");u(o)?d[o].includes(e)||(d[o].push(e),d[o].sort()):d[o]=[e]}}function s(e){if(!e)throw new Error("no parent specified");Object.keys(d).forEach(function(t){var r=d[t].indexOf(e);r!==-1&&(1===d[t].length?delete d[t]:d[t].splice(r,1))})}function u(e){return d.hasOwnProperty(e)}function l(e){return u(e)?d[e]:null}var c={},d={};return Object.freeze(Object.defineProperties({},{add:{value:e},delete:{value:t},isEmpty:{value:r},has:{value:a},get:{value:n},init:{value:i},tags:{value:Object.freeze(Object.defineProperties({},{register:{value:o},unregister:{value:s},has:{value:u},get:{value:l}}))},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),MacroContext=function(){var e=function(){function e(t){_classCallCheck(this,e);var r=Object.assign({parent:null,macro:null,name:"",args:null,payload:null,parser:null,source:""},t);if(null===r.macro||""===r.name||null===r.parser)throw new TypeError("context object missing required properties");Object.defineProperties(this,{parent:{value:r.parent},self:{value:r.macro},name:{value:r.name},args:{value:r.args},payload:{value:r.payload},source:{value:r.source},parser:{value:r.parser},_output:{value:r.parser.output},_debugView:{writable:!0,value:null},_debugViewEnabled:{writable:!0,value:Config.debug}})}return _createClass(e,[{key:"contextHas",value:function(e){for(var t=this;null!==(t=t.parent);)if(e(t))return!0;return!1}},{key:"contextSelect",value:function(e){for(var t=this;null!==(t=t.parent);)if(e(t))return t;return null}},{key:"contextSelectAll",value:function(e){for(var t=[],r=this;null!==(r=r.parent);)e(r)&&t.push(r);return t}},{key:"createDebugView",value:function(e,t){return this._debugView=new DebugView(this._output,"macro",e?e:this.name,t?t:this.source),null!==this.payload&&this.payload.length>0&&this._debugView.modes({nonvoid:!0}),this._debugViewEnabled=!0,this._debugView}},{key:"removeDebugView",value:function(){null!==this._debugView&&(this._debugView.remove(),this._debugView=null),this._debugViewEnabled=!1}},{key:"error",value:function(e,t){return throwError(this._output,"<<"+this.name+">>: "+e,t?t:this.source)}},{key:"output",get:function(){return this._debugViewEnabled?this.debugView.output:this._output}},{key:"debugView",get:function(){return this._debugViewEnabled?null!==this._debugView?this._debugView:this.createDebugView():null}}]),e}();return e}();!function(){function e(e,t,r,a){return function(){if(t||"function"==typeof r){var n=void 0;try{"undefined"!=typeof e&&(State.variables.hasOwnProperty("args")&&(n=State.variables.args),State.variables.args=e),t&&Wikifier.wikifyEval(t),"function"==typeof r&&r.call(this)}finally{"undefined"!=typeof e&&("undefined"!=typeof n?State.variables.args=n:delete State.variables.args)}}null!=a&&Engine.play(a)}}Macro.add("set",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(e){return this.error("bad evaluation: "+e.message)}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("unset",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no story/temporary variable list specified");for(var e=new RegExp("(?:(State\\.variables)|(TempVariables))\\.("+Wikifier.textPrimitives.identifier+")","g"),t=void 0;null!==(t=e.exec(this.args.full));){var r=t[1]?State.variables:TempVariables,a=t[3];r.hasOwnProperty(a)&&delete r[a]}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remember",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(e){return this.error("bad evaluation: "+e.message)}for(var e=storage.get("remember")||{},t=new RegExp("State\\.variables\\.("+Wikifier.textPrimitives.identifier+")","g"),r=void 0;null!==(r=t.exec(this.args.full));){var a=r[1];e[a]=State.variables[a]}return storage.set("remember",e)?void(Config.debug&&this.debugView.modes({hidden:!0})):this.error("unknown error, cannot remember: "+this.args.raw)},init:function(){var e=storage.get("remember");e&&Object.keys(e).forEach(function(t){return State.variables[t]=e[t]})}}),Macro.add("forget",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no story variable list specified");for(var e=storage.get("remember"),t=new RegExp("State\\.variables\\.("+Wikifier.textPrimitives.identifier+")","g"),r=void 0,a=!1;null!==(r=t.exec(this.args.full));){
var n=r[1];State.variables.hasOwnProperty(n)&&delete State.variables[n],e&&e.hasOwnProperty(n)&&(a=!0,delete e[n])}return a&&!storage.set("remember",e)?this.error("unknown error, cannot update remember store"):void(Config.debug&&this.debugView.modes({hidden:!0}))}}),Macro.add("run","set"),Macro.add("script",{skipArgs:!0,tags:null,handler:function(){var e=document.createDocumentFragment();try{Scripting.evalJavaScript(this.payload[0].contents,e),Config.debug&&this.createDebugView(this.name,this.source+this.payload[0].contents+"<</"+this.name+">>")}catch(e){return this.error("bad evaluation: "+e.message,this.source+this.payload[0].contents+"<</"+this.name+">>")}e.hasChildNodes()&&this.output.appendChild(e)}}),Macro.add("display",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var e=void 0;if(e="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],!Story.has(e))return this.error('passage "'+e+'" does not exist');Config.debug&&this.debugView.modes({block:!0}),e=Story.get(e);var t=void 0;t=this.args[1]?jQuery(document.createElement(this.args[1])).addClass(e.domId+" macro-"+this.name).attr("data-passage",e.title).appendTo(this.output):jQuery(this.output),t.wiki(e.processText())}}),Macro.add("nobr",{skipArgs:!0,tags:null,handler:function(){new Wikifier(this.output,this.payload[0].contents.replace(/^\n+|\n+$/g,"").replace(/\n+/g," "))}}),Macro.add(["print","=","-"],{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{var e=toStringOrDefault(Scripting.evalJavaScript(this.args.full),null);null!==e&&new Wikifier(this.output,"-"===this.name?Util.escape(e):e)}catch(e){return this.error("bad evaluation: "+e.message)}}}),Macro.add("silently",{skipArgs:!0,tags:null,handler:function(){var e=document.createDocumentFragment();if(new Wikifier(e,this.payload[0].contents.trim()),Config.debug)this.debugView.modes({hidden:!0}),this.output.appendChild(e);else{var t=[].concat(_toConsumableArray(e.querySelectorAll(".error"))).map(function(e){return e.textContent});if(t.length>0)return this.error("error"+(1===t.length?"":"s")+" within contents ("+t.join("; ")+")",this.source+this.payload[0].contents+"<</"+this.name+">>")}}}),Macro.add("if",{skipArgs:!0,tags:["elseif","else"],handler:function(){var e=0;try{for(var t=Scripting.evalJavaScript,r=this.payload.length,a=!1;e<r;++e){switch(this.payload[e].name){case"else":if(e+1!==r)return this.error("<<else>> must be the final clause");if(this.payload[e].args.raw.length>0)return/^\s*if\b/i.test(this.payload[e].args.raw)?this.error('whitespace is not allowed between the "else" and "if" in <<elseif>> clause'+(e>0?" (#"+e+")":"")):this.error("<<else>> does not accept a conditional expression (perhaps you meant to use <<elseif>>), invalid: "+this.payload[e].args.raw);break;default:if(0===this.payload[e].args.full.length)return this.error("no conditional expression specified for <<"+this.payload[e].name+">> clause"+(e>0?" (#"+e+")":""));if(Config.macros.ifAssignmentError&&/[^!=&^|<>*\/%+-]=[^=]/.test(this.payload[e].args.full))return this.error("assignment operator found within <<"+this.payload[e].name+">> clause"+(e>0?" (#"+e+")":"")+" (perhaps you meant to use an equality operator: ==, ===, eq, is), invalid: "+this.payload[e].args.raw)}if(Config.debug&&this.createDebugView(this.payload[e].name,this.payload[e].source).modes({nonvoid:!1}),"else"===this.payload[e].name||t(this.payload[e].args.full)){a=!0,new Wikifier(this.output,this.payload[e].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++e;e<r;++e)this.createDebugView(this.payload[e].name,this.payload[e].source).modes({nonvoid:!1,hidden:!0,invalid:!0});this.createDebugView("/"+this.name,"<</"+this.name+">>").modes({nonvoid:!1,hidden:!a,invalid:!a})}}catch(t){return this.error("bad conditional expression in <<"+(0===e?"if":"elseif")+">> clause"+(e>0?" (#"+e+")":"")+": "+t.message)}}}),Macro.add("switch",{skipArg0:!0,tags:["case","default"],handler:function(){if(0===this.args.full.length)return this.error("no expression specified");var e=this.payload.length,t=void 0;if(1===e)return this.error("no cases specified");try{t=Scripting.evalJavaScript(this.args.full)}catch(e){return this.error("bad evaluation: "+e.message)}var r=this.debugView,a=1,n=!1;for(Config.debug&&r.modes({nonvoid:!1,hidden:!0});a<e;++a){switch(this.payload[a].name){case"default":if(a+1!==e)return this.error("<<default>> must be the final case");if(this.payload[a].args.length>0)return this.error("<<default>> does not accept values, invalid: "+this.payload[a].args.raw);break;default:if(0===this.payload[a].args.length)return this.error("no value(s) specified for <<"+this.payload[a].name+">> (#"+a+")")}if(Config.debug&&this.createDebugView(this.payload[a].name,this.payload[a].source).modes({nonvoid:!1}),"default"===this.payload[a].name||this.payload[a].args.some(function(e){return e===t})){n=!0,new Wikifier(this.output,this.payload[a].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++a;a<e;++a)this.createDebugView(this.payload[a].name,this.payload[a].source).modes({nonvoid:!1,hidden:!0,invalid:!0});r.modes({nonvoid:!1,hidden:!0,invalid:!n}),this.createDebugView("/"+this.name,"<</"+this.name+">>").modes({nonvoid:!1,hidden:!0,invalid:!n})}}}),Macro.add("for",{skipArgs:!0,tags:null,handler:function(){var e=Scripting.evalJavaScript,t=this.payload[0].contents.replace(/\n$/,""),r=void 0,a=this.args.full.trim(),n=void 0,i=!0,o=Config.macros.maxLoopIterations;if(0===a.length)a=!0;else if(a.indexOf(";")!==-1){var s=a.match(/^([^;]*?)\s*;\s*([^;]*?)\s*;\s*([^;]*?)$/);if(null===s)return this.error("invalid 3-part syntax, format: init ; condition ; post");r=s[1],a=s[2],n=s[3]}Config.debug&&this.debugView.modes({block:!0});try{if(TempState.break=null,r)try{e(r)}catch(e){return this.error("bad init expression: "+e.message)}for(;e(a);){if(--o<0)return this.error("exceeded configured maximum loop iterations ("+Config.macros.maxLoopIterations+")");if(new Wikifier(this.output,i?t.replace(/^\n/,""):t),i&&(i=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}if(n)try{e(n)}catch(e){return this.error("bad post expression: "+e.message)}}}catch(e){return this.error("bad conditional expression: "+e.message)}finally{TempState.break=null}}}),Macro.add(["break","continue"],{skipArgs:!0,handler:function(){return this.contextHas(function(e){return"for"===e.name})?(TempState.break="continue"===this.name?1:2,void(Config.debug&&this.debugView.modes({hidden:!0}))):this.error("must only be used in conjunction with its parent macro <<for>>")}}),Macro.add(["button","link"],{tags:null,handler:function(){var t=this;if(0===this.args.length)return this.error("no "+("button"===this.name?"button":"link")+" text specified");Config.debug&&this.createDebugView(this.name,this.source+this.payload[0].contents+"<</"+this.name+">>");var r=jQuery(document.createElement("button"===this.name?"button":"a")),a=function(){var e=void 0;return State.variables.hasOwnProperty("args")&&t.contextHas(function(e){return e.self.isWidget})&&(e=State.variables.args),e}(),n=void 0;if("object"===_typeof(this.args[0]))if(this.args[0].isImage){var i=jQuery(document.createElement("img")).attr("src",this.args[0].source).appendTo(r);this.args[0].hasOwnProperty("passage")&&i.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&i.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&i.attr("align",this.args[0].align),this.args[0].hasOwnProperty("link")&&(n=this.args[0].link),n=this.args[0].link}else r.append(document.createTextNode(this.args[0].text)),n=this.args[0].link;else r.wiki(this.args[0]),n=this.args.length>1?this.args[1]:undefined;null!=n?(r.attr("data-passage",n),Story.has(n)?(r.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(n)&&r.addClass("link-visited")):r.addClass("link-broken")):r.addClass("link-internal"),r.addClass("macro-"+this.name).ariaClick({namespace:".macros",one:null!=n},e(a,this.payload[0].contents.trim(),null,n)).appendTo(this.output)}}),Macro.add("checkbox",{handler:function(){if(this.args.length<3){var e=[];return this.args.length<1&&e.push("story variable name"),this.args.length<2&&e.push("unchecked value"),this.args.length<3&&e.push("checked value"),this.error("no "+e.join(" or ")+" specified")}if("string"!=typeof this.args[0]||"$"!==this.args[0].trim()[0])return this.error('story variable name "'+this.args[0]+'" is missing its sigil ($)');var t=this.args[0].trim(),r=Util.slugify(t),a=this.args[1],n=this.args[2],i=document.createElement("input");jQuery(i).attr({id:this.name+"-"+r,name:this.name+"-"+r,type:"checkbox",tabindex:0}).addClass("macro-"+this.name).on("change",function(){Wikifier.setValue(t,this.checked?n:a)}).appendTo(this.output),this.args.length>3&&"checked"===this.args[3]?(i.checked=!0,Wikifier.setValue(t,n)):Wikifier.setValue(t,a)}}),Macro.add(["linkappend","linkprepend","linkreplace"],{tags:null,handler:function(){var t=this;if(0===this.args.length)return this.error("no link text specified");Config.debug&&this.createDebugView(this.name,this.source+this.payload[0].contents+"<</"+this.name+">>");var r=jQuery(document.createElement("a")),a=jQuery(document.createElement("span")),n=this.args.length>1&&/^(?:transition|t8n)$/.test(this.args[1]),i=function(){var e=void 0;return State.variables.hasOwnProperty("args")&&t.contextHas(function(e){return e.self.isWidget})&&(e=State.variables.args),e}();r.wiki(this.args[0]).addClass("link-internal macro-"+this.name).ariaClick({namespace:".macros",one:!0},e(i,null,function(){if("linkreplace"===t.name?r.remove():r.wrap('<span class="macro-'+t.name+'"></span>').replaceWith(function(){return r.html()}),""!==t.payload[0].contents){var e=document.createDocumentFragment();new Wikifier(e,t.payload[0].contents),a.append(e)}n&&setTimeout(function(){return a.removeClass("macro-"+t.name+"-in")},Engine.minDomActionDelay)})).appendTo(this.output),a.addClass("macro-"+this.name+"-insert"),n&&a.addClass("macro-"+this.name+"-in"),"linkprepend"===this.name?a.insertBefore(r):a.insertAfter(r)}}),Macro.add("radiobutton",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("story variable name"),this.args.length<2&&e.push("checked value"),this.error("no "+e.join(" or ")+" specified")}if("string"!=typeof this.args[0]||"$"!==this.args[0].trim()[0])return this.error('story variable name "'+this.args[0]+'" is missing its sigil ($)');var t=this.args[0].trim(),r=Util.slugify(t),a=this.args[1],n=document.createElement("input");TempState.hasOwnProperty(this.name)||(TempState[this.name]={},TempState[this.name][r]=0),jQuery(n).attr({id:this.name+"-"+r+"-"+TempState[this.name][r]++,name:this.name+"-"+r,type:"radio",tabindex:0}).addClass("macro-"+this.name).on("change",function(){this.checked&&Wikifier.setValue(t,a)}).appendTo(this.output),this.args.length>2&&"checked"===this.args[2]&&(n.checked=!0,Wikifier.setValue(t,a))}}),Macro.add("textarea",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("story variable name"),this.args.length<2&&e.push("default value"),this.error("no "+e.join(" or ")+" specified")}if("string"!=typeof this.args[0]||"$"!==this.args[0].trim()[0])return this.error('story variable name "'+this.args[0]+'" is missing its sigil ($)');Config.debug&&this.debugView.modes({block:!0});var t=this.args[0].trim(),r=Util.slugify(t),a=this.args[1],n="autofocus"===this.args[2],i=document.createElement("textarea");jQuery(i).attr({id:this.name+"-"+r,name:this.name+"-"+r,rows:4,tabindex:0}).addClass("macro-"+this.name).on("change",function(){Wikifier.setValue(t,this.value)}).appendTo(this.output),Wikifier.setValue(t,a),i.textContent=a,n&&(i.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:"+i.id]=function(e){setTimeout(function(){return i.focus()},Engine.minDomActionDelay),delete postdisplay[e]})}}),Macro.add("textbox",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("story variable name"),this.args.length<2&&e.push("default value"),this.error("no "+e.join(" or ")+" specified")}if("string"!=typeof this.args[0]||"$"!==this.args[0].trim()[0])return this.error('story variable name "'+this.args[0]+'" is missing its sigil ($)');Config.debug&&this.debugView.modes({block:!0});var t=this.args[0].trim(),r=Util.slugify(t),a=this.args[1],n=document.createElement("input"),i=!1,o=void 0;this.args.length>3?(o=this.args[2],i="autofocus"===this.args[3]):this.args.length>2&&("autofocus"===this.args[2]?i=!0:o=this.args[2]),jQuery(n).attr({id:this.name+"-"+r,name:this.name+"-"+r,type:"text",tabindex:0}).addClass("macro-"+this.name).on("change",function(){Wikifier.setValue(t,this.value)}).on("keypress",function(e){13===e.which&&(e.preventDefault(),Wikifier.setValue(t,this.value),null!=o&&Engine.play(o))}).appendTo(this.output),Wikifier.setValue(t,a),n.value=a,i&&(n.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:"+n.id]=function(e){setTimeout(function(){return n.focus()},Engine.minDomActionDelay),delete postdisplay[e]})}}),Macro.add("click","link"),Macro.add("actions",{handler:function(){var e=jQuery(document.createElement("ul")).addClass(this.name).appendTo(this.output);State.variables["#actions"]||(State.variables["#actions"]={});for(var t=0;t<this.args.length;++t){var r=void 0,a=void 0,n=void 0,i=void 0;"object"===_typeof(this.args[t])?this.args[t].isImage?(n=jQuery(document.createElement("img")).attr("src",this.args[t].source),this.args[t].hasOwnProperty("passage")&&n.attr("data-passage",this.args[t].passage),this.args[t].hasOwnProperty("title")&&n.attr("title",this.args[t].title),this.args[t].hasOwnProperty("align")&&n.attr("align",this.args[t].align),r=this.args[t].link,i=this.args[t].setFn):(a=this.args[t].text,r=this.args[t].link,i=this.args[t].setFn):a=r=this.args[t],State.variables["#actions"].hasOwnProperty(r)&&State.variables["#actions"][r]||jQuery(Wikifier.createInternalLink(jQuery(document.createElement("li")).appendTo(e),r,null,function(e,t){return function(){State.variables["#actions"][e]=!0,"function"==typeof t&&t()}}(r,i))).addClass("macro-"+this.name).append(n||document.createTextNode(a))}}}),Macro.add(["back","return"],{handler:function(){if(this.args.length>1)return this.error("too many arguments specified, check the documentation for details");var e=-1,t=void 0,r=void 0,a=void 0;if(1===this.args.length&&("object"===_typeof(this.args[0])?this.args[0].isImage?(a=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&a.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&a.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&a.attr("align",this.args[0].align),this.args[0].hasOwnProperty("link")&&(t=this.args[0].link)):1===this.args[0].count?t=this.args[0].link:(r=this.args[0].text,t=this.args[0].link):1===this.args.length&&(r=this.args[0])),null==t){for(var n=State.length-2;n>=0;--n)if(State.history[n].title!==State.passage){e=n,t=State.history[n].title;break}if(null==t&&"return"===this.name)for(var i=State.expired.length-1;i>=0;--i)if(State.expired[i]!==State.passage){t=State.expired[i];break}}else{if(!Story.has(t))return this.error('passage "'+t+'" does not exist');if("back"===this.name){for(var o=State.length-2;o>=0;--o)if(State.history[o].title===t){e=o;break}if(e===-1)return this.error('cannot find passage "'+t+'" in the current story history')}}if(null==t)return this.error("cannot find passage");var s=void 0;s="back"!==this.name||e!==-1?jQuery(document.createElement("a")).addClass("link-internal").ariaClick({one:!0},"return"===this.name?function(){return Engine.play(t)}:function(){return Engine.goTo(e)}):jQuery(document.createElement("span")).addClass("link-disabled"),s.addClass("macro-"+this.name).append(a||document.createTextNode(r||L10n.get("macro"+this.name.toUpperFirst()+"Text"))).appendTo(this.output)}}),Macro.add("choice",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var e=State.passage,t=void 0,r=void 0,a=void 0,n=void 0;if(1===this.args.length?"object"===_typeof(this.args[0])?this.args[0].isImage?(a=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&a.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&a.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&a.attr("align",this.args[0].align),t=this.args[0].link,n=this.args[0].setFn):(r=this.args[0].text,t=this.args[0].link,n=this.args[0].setFn):r=t=this.args[0]:(t=this.args[0],r=this.args[1]),State.variables.hasOwnProperty("#choice")){if(State.variables["#choice"].hasOwnProperty(e)&&State.variables["#choice"][e])return void jQuery(document.createElement("span")).addClass("link-disabled macro-"+this.name).attr("tabindex",-1).append(a||document.createTextNode(r)).appendTo(this.output)}else State.variables["#choice"]={};jQuery(Wikifier.createInternalLink(this.output,t,null,function(){State.variables["#choice"][e]=!0,"function"==typeof n&&n()})).addClass("macro-"+this.name).append(a||document.createTextNode(r))}}),Macro.add(["addclass","toggleclass"],{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("selector"),this.args.length<2&&e.push("class names"),this.error("no "+e.join(" or ")+" specified")}var t=jQuery(this.args[0]);if(0===t.length)return this.error('no elements matched the selector "'+this.args[0]+'"');switch(this.name){case"addclass":t.addClass(this.args[1].trim());break;case"toggleclass":t.toggleClass(this.args[1].trim())}}}),Macro.add("removeclass",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);return 0===e.length?this.error('no elements matched the selector "'+this.args[0]+'"'):void(this.args.length>1?e.removeClass(this.args[1].trim()):e.removeClass())}}),Macro.add("copy",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);return 0===e.length?this.error('no elements matched the selector "'+this.args[0]+'"'):void jQuery(this.output).append(e.html())}}),Macro.add(["append","prepend","replace"],{tags:null,handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);if(0===e.length)return this.error('no elements matched the selector "'+this.args[0]+'"');if(""!==this.payload[0].contents){var t=document.createDocumentFragment();switch(new Wikifier(t,this.payload[0].contents),this.name){case"replace":e.empty();case"append":e.append(t);break;case"prepend":e.prepend(t)}}else"replace"===this.name&&e.empty()}}),Macro.add("remove",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);return 0===e.length?this.error('no elements matched the selector "'+this.args[0]+'"'):void e.remove()}}),Has.audio?(Macro.add("audio",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("track ID"),this.args.length<2&&e.push("actions"),this.error("no "+e.join(" or ")+" specified")}var t=Macro.get("cacheaudio").tracks,r=[":all",":looped",":muted",":paused",":playing"],a=String(this.args[0]).trim();if(!r.includes(a)&&!t.hasOwnProperty(a))return this.error('track "'+a+'" does not exist');for(var n=this.args.slice(1),i=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=5,h=void 0,p=void 0;n.length>0;){var f=n.shift();switch(f){case"play":case"pause":case"stop":i=f;break;case"fadein":i="fade",c=1;break;case"fadeout":i="fade",c=0;break;case"fadeto":if(0===n.length)return this.error("fadeto missing required level value");if(i="fade",p=n.shift(),c=Number.parseFloat(p),Number.isNaN(c)||!Number.isFinite(c))return this.error("cannot parse fadeto: "+p);break;case"fadeoverto":if(n.length<2){var g=[];return n.length<1&&g.push("seconds"),n.length<2&&g.push("level"),this.error("fadeoverto missing required "+g.join(" and ")+" value"+(g.length>1?"s":""))}if(i="fade",p=n.shift(),d=Number.parseFloat(p),Number.isNaN(d)||!Number.isFinite(d))return this.error("cannot parse fadeoverto: "+p);if(p=n.shift(),c=Number.parseFloat(p),Number.isNaN(c)||!Number.isFinite(c))return this.error("cannot parse fadeoverto: "+p);break;case"volume":if(0===n.length)return this.error("volume missing required level value");if(p=n.shift(),o=Number.parseFloat(p),Number.isNaN(o)||!Number.isFinite(o))return this.error("cannot parse volume: "+p);break;case"mute":case"unmute":s="mute"===f;break;case"time":if(0===n.length)return this.error("time missing required seconds value");if(p=n.shift(),u=Number.parseFloat(p),Number.isNaN(u)||!Number.isFinite(u))return this.error("cannot parse time: "+p);break;case"loop":case"unloop":l="loop"===f;break;case"goto":if(0===n.length)return this.error("goto missing required passage title");if(p=n.shift(),h="object"===("undefined"==typeof p?"undefined":_typeof(p))?p.link:p,!Story.has(h))return this.error('passage "'+h+'" does not exist');break;default:return this.error("unknown action: "+f)}}var m=void 0;switch(a){case":all":m=Object.keys(t);break;case":looped":m=Object.keys(t).filter(function(e){return t[e].isLooped()});break;case":muted":m=Object.keys(t).filter(function(e){return t[e].isMuted()});break;case":paused":m=Object.keys(t).filter(function(e){return t[e].isPaused()});break;case":playing":m=Object.keys(t).filter(function(e){return t[e].isPlaying()});break;default:m=[a]}try{m.forEach(function(e){var r=t[e];switch(null!=o&&(r.volume=o),null!=u&&(r.time=u),null!=s&&(r.mute=s),null!=l&&(r.loop=l),null!=h&&r.one("end",function(){return Engine.play(h)}),i){case"play":r.play();break;case"pause":r.pause();break;case"stop":r.stop();break;case"fade":r.fadeWithDuration(d,c)}}),Config.debug&&this.createDebugView()}catch(e){return this.error("error executing audio action: "+e.message)}}}),Macro.add("cacheaudio",{tracks:{},handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("track ID"),this.args.length<2&&e.push("sources"),this.error("no "+e.join(" or ")+" specified")}var t=String(this.args[0]).trim(),r=/^:|\s/;if(r.test(t))return this.error('invalid track ID "'+t+'": track IDs may not start with a colon or contain whitespace');var a=/^format:\s*([\w-]+)\s*;\s*(\S.*)$/i,n=void 0;try{n=SimpleAudio.create(this.args.slice(1).map(function(e){var t=a.exec(e);return null===t?e:{format:t[1],src:t[2]}}))}catch(e){return this.error('error during track initialization for "'+t+'": '+e.message)}if(Config.debug&&!n.hasSource())return this.error('no supported audio sources found for "'+t+'"');var i=this.self.tracks;i.hasOwnProperty(t)&&i[t].destroy(),i[t]=n,Config.debug&&this.createDebugView()}}),Macro.add("createplaylist",{tags:["track"],lists:{},handler:function(){if(0===this.args.length)return this.error("no list ID specified");var e=Macro.get("playlist");if(null!==e.from&&"createplaylist"!==e.from)return this.error("a playlist has already been defined with <<setplaylist>>");var t=Macro.get("cacheaudio").tracks,r=String(this.args[0]).trim(),a=/^:|\s/;if(a.test(r))return this.error('invalid list ID "'+r+'": list IDs may not start with a colon or contain whitespace');if(1===this.payload.length)return this.error("no tracks defined via <<track>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var n=SimpleAudio.createList(),i=1,o=this.payload.length;i<o;++i){if(this.payload[i].args.length<2){var s=[];return this.payload[i].args.length<1&&s.push("track ID"),this.payload[i].args.length<2&&s.push("actions"),this.error("no "+s.join(" or ")+" specified")}var u=String(this.payload[i].args[0]).trim();if(!t.hasOwnProperty(u))return this.error('track "'+u+'" does not exist');for(var l=this.payload[i].args.slice(1),c=!1,d=void 0;l.length>0;){var h=l.shift(),p=void 0;switch(h){case"copy":c=!0;break;case"rate":l.length>0&&l.shift();break;case"volume":if(0===l.length)return this.error("volume missing required level value");if(p=l.shift(),d=Number.parseFloat(p),Number.isNaN(d)||!Number.isFinite(d))return this.error("cannot parse volume: "+p);break;default:return this.error("unknown action: "+h)}}var f=t[u];n.add({copy:c,track:f,volume:null!=d?d:f.volume}),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}var g=this.self.lists;g.hasOwnProperty(r)&&g[r].destroy(),g[r]=n,null===e.from&&(e.from="createplaylist"),this.createDebugView("/"+this.name,"<</"+this.name+">>").modes({nonvoid:!1,hidden:!0})}}),Macro.add("masteraudio",{handler:function(){if(0===this.args.length)return this.error("no actions specified");for(var e=this.args.slice(0),t=!1,r=void 0,a=void 0;e.length>0;){var n=e.shift(),i=void 0;switch(n){case"stop":t=!0;break;case"mute":case"unmute":r="mute"===n;break;case"volume":if(0===e.length)return this.error("volume missing required level value");if(i=e.shift(),a=Number.parseFloat(i),Number.isNaN(a)||!Number.isFinite(a))return this.error("cannot parse volume: "+i);break;default:return this.error("unknown action: "+n)}}try{null!=r&&(SimpleAudio.mute=r),null!=a&&(SimpleAudio.volume=a),t&&SimpleAudio.stop(),Config.debug&&this.createDebugView()}catch(e){return this.error("error executing master audio action: "+e.message)}}}),Macro.add("playlist",{from:null,handler:function(){var e=this.self.from;if(null===e)return this.error("no playlists have been created");var t=void 0,r=void 0;if("createplaylist"===e){if(this.args.length<2){var a=[];return this.args.length<1&&a.push("list ID"),this.args.length<2&&a.push("actions"),this.error("no "+a.join(" or ")+" specified")}var n=Macro.get("createplaylist").lists,i=String(this.args[0]).trim();if(!n.hasOwnProperty(i))return this.error('playlist "'+i+'" does not exist');t=n[i],r=this.args.slice(1)}else{if(0===this.args.length)return this.error("no actions specified");t=Macro.get("setplaylist").list,r=this.args.slice(0)}for(var o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=void 0,h=5,p=void 0;r.length>0;){var f=r.shift();switch(f){case"play":case"pause":case"stop":case"skip":o=f;break;case"fadein":o="fade",d=1;break;case"fadeout":o="fade",d=0;break;case"fadeto":if(0===r.length)return this.error("fadeto missing required level value");if(o="fade",p=r.shift(),d=Number.parseFloat(p),Number.isNaN(d)||!Number.isFinite(d))return this.error("cannot parse fadeto: "+p);break;case"fadeoverto":if(r.length<2){var g=[];return r.length<1&&g.push("seconds"),r.length<2&&g.push("level"),this.error("fadeoverto missing required "+g.join(" and ")+" value"+(g.length>1?"s":""))}if(o="fade",p=r.shift(),h=Number.parseFloat(p),Number.isNaN(h)||!Number.isFinite(h))return this.error("cannot parse fadeoverto: "+p);if(p=r.shift(),d=Number.parseFloat(p),Number.isNaN(d)||!Number.isFinite(d))return this.error("cannot parse fadeoverto: "+p);break;case"volume":if(0===r.length)return this.error("volume missing required level value");if(p=r.shift(),s=Number.parseFloat(p),Number.isNaN(s)||!Number.isFinite(s))return this.error("cannot parse volume: "+p);break;case"mute":case"unmute":u="mute"===f;break;case"loop":case"unloop":l="loop"===f;break;case"shuffle":case"unshuffle":c="shuffle"===f;break;default:return this.error("unknown action: "+f)}}try{switch(null!=s&&(t.volume=s),null!=u&&(t.mute=u),null!=l&&(t.loop=l),null!=c&&(t.shuffle=c),o){case"play":t.play();break;case"pause":t.pause();break;case"stop":t.stop();break;case"skip":t.skip();break;case"fade":t.fadeWithDuration(h,d)}Config.debug&&this.createDebugView()}catch(e){return this.error("error playing audio: "+e.message)}}}),Macro.add("removeplaylist",{handler:function(){if(0===this.args.length)return this.error("no list ID specified");var e=Macro.get("createplaylist").lists,t=String(this.args[0]).trim();return e.hasOwnProperty(t)?(e[t].destroy(),delete e[t],void(Config.debug&&this.createDebugView())):this.error('playlist "'+t+'" does not exist')}}),Macro.add("waitforaudio",{skipArgs:!0,queue:[],handler:function(){function e(){if(0===t.length)return LoadScreen.unlock();var r=t.shift();return r.hasData()?e():void r.one("canplay.waitforaudio error.waitforaudio",function(){jQuery(this).off(".waitforaudio"),e()}).load()}var t=this.self.queue;t.length>0||(this.self.fillQueue(t),t.length>0&&(LoadScreen.lock(),e()))},fillQueue:function(e){var t=Macro.get("cacheaudio").tracks;Object.keys(t).forEach(function(r){return e.push(t[r])});var r=Macro.get("createplaylist").lists;if(Object.keys(r).map(function(e){return r[e].tracks}).flatten().filter(function(e){return e.copy}).forEach(function(t){return e.push(t.track)}),Macro.has("setplaylist")){var a=Macro.get("setplaylist").list;null!==a&&a.tracks.forEach(function(t){return e.push(t.track)})}}}),Macro.add("setplaylist",{list:null,handler:function(){if(0===this.args.length)return this.error("no track ID(s) specified");var e=Macro.get("playlist");if(null!==e.from&&"setplaylist"!==e.from)return this.error("playlists have already been defined with <<createplaylist>>");var t=this.self,r=Macro.get("cacheaudio").tracks;null!==t.list&&t.list.destroy(),t.list=SimpleAudio.createList();for(var a=0;a<this.args.length;++a){var n=this.args[a];if(!r.hasOwnProperty(n))return this.error('track "'+n+'" does not exist');t.list.add(r[n])}null===e.from&&(e.from="setplaylist"),Config.debug&&this.createDebugView()}}),Macro.add("stopallaudio",{skipArgs:!0,handler:function(){var e=Macro.get("cacheaudio").tracks;Object.keys(e).forEach(function(t){return e[t].stop()}),Config.debug&&this.createDebugView()}})):Macro.add(["audio","cacheaudio","createplaylist","masteraudio","playlist","removeplaylist","waitforaudio","setplaylist","stopallaudio"],{skipArgs:!0,handler:function(){}}),Macro.add("goto",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var e=void 0;return e="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(e)?void setTimeout(function(){return Engine.play(e)},Engine.minDomActionDelay):this.error('passage "'+e+'" does not exist')}}),Macro.add("timed",{tags:["next"],timers:new Set,handler:function(){if(0===this.args.length)return this.error("no time value specified in <<timed>>");var e=[];try{e.push({name:this.name,source:this.source,delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0])),content:this.payload[0].contents})}catch(e){return this.error(e.message+" in <<timed>>")}if(this.payload.length>1){var t=void 0;try{var r=void 0;for(t=1,r=this.payload.length;t<r;++t)e.push({name:this.payload[t].name,source:this.payload[t].source,delay:0===this.payload[t].args.length?e[e.length-1].delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.payload[t].args[0])),content:this.payload[t].contents})}catch(e){return this.error(e.message+" in <<next>> (#"+t+")")}}Config.debug&&this.debugView.modes({block:!0}),this.self.registerTimeout(jQuery(document.createElement("span")).addClass("macro-"+this.name).appendTo(this.output),e,this.args.length>1&&/^(?:transition|t8n)$/.test(this.args[1]))},registerTimeout:function(e,t,r){var a=State.turns,n=this.timers,i=null,o=t.shift(),s=function s(){if(n.delete(i),a===State.turns){var u=o;null!=(o=t.shift())&&(i=setTimeout(s,o.delay),n.add(i));var l=document.createDocumentFragment();new Wikifier(l,u.content),Config.debug&&"next"===u.name&&(e=jQuery(new DebugView(e[0],"macro",u.name,u.source).output)),r&&(e=jQuery(document.createElement("span")).addClass("macro-timed-insert macro-timed-in").appendTo(e)),e.append(l),r&&setTimeout(function(){return e.removeClass("macro-timed-in")},Engine.minDomActionDelay)}};i=setTimeout(s,o.delay),n.add(i),prehistory.hasOwnProperty("#timed-timers-cleanup")||(prehistory["#timed-timers-cleanup"]=function(e){n.forEach(function(e){return clearTimeout(e)}),n.clear(),delete prehistory[e]})}}),Macro.add("repeat",{tags:null,timers:new Set,handler:function(){if(0===this.args.length)return this.error("no time value specified");
var e=void 0;try{e=Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0]))}catch(e){return this.error(e.message)}Config.debug&&this.debugView.modes({block:!0}),this.self.registerInterval(jQuery(document.createElement("span")).addClass("macro-"+this.name).appendTo(this.output),this.payload[0].contents,e,this.args.length>1&&/^(?:transition|t8n)$/.test(this.args[1]))},registerInterval:function(e,t,r,a){var n=State.turns,i=this.timers,o=null;o=setInterval(function(){if(n!==State.turns)return clearInterval(o),void i.delete(o);var r=void 0;try{TempState.break=null,TempState.hasOwnProperty("repeatTimerId")&&(r=TempState.repeatTimerId),TempState.repeatTimerId=o;var s=document.createDocumentFragment();new Wikifier(s,t),a&&(e=jQuery(document.createElement("span")).addClass("macro-repeat-insert macro-repeat-in").appendTo(e)),e.append(s),a&&setTimeout(function(){return e.removeClass("macro-repeat-in")},Engine.minDomActionDelay)}finally{"undefined"!=typeof r?TempState.repeatTimerId=r:delete TempState.repeatTimerId,TempState.break=null}},r),i.add(o),prehistory.hasOwnProperty("#repeat-timers-cleanup")||(prehistory["#repeat-timers-cleanup"]=function(e){i.forEach(function(e){return clearInterval(e)}),i.clear(),delete prehistory[e]})}}),Macro.add("stop",{skipArgs:!0,handler:function(){if(!TempState.hasOwnProperty("repeatTimerId"))return this.error("must only be used in conjunction with its parent macro <<repeat>>");var e=Macro.get("repeat").timers,t=TempState.repeatTimerId;clearInterval(t),e.delete(t),TempState.break=2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("widget",{tags:null,handler:function(){if(0===this.args.length)return this.error("no widget name specified");var e=this.args[0];if(Macro.has(e)){if(!Macro.get(e).isWidget)return this.error('cannot clobber existing macro "'+e+'"');Macro.delete(e)}try{Macro.add(e,{isWidget:!0,handler:function(e){return function(){var t=this,r=void 0;try{var a=function(){State.variables.hasOwnProperty("args")&&(r=State.variables.args),State.variables.args=[];for(var a=0,n=t.args.length;a<n;++a)State.variables.args[a]=t.args[a];State.variables.args.raw=t.args.raw,State.variables.args.full=t.args.full;var i=document.createDocumentFragment(),o=[];return new Wikifier(i,e),Array.from(i.querySelectorAll(".error")).forEach(function(e){o.push(e.textContent)}),0!==o.length?{v:t.error("error"+(o.length>1?"s":"")+" within widget contents ("+o.join("; ")+")")}:void t.output.appendChild(i)}();if("object"===("undefined"==typeof a?"undefined":_typeof(a)))return a.v}catch(e){return this.error("cannot execute widget: "+e.message)}finally{"undefined"!=typeof r?State.variables.args=r:delete State.variables.args}}}(this.payload[0].contents)}),Config.debug&&this.createDebugView(this.name,this.source+this.payload[0].contents+"<</"+this.name+">>")}catch(t){return this.error('cannot create widget macro "'+e+'": '+t.message)}}})}();var Dialog=function(){function e(){m=function(){var e=void 0;try{var t=document.createElement("p"),r=document.createElement("div");t.style.width="100%",t.style.height="200px",r.style.position="absolute",r.style.left="0px",r.style.top="0px",r.style.width="100px",r.style.height="100px",r.style.visibility="hidden",r.style.overflow="hidden",r.appendChild(t),document.body.appendChild(r);var a=t.offsetWidth;r.style.overflow="auto";var n=t.offsetWidth;a===n&&(n=r.clientWidth),document.body.removeChild(r),e=a-n}catch(e){}return e||17}();var e=jQuery(document.createDocumentFragment()).append('<div id="ui-overlay" class="ui-close"></div><div id="ui-dialog" tabindex="0" role="dialog" aria-labelledby="ui-dialog-title"><div id="ui-dialog-titlebar"><h1 id="ui-dialog-title"></h1>'+('<button id="ui-dialog-close" class="ui-close" tabindex="0" aria-label="'+L10n.get("close")+'"></button>')+'</div><div id="ui-dialog-body"></div></div>');d=jQuery(e.find("#ui-overlay").get(0)),h=jQuery(e.find("#ui-dialog").get(0)),p=jQuery(e.find("#ui-dialog-title").get(0)),f=jQuery(e.find("#ui-dialog-body").get(0)),e.insertBefore("#store-area")}function t(e){return h.hasClass("open")&&(!e||e.splitOrEmpty(/\s+/).every(function(e){return f.hasClass(e)}))}function r(e,t){return f.empty().removeClass(),null!=t&&f.addClass(t),p.empty().append((null!=e?String(e):"")||" "),f.get(0)}function a(){return f.get(0)}function n(){var e;return(e=f).append.apply(e,arguments),Dialog}function i(){var e;return(e=f).wiki.apply(e,arguments),Dialog}function o(e,t,r,a,n){return jQuery(e).ariaClick(function(e){e.preventDefault(),"function"==typeof r&&r(e),s(t,n),"function"==typeof a&&a(e)})}function s(e,r){var a=jQuery.extend({top:50},e),n=a.top;t()||(g=safeActiveElement()),jQuery(document.documentElement).addClass("ui-dialog-open"),d.addClass("open"),null!==f[0].querySelector("img")&&f.imagesLoaded().always(function(){return l({data:{top:n}})}),jQuery("body>:not(script,#store-area,#ui-bar,#ui-overlay,#ui-dialog)").attr("tabindex",-3).attr("aria-hidden",!0),jQuery("#ui-bar,#story").find("[tabindex]:not([tabindex^=-])").attr("tabindex",-2).attr("aria-hidden",!0);var i=c(n);return h.css(i).addClass("open").focus(),jQuery(window).on("resize.ui-resize",null,{top:n},jQuery.throttle(40,l)),jQuery(document).on("click.ui-close",".ui-close",{closeFn:r},u).on("keypress.ui-close",".ui-close",function(e){13!==e.which&&32!==e.which||jQuery(this).trigger("click")}),setTimeout(function(){return jQuery.event.trigger("tw:dialogopened")},Engine.minDomActionDelay),Dialog}function u(e){return jQuery(document).off(".ui-close"),jQuery(window).off("resize.ui-resize"),h.removeClass("open").css({left:"",right:"",top:"",bottom:""}),jQuery("#ui-bar,#story").find("[tabindex=-2]").removeAttr("aria-hidden").attr("tabindex",0),jQuery("body>[tabindex=-3]").removeAttr("aria-hidden").removeAttr("tabindex"),p.empty(),f.empty().removeClass(),d.removeClass("open"),jQuery(document.documentElement).removeClass("ui-dialog-open"),null!==g&&(jQuery(g).focus(),g=null),e&&e.data&&"function"==typeof e.data.closeFn&&e.data.closeFn(e),setTimeout(function(){return jQuery.event.trigger("tw:dialogclosed")},Engine.minDomActionDelay),Dialog}function l(e){var t=e&&e.data&&"undefined"!=typeof e.data.top?e.data.top:50;"block"===h.css("display")&&(h.css({display:"none"}),h.css(jQuery.extend({display:""},c(t))))}function c(e){var t=null!=e?e:50,r=jQuery(window),a={left:"",right:"",top:"",bottom:""};h.css(a);var n=r.width()-h.outerWidth(!0)-1,i=r.height()-h.outerHeight(!0)-1;return n<=32+m&&(i-=m),i<=32+m&&(n-=m),n<=32?a.left=a.right=16:a.left=a.right=~~(n/2),i<=32?a.top=a.bottom=16:i/2>t?a.top=t:a.top=a.bottom=~~(i/2),Object.keys(a).forEach(function(e){""!==a[e]&&(a[e]+="px")}),a}var d=null,h=null,p=null,f=null,g=null,m=0;return Object.freeze(Object.defineProperties({},{init:{value:e},isOpen:{value:t},setup:{value:r},body:{value:a},append:{value:n},wiki:{value:i},addClickHandler:{value:o},open:{value:s},close:{value:u},resize:{value:function(){return l()}}}))}(),Engine=function(){function e(){if(Story.has("StoryInit"))try{var e=Wikifier.wikifyEval(Story.get("StoryInit").text);if(Config.debug){var t=new DebugView(document.createDocumentFragment(),"special","StoryInit","StoryInit");t.modes({hidden:!0}),t.append(e),f=t.output}}catch(e){Alert.error("StoryInit",e.message)}if(Config.history.maxStates=Math.max(0,Config.history.maxStates),Number.isSafeInteger(Config.history.maxStates)||(Config.history.maxStates=100),1===Config.history.maxStates&&(Config.history.controls=!1),Config.debug&&DebugView.init(),null==Config.passages.start)throw new Error("starting passage not selected");if(!Story.has(Config.passages.start))throw new Error('starting passage ("'+Config.passages.start+'") not found');if(State.restore())u();else{var r=!0;switch(_typeof(Config.saves.autoload)){case"boolean":Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(r=!Save.autosave.load());break;case"string":"prompt"===Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(r=!1,UI.buildDialogAutoload(),UI.open());break;case"function":Save.autosave.ok()&&Save.autosave.has()&&Config.saves.autoload()&&(r=!Save.autosave.load())}r&&l(Config.passages.start)}}function t(){LoadScreen.show(),window.scroll(0,0),State.reset(),window.location.reload()}function r(){return h}function a(){return p}function n(e){var t=State.goTo(e);return t&&u(),t}function i(e){var t=State.go(e);return t&&u(),t}function o(){return i(-1)}function s(){return i(1)}function u(){return l(State.passage,!0)}function l(e,t){h="playing",TempState={},TempVariables={},window.SugarCube.TempVariables=TempVariables;var r=void 0,a=void 0,n=Story.get(e);if(Object.keys(prehistory).forEach(function(e){"function"==typeof prehistory[e]&&prehistory[e].call(this,e)},n),t||State.create(n.title),document.body.className&&(document.body.className=""),Object.keys(predisplay).forEach(function(e){"function"==typeof predisplay[e]&&predisplay[e].call(this,e)},n),Story.has("PassageReady"))try{r=Wikifier.wikifyEval(Story.get("PassageReady").text)}catch(e){Alert.error("PassageReady",e.message)}h="rendering";var i=jQuery(n.render()),o=document.getElementById("passages");if(o.hasChildNodes()&&("number"==typeof Config.passages.transitionOut||"string"==typeof Config.passages.transitionOut&&""!==Config.passages.transitionOut&&""!==Config.transitionEndEventName?[].concat(_toConsumableArray(o.childNodes)).forEach(function(e){var t=jQuery(e);if(e.nodeType===Node.ELEMENT_NODE&&t.hasClass("passage")){if(t.hasClass("passage-out"))return;t.attr("id","out-"+t.attr("id")).addClass("passage-out"),"string"==typeof Config.passages.transitionOut?t.on(Config.transitionEndEventName,function(e){e.originalEvent.propertyName===Config.passages.transitionOut&&t.remove()}):setTimeout(function(){return t.remove()},Math.max(d,Config.passages.transitionOut))}else t.remove()}):jQuery(o).empty()),i.addClass("passage-in").appendTo(o),setTimeout(function(){return i.removeClass("passage-in")},d),document.title=Config.passages.displayTitles&&n.title!==Config.passages.start?n.title+" | "+Story.title:Story.title,window.scroll(0,0),h="playing",Story.has("PassageDone"))try{a=Wikifier.wikifyEval(Story.get("PassageDone").text)}catch(e){Alert.error("PassageDone",e.message)}if(Object.keys(postdisplay).forEach(function(e){"function"==typeof postdisplay[e]&&postdisplay[e].call(this,e)},n),Config.ui.updateStoryElements&&UI.setStoryElements(),Config.debug){var s=void 0;null!=r&&(s=new DebugView(document.createDocumentFragment(),"special","PassageReady","PassageReady"),s.modes({hidden:!0}),s.append(r),i.prepend(s.output)),null!=a&&(s=new DebugView(document.createDocumentFragment(),"special","PassageDone","PassageDone"),s.modes({hidden:!0}),s.append(a),i.append(s.output)),1===State.turns&&null!=f&&i.prepend(f)}switch(p=Date.now(),UI.hideOutlines(),jQuery("#story").find("a[href]:not(.link-external)").addClass("link-external").end().find("a,link,button,input,select,textarea").not("[tabindex]").attr("tabindex",0),_typeof(Config.saves.autosave)){case"boolean":Config.saves.autosave&&Save.autosave.save();break;case"string":n.tags.includes(Config.saves.autosave)&&Save.autosave.save();break;case"object":Array.isArray(Config.saves.autosave)&&n.tags.some(function(e){return Config.saves.autosave.includes(e)})&&Save.autosave.save()}return h="idle",i[0]}function c(e,t,r){var a=!1;switch(r){case undefined:break;case"replace":case"back":a=!0;break;default:throw new Error('Engine.display option parameter called with obsolete value "'+r+'"; please notify the developer')}l(e,a)}var d=40,h="idle",p=null,f=null;return Object.freeze(Object.defineProperties({},{minDomActionDelay:{value:d},start:{value:e},restart:{value:t},state:{get:r},lastPlay:{get:a},goTo:{value:n},go:{value:i},backward:{value:o},forward:{value:s},show:{value:u},play:{value:l},display:{value:c}}))}(),Passage=function(){var e=void 0;e=/^(?:debug|nobr|passage|widget|twine\..*)$/i;var t=function(){function t(r,a){var n=this;_classCallCheck(this,t),Object.defineProperties(this,{title:{value:Util.unescape(r)},element:{value:a||null},tags:{value:Object.freeze(a&&a.hasAttribute("tags")?a.getAttribute("tags").trim().splitOrEmpty(/\s+/).sort().filter(function(e,t,r){return 0===t||r[t-1]!==e}):[])},_excerpt:{writable:!0,value:null}}),Object.defineProperties(this,{domId:{value:"passage-"+Util.slugify(this.title)},classes:{value:Object.freeze(0===this.tags.length?[]:function(){return n.tags.filter(function(t){return!e.test(t)}).map(function(e){return Util.slugify(e)})}())}})}return _createClass(t,[{key:"description",value:function(){var e=Config.passages.descriptions;if(null!=e)switch("undefined"==typeof e?"undefined":_typeof(e)){case"boolean":if(e)return this.title;break;case"object":if(e instanceof Map&&e.has(this.title))return e.get(this.title);if(e.hasOwnProperty(this.title))return e[this.title];break;case"function":var r=e.call(this);if(r)return r;break;default:throw new TypeError("Config.passages.descriptions must be a boolean, object, or function")}return null===this._excerpt&&(this._excerpt=t.getExcerptFromText(this.text)),this._excerpt}},{key:"processText",value:function(){var e=this.text;return this.tags.includes("nobr")&&(e=e.replace(/^\n+|\n+$/g,"").replace(/\n+/g," ")),this.tags.includes("Twine.image")&&(e="[img["+e+"]]"),e}},{key:"render",value:function(){var e=this,r=document.createElement("div");return jQuery(r).attr({id:this.domId,"data-passage":this.title,"data-tags":this.tags.join(" ")}).addClass("passage "+this.className),jQuery(document.body).addClass(this.className),Object.keys(prerender).forEach(function(t){"function"==typeof prerender[t]&&prerender[t].call(e,r,t)}),Story.has("PassageHeader")&&new Wikifier(r,Story.get("PassageHeader").processText()),new Wikifier(r,this.processText()),Story.has("PassageFooter")&&new Wikifier(r,Story.get("PassageFooter").processText()),Config.cleanupWikifierOutput&&convertBreaks(r),Object.keys(postrender).forEach(function(t){"function"==typeof postrender[t]&&postrender[t].call(e,r,t)}),this._excerpt=t.getExcerptFromNode(r),r}},{key:"className",get:function(){return this.classes.join(" ")}},{key:"text",get:function(){if(null==this.element){var e=Util.escape(this.title);return'<span class="error" title="'+e+'">'+L10n.get("errorTitle")+": "+L10n.get("errorNonexistentPassage",{passage:e})+"</span>"}return this.element.textContent.replace(/\r/g,"")}}],[{key:"getExcerptFromNode",value:function(e,t){if(!e.hasChildNodes())return"";var r=e.textContent.trim();if(""!==r){var a=new RegExp("(\\S+(?:\\s+\\S+){0,"+(t>0?t-1:7)+"})");r=r.replace(/\s+/g," ").match(a)}return r?r[1]+"…":"…"}},{key:"getExcerptFromText",value:function(e,t){if(""===e)return"";var r=new RegExp("(\\S+(?:\\s+\\S+){0,"+(t>0?t-1:7)+"})"),a=e.replace(/<<.*?>>/g," ").replace(/<.*?>/g," ").trim().replace(/^\s*\|.*\|.*?$/gm,"").replace(/\[[<>]?img\[[^\]]*\]\]/g,"").replace(/\[\[([^|\]]*)(?:|[^\]]*)?\]\]/g,"$1").replace(/^\s*!+(.*?)$/gm,"$1").replace(/'{2}|\/{2}|_{2}|@{2}/g,"").trim().replace(/\s+/g," ").match(r);return a?a[1]+"…":"…"}}]),t}();return t}(),Save=function(){function e(){if("cookie"===storage.name)return a(),Config.saves.autosave=undefined,Config.saves.slots=0,!1;Config.saves.slots=Math.max(0,Config.saves.slots),Number.isSafeInteger(Config.saves.slots)||(Config.saves.slots=8);var e=r(),t=!1;Array.isArray(e)&&(e={autosave:null,slots:e},t=!0),Config.saves.slots!==e.slots.length&&(Config.saves.slots<e.slots.length?(e.slots.reverse(),e.slots=e.slots.filter(function(e){return!(null===e&&this.count>0)||(--this.count,!1)},{count:e.slots.length-Config.saves.slots}),e.slots.reverse()):Config.saves.slots>e.slots.length&&S(e.slots,Config.saves.slots-e.slots.length),t=!0),j(e.autosave)&&(t=!0);for(var n=0;n<e.slots.length;++n)j(e.slots[n])&&(t=!0);return x(e)&&(storage.delete("saves"),t=!1),t&&E(e),T=e.slots.length-1,!0}function t(){return{autosave:null,slots:S([],Config.saves.slots)}}function r(){var e=storage.get("saves");return null===e?t():e}function a(){return storage.delete("saves"),!0}function n(){return i()||d()}function i(){return"cookie"!==storage.name&&"undefined"!=typeof Config.saves.autosave}function o(){var e=r();return null!==e.autosave}function s(){var e=r();return e.autosave}function u(){var e=r();return null!==e.autosave&&O(e.autosave)}function l(e,t){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return!1;var a=r(),n={title:e||Story.get(State.passage).description(),date:Date.now()};return null!=t&&(n.metadata=t),a.autosave=C(n),E(a)}function c(){var e=r();return e.autosave=null,E(e)}function d(){return"cookie"!==storage.name&&T!==-1}function h(){return T+1}function p(){if(!d())return 0;for(var e=r(),t=0,a=0,n=e.slots.length;a<n;++a)null!==e.slots[a]&&++t;return t}function f(){return 0===p()}function g(e){if(e<0||e>T)return!1;var t=r();return!(e>=t.slots.length||null===t.slots[e])}function m(e){if(e<0||e>T)return null;var t=r();return e>=t.slots.length?null:t.slots[e]}function v(e){if(e<0||e>T)return!1;var t=r();return!(e>=t.slots.length||null===t.slots[e])&&O(t.slots[e])}function y(e,t,a){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return UI.alert(L10n.get("savesDisallowed")),!1;if(e<0||e>T)return!1;var n=r();if(e>=n.slots.length)return!1;var i={title:t||Story.get(State.passage).description(),date:Date.now()};return null!=a&&(i.metadata=a),n.slots[e]=C(i),E(n)}function b(e){if(e<0||e>T)return!1;var t=r();return!(e>=t.slots.length)&&(t.slots[e]=null,E(t))}function w(e,t){function r(){var e=new Date,t=e.getMonth()+1,r=e.getDate(),a=e.getHours(),n=e.getMinutes(),i=e.getSeconds();return t<10&&(t="0"+t),r<10&&(r="0"+r),a<10&&(a="0"+a),n<10&&(n="0"+n),i<10&&(i="0"+i),""+e.getFullYear()+t+r+"-"+a+n+i}if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return void UI.alert(L10n.get("savesDisallowed"));var a=null==e?Story.domId:Util.slugify(e),n=a+"-"+r()+".save",i=null==t?{}:{metadata:t},o=LZString.compressToBase64(JSON.stringify(C(i)));saveAs(new Blob([o],{type:"text/plain;charset=UTF-8"}),n)}function k(e){var t=e.target.files[0],r=new FileReader;jQuery(r).on("load",function(e){var r=e.currentTarget;if(r.result){var a=void 0;try{a=JSON.parse(/\.json$/i.test(t.name)||/^\{/.test(r.result)?r.result:LZString.decompressFromBase64(r.result))}catch(e){}O(a)}}),r.readAsText(t)}function S(e,t){for(var r=0;r<t;++r)e.push(null);return e}function x(e){for(var t=e.slots,r=!0,a=0,n=t.length;a<n;++a)if(null!==t[a]){r=!1;break}return null===e.autosave&&r}function E(e){return x(e)?(storage.delete("saves"),!0):storage.set("saves",e)}function j(e){if(null===e)return!1;var t=!1;return e.hasOwnProperty("state")&&e.state.hasOwnProperty("delta")&&e.state.hasOwnProperty("index")||(e.hasOwnProperty("data")?(delete e.mode,e.state={delta:State.deltaEncode(e.data)},delete e.data):e.state.hasOwnProperty("delta")?e.state.hasOwnProperty("index")||delete e.state.mode:(delete e.state.mode,e.state.delta=State.deltaEncode(e.state.history),delete e.state.history),e.state.index=e.state.delta.length-1,t=!0),e.state.hasOwnProperty("rseed")&&(e.state.seed=e.state.rseed,delete e.state.rseed,e.state.delta.forEach(function(e,t,r){r[t].hasOwnProperty("rcount")&&(r[t].pull=r[t].rcount,delete r[t].rcount)}),t=!0),(e.state.hasOwnProperty("expired")&&"number"==typeof e.state.expired||e.state.hasOwnProperty("unique")||e.state.hasOwnProperty("last"))&&(e.state.hasOwnProperty("expired")&&"number"==typeof e.state.expired&&delete e.state.expired,(e.state.hasOwnProperty("unique")||e.state.hasOwnProperty("last"))&&(e.state.expired=[],e.state.hasOwnProperty("unique")&&(e.state.expired.push(e.state.unique),delete e.state.unique),e.state.hasOwnProperty("last")&&(e.state.expired.push(e.state.last),delete e.state.last)),t=!0),t}function C(e){if(null!=e&&"object"!==("undefined"==typeof e?"undefined":_typeof(e)))throw new Error("supplemental parameter must be an object");var t=Object.assign({},e,{id:Config.saves.id,state:State.marshalForSave()});return Config.saves.version&&(t.version=Config.saves.version),"function"==typeof Config.saves.onSave&&Config.saves.onSave(t),t.state.delta=State.deltaEncode(t.state.history),delete t.state.history,t}function O(e){try{if(j(e),!e||!e.hasOwnProperty("id")||!e.hasOwnProperty("state"))throw new Error(L10n.get("errorSaveMissingData"));if(e.state.history=State.deltaDecode(e.state.delta),delete e.state.delta,"function"==typeof Config.saves.onLoad&&Config.saves.onLoad(e),e.id!==Config.saves.id)throw new Error(L10n.get("errorSaveIdMismatch"));State.unmarshalForSave(e.state),Engine.show()}catch(e){return UI.alert(e.message.toUpperFirst()+".</p><p>"+L10n.get("aborting")+"."),!1}return!0}var T=-1;return Object.freeze(Object.defineProperties({},{init:{value:e},get:{value:r},clear:{value:a},ok:{value:n},autosave:{value:Object.freeze(Object.defineProperties({},{ok:{value:i},has:{value:o},get:{value:s},load:{value:u},save:{value:l},delete:{value:c}}))},slots:{value:Object.freeze(Object.defineProperties({},{ok:{value:d},length:{get:h},isEmpty:{value:f},count:{value:p},has:{value:g},get:{value:m},load:{value:v},save:{value:y},delete:{value:b}}))},export:{value:w},import:{value:k}}))}(),Setting=function(){function e(){if(storage.has("options")){var e=storage.get("options");null!==e&&(window.SugarCube.settings=settings=Object.assign(t(),e)),r(),storage.delete("options")}a(),g.forEach(function(e){if(e.hasOwnProperty("onInit")){var t={name:e.name,value:settings[e.name],default:e.default};e.hasOwnProperty("list")&&(t.list=e.list),e.onInit.call(t)}})}function t(){return Object.create(null)}function r(){var e=t();return Object.keys(settings).length>0&&g.filter(function(e){return e.type!==m.Header&&settings[e.name]!==e.default}).forEach(function(t){return e[t.name]=settings[t.name]}),0===Object.keys(e).length?(storage.delete("settings"),!0):storage.set("settings",e)}function a(){var e=t(),r=storage.get("settings")||t();g.filter(function(e){return e.type!==m.Header}).forEach(function(t){return e[t.name]=t.default}),window.SugarCube.settings=settings=Object.assign(e,r)}function n(){return window.SugarCube.settings=settings=t(),storage.delete("settings"),!0}function i(e){if(0===arguments.length)n(),a();else{if(null==e||!h(e))throw new Error('nonexistent setting "'+e+'"');var t=p(e);t.type!==m.Header&&(settings[e]=t.default)}return r()}function o(e,t){g.forEach(e,t)}function s(e,t,r){if(arguments.length<3){var a=[];throw arguments.length<1&&a.push("type"),arguments.length<2&&a.push("name"),arguments.length<3&&a.push("definition"),new Error("missing parameters, no "+a.join(" or ")+" specified")}if("object"!==("undefined"==typeof r?"undefined":_typeof(r)))throw new TypeError("definition parameter must be an object");if(h(t))throw new Error('cannot clobber existing setting "'+t+'"');var n={type:e,name:t,label:null==r.label?"":String(r.label).trim()};switch(e){case m.Header:break;case m.Toggle:n.default=!!r.default;break;case m.List:if(!r.hasOwnProperty("list"))throw new Error("no list specified");if(!Array.isArray(r.list))throw new TypeError("list must be an array");if(0===r.list.length)throw new Error("list must not be empty");if(n.list=Object.freeze(r.list),null==r.default)n.default=r.list[0];else{var i=r.list.indexOf(r.default);if(i===-1)throw new Error("list does not contain default");n.default=r.list[i]}break;default:throw new Error("unknown Setting type: "+e)}"function"==typeof r.onInit&&(n.onInit=Object.freeze(r.onInit)),"function"==typeof r.onChange&&(n.onChange=Object.freeze(r.onChange)),g.push(Object.freeze(n))}function u(e,t){s(m.Header,e,{label:t})}function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s.apply(undefined,[m.Toggle].concat(t))}function c(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s.apply(undefined,[m.List].concat(t))}function d(){return 0===g.length}function h(e){return g.some(function(t){return t.name===e})}function p(e){return g.find(function(t){return t.name===e})}function f(e){h(e)&&delete settings[e];for(var t=0;t<g.length;++t)if(g[t].name===e){g.splice(t,1),f(e);break}}var g=[],m=Object.freeze({Header:0,Toggle:1,List:2});return Object.freeze(Object.defineProperties({},{Types:{value:m},init:{value:e},create:{value:t},save:{value:r},load:{value:a},clear:{value:n},reset:{value:i},forEach:{value:o},add:{value:s},addHeader:{value:u},addToggle:{value:l},addList:{value:c},isEmpty:{value:d},has:{value:h},get:{value:p},delete:{value:f}}))}(),State=function(){function e(){session.delete("state"),M=[],L=c(),N=-1,I=[],Q=null===Q?null:new PRNGWrapper(Q.seed,!1)}function t(){if(session.has("state")){var e=session.get("state");return null!=e&&(a(e),!0)}return!1}function r(e){var t={index:N};return e?t.history=clone(M):t.delta=A(M),I.length>0&&(t.expired=[].concat(_toConsumableArray(I))),null!==Q&&(t.seed=Q.seed),t}function a(e,t){if(null==e)throw new Error("state object is null or undefined");if(!e.hasOwnProperty(t?"history":"delta")||0===e[t?"history":"delta"].length)throw new Error("state object has no history or history is empty");if(!e.hasOwnProperty("index"))throw new Error("state object has no index");if(null!==Q&&!e.hasOwnProperty("seed"))throw new Error("state object has no seed, but PRNG is enabled");if(null===Q&&e.hasOwnProperty("seed"))throw new Error("state object has seed, but PRNG is disabled");M=t?clone(e.history):_(e.delta),N=e.index,I=e.hasOwnProperty("expired")?[].concat(_toConsumableArray(e.expired)):[],e.hasOwnProperty("seed")&&(Q.seed=e.seed),g(N)}function n(){return r(!0)}function i(e){return a(e,!0)}function o(){return I}function s(){return I.length+v()}function u(){return I.concat(M.slice(0,v()).map(function(e){return e.title}))}function l(e){return null!=e&&""!==e&&(!!I.includes(e)||!!M.slice(0,v()).some(function(t){return t.title===e}))}function c(e,t){return{title:null==e?"":String(e),variables:null==t?{}:clone(t)}}function d(){return L}function h(){return N}function p(){return L.title}function f(){return L.variables}function g(e){if(null==e)throw new Error("moment activation attempted with null or undefined");switch("undefined"==typeof e?"undefined":_typeof(e)){case"object":L=clone(e);break;case"number":if(b())throw new Error("moment activation attempted with index on empty history");if(e<0||e>=y())throw new RangeError("moment activation attempted with out-of-bounds index; need [0, "+(y()-1)+"], got "+e);L=clone(M[e]);break;default:throw new TypeError('moment activation attempted with a "'+("undefined"==typeof e?"undefined":_typeof(e))+'"; must be an object or valid history stack index')}return null!==Q&&(Q=PRNGWrapper.unmarshal({seed:Q.seed,pull:L.pull})),session.set("state",r()),jQuery.event.trigger("tw:historyupdate"),L}function m(){return M}function v(){return N+1}function y(){return M.length}function b(){return 0===M.length}function w(){return M.length>0?M[N]:null}function k(){return M.length>0?M[M.length-1]:null}function S(){return M.length>0?M[0]:null}function x(e){return b()||e<0||e>N?null:M[e]}function E(e){if(b())return null;var t=1+(e?Math.abs(e):0);return t>v()?null:M[v()-t]}function j(e){if(b()||null==e||""===e)return!1;for(var t=N;t>=0;--t)if(M[t].title===e)return!0;return!1}function C(e){if(v()<y()&&M.splice(v(),y()-v()),M.push(c(e,L.variables)),Q&&(k().pull=Q.pull),Config.history.maxStates>0)for(;y()>Config.history.maxStates;)I.push(M.shift().title);return N=y()-1,g(N),v()}function O(e){return!(null==e||e<0||e>=y()||e===N)&&(N=e,g(N),!0)}function T(e){return null!=e&&0!==e&&O(N+e)}function A(e){if(!Array.isArray(e))return null;if(0===e.length)return[];for(var t=[clone(e[0])],r=1,a=e.length;r<a;++r)t.push(Util.diff(e[r-1],e[r]));return t}function _(e){if(!Array.isArray(e))return null;if(0===e.length)return[];for(var t=[clone(e[0])],r=1,a=e.length;r<a;++r)t.push(Util.patch(t[r-1],e[r]));return t}function P(e,t){if(!b()){var r=void 0;throw r="the Story JavaScript",new Error("State.initPRNG must be called during initialization, within either "+r+" or the StoryInit special passage")}Q=new PRNGWrapper(e,t),L.pull=Q.pull}function D(){return Q?Q.random():Math.random()}var M=[],L=c(),N=-1,I=[],Q=null;return Object.freeze(Object.defineProperties({},{reset:{value:e},restore:{value:t},marshalForSave:{value:n},unmarshalForSave:{value:i},expired:{get:o},turns:{get:s},passages:{get:u},hasPlayed:{value:l},active:{get:d},activeIndex:{get:h},passage:{get:p},variables:{get:f},history:{get:m},length:{get:v},size:{get:y},isEmpty:{value:b},current:{get:w},top:{get:k},bottom:{get:S},index:{value:x},peek:{value:E},has:{value:j},create:{value:C},goTo:{value:O},go:{value:T},deltaEncode:{value:A},deltaDecode:{value:_},initPRNG:{value:P},random:{value:D},restart:{value:function(){return Engine.restart()}},backward:{value:function(){return Engine.backward()}},forward:{value:function(){return Engine.forward()}},display:{value:function(){return Engine.display.apply(Engine,arguments)}},show:{value:function(){return Engine.show.apply(Engine,arguments)}},play:{value:function(){return Engine.play.apply(Engine,arguments)}}}))}(),Story=function(){function e(){!function(){var e=jQuery("#store-area>tw-storydata"),t=e.attr("startnode")||"";Config.passages.start=null,Config.debug=/\bdebug\b/.test(e.attr("options")),e.children("style").each(function(e){c.push(new Passage("tw-user-style-"+e,this))}),e.children("script").each(function(e){d.push(new Passage("tw-user-script-"+e,this))}),e.children('tw-passagedata:not([tags~="Twine.private"],[tags~="annotation"])').each(function(){var e=jQuery(this),r=e.attr("pid")||"",a=new Passage(e.attr("name"),this);r===t&&""!==t&&(Config.passages.start=a.title),a.tags.includes("widget")?h.push(a):l[a.title]=a}),f=e.attr("ifid"),r(Util.unescape("Chaudron magique")),Config.saves.id=Story.domId}()}function t(){for(var e=0;e<c.length;++e)addStyle(c[e].text);for(var t=0;t<d.length;++t)try{Scripting.evalJavaScript(d[t].text)}catch(e){Alert.error(d[t].title,e.message)}for(var r=0;r<h.length;++r)try{Wikifier.wikifyEval(h[r].processText())}catch(e){Alert.error(h[r].title,e.message)}}function r(e){if(null==e||""===e)throw new Error("story title cannot be null or empty");document.title=p=Util.unescape(e),g=Util.slugify(p)}function a(){return p}function n(){return g}function i(){return f}function o(e){var t="undefined"==typeof e?"undefined":_typeof(e);switch(t){case"number":case"string":var r=String(e);return l.hasOwnProperty(r);case"boolean":case"function":t="a "+t;break;case"undefined":break;default:t=null===e?"null":"an "+t}throw new TypeError("Story.has title parameter cannot be "+t)}function s(e){var t="undefined"==typeof e?"undefined":_typeof(e);switch(t){case"number":case"string":var r=String(e);return l.hasOwnProperty(r)?l[r]:new Passage(r||"(unknown)");case"boolean":case"function":t="a "+t;break;case"undefined":break;default:t=null===e?"null":"an "+t}throw new TypeError("Story.get title parameter cannot be "+t)}function u(e,t){for(var r=arguments.length<=2||arguments[2]===undefined?"title":arguments[2],a=Object.keys(l),n=[],i=0;i<a.length;++i){var o=l[a[i]];if(o.hasOwnProperty(e))switch(_typeof(o[e])){case"undefined":break;case"object":for(var s=0,u=o[e].length;s<u;++s)if(o[e][s]==t){n.push(o);break}break;default:o[e]==t&&n.push(o)}}return n.sort(function(e,t){return e[r]==t[r]?0:e[r]<t[r]?-1:1}),n}var l={},c=[],d=[],h=[],p="",f="",g="";return Object.freeze(Object.defineProperties({},{passages:{value:l},styles:{value:c},scripts:{value:d},widgets:{value:h},load:{value:e},init:{value:t},title:{get:a},domId:{get:n},ifId:{get:i},has:{value:o},get:{value:s},lookup:{value:u}}))}(),UI=function(){function e(){jQuery("#init-no-js,#init-lacking").remove(),y=new StyleWrapper(function(){return jQuery(document.createElement("style")).attr({id:"style-outline-patch",type:"text/css"}).appendTo(document.head).get(0)}()),function(){var e=jQuery(document.createDocumentFragment()),t=L10n.get("uiBarToggle"),r=L10n.get("uiBarBackward"),a=L10n.get("uiBarJumpto"),n=L10n.get("uiBarForward");e.append('<div id="ui-bar"><div id="ui-bar-tray">'+('<button id="ui-bar-toggle" tabindex="0" title="'+t+'" aria-label="'+t+'"></button>')+'<div id="ui-bar-history">'+('<button id="history-backward" tabindex="0" title="'+r+'" aria-label="'+r+'"></button>')+('<button id="history-jumpto" tabindex="0" title="'+a+'" aria-label="'+a+'"></button>')+('<button id="history-forward" tabindex="0" title="'+n+'" aria-label="'+n+'"></button>')+'</div></div><div id="ui-bar-body"><header id="title" role="banner"><div id="story-banner"></div><h1 id="story-title"></h1><div id="story-subtitle"></div><div id="story-title-separator"></div><p id="story-author"></p></header><div id="story-caption"></div><nav id="menu" role="navigation"><ul id="menu-story"></ul><ul id="menu-core">'+('<li id="menu-item-saves"><a tabindex="0">'+L10n.get("savesTitle")+"</a></li>")+('<li id="menu-item-settings"><a tabindex="0">'+L10n.get("settingsTitle")+"</a></li>")+('<li id="menu-item-restart"><a tabindex="0">'+L10n.get("restartTitle")+"</a></li>")+('<li id="menu-item-share"><a tabindex="0">'+L10n.get("shareTitle")+"</a></li>")+'</ul></nav></div></div><div id="story" role="main"><div id="passages"></div></div>').insertBefore("#store-area");
}(),jQuery(document).on("tw:historyupdate",function(e,t){return function(){e.prop("disabled",State.length<2),t.prop("disabled",State.length===State.size)}}(jQuery("#history-backward"),jQuery("#history-forward"))).on("mousedown.outline-handler keydown.outline-handler",function(e){switch(e.type){case"mousedown":a();break;case"keydown":n()}})}function t(){var e=jQuery("#ui-bar");(Config.ui.stowBarInitially||jQuery(window).width()<=800)&&!function(){var t=jQuery(e).add("#story");t.addClass("no-transition"),e.addClass("stowed"),setTimeout(function(){return t.removeClass("no-transition")},Engine.minDomActionDelay)}(),jQuery("#ui-bar-toggle").ariaClick({label:L10n.get("uiBarToggle")},function(){return e.toggleClass("stowed")}),Config.history.controls?(jQuery("#history-backward").prop("disabled",State.length<2).ariaClick({label:L10n.get("uiBarBackward")},function(){return Engine.backward()}),Story.lookup("tags","bookmark").length>0?jQuery("#history-jumpto").ariaClick({label:L10n.get("uiBarJumpto")},function(){return UI.jumpto()}):jQuery("#history-jumpto").remove(),jQuery("#history-forward").prop("disabled",State.length===State.size).ariaClick({label:L10n.get("uiBarForward")},function(){return Engine.forward()})):jQuery("#ui-bar-history").remove(),jQuery("#story-title").text(Story.title),Story.has("StoryCaption")||jQuery("#story-caption").remove(),Story.has("StoryMenu")||jQuery("#menu-story").remove(),Config.ui.updateStoryElements||r(),Dialog.addClickHandler("#menu-item-saves a",null,g).text(L10n.get("savesTitle")),Setting.isEmpty()?jQuery("#menu-item-settings").remove():Dialog.addClickHandler("#menu-item-settings a",null,m).text(L10n.get("settingsTitle")),Dialog.addClickHandler("#menu-item-restart a",null,f).text(L10n.get("restartTitle")),Story.has("StoryShare")?Dialog.addClickHandler("#menu-item-share a",null,v).text(L10n.get("shareTitle")):jQuery("#menu-item-share").remove(),jQuery(document.documentElement).focus()}function r(){setPageElement("story-banner","StoryBanner"),setPageElement("story-subtitle","StorySubtitle"),setPageElement("story-author","StoryAuthor"),setPageElement("story-caption","StoryCaption");var e=document.getElementById("menu-story");null!==e&&(jQuery(e).empty(),Story.has("StoryMenu")&&i("StoryMenu",e))}function a(){y.set("*:focus{outline:none}")}function n(){y.clear()}function i(e,t){var r=t,a=Config.debug;Config.debug=!1,null==r&&(r=document.createElement("ul"));var n=document.createDocumentFragment();if(new Wikifier(n,Story.get(e).processText().trim()),n.hasChildNodes())for(var i=null;n.hasChildNodes();){var o=n.firstChild;o.nodeType!==Node.ELEMENT_NODE||"A"!==o.nodeName.toUpperCase()?(n.removeChild(o),null!==i&&(i=null)):(null===i&&(i=document.createElement("li"),r.appendChild(i)),i.appendChild(o))}return Config.debug=a,r}function o(e){jQuery(Dialog.setup("Alert","alert")).append("<p>"+e+'</p><ul class="buttons">'+('<li><button id="alert-ok" class="ui-close">'+L10n.get(["alertOk","ok"])+"</button></li>")+"</ul>");for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];Dialog.open.apply(Dialog,r)}function s(){p(),Dialog.open.apply(Dialog,arguments)}function u(){f(),Dialog.open.apply(Dialog,arguments)}function l(){g(),Dialog.open.apply(Dialog,arguments)}function c(){m(),Dialog.open.apply(Dialog,arguments)}function d(){v(),Dialog.open.apply(Dialog,arguments)}function h(){return jQuery(Dialog.setup(L10n.get("autoloadTitle"),"autoload")).append("<p>"+L10n.get("autoloadPrompt")+'</p><ul class="buttons">'+('<li><button id="autoload-ok" class="ui-close">'+L10n.get(["autoloadOk","ok"])+"</button></li>")+('<li><button id="autoload-cancel" class="ui-close">'+L10n.get(["autoloadCancel","cancel"])+"</button></li>")+"</ul>"),jQuery(document).one("click.autoload",".ui-close",function(e){var t="autoload-ok"===e.target.id;jQuery(document).one("tw:dialogclosed",function(){t&&Save.autosave.load()||Engine.play(Config.passages.start)})}),!0}function p(){var e=document.createElement("ul");jQuery(Dialog.setup(L10n.get("jumptoTitle"),"jumpto list")).append(e);for(var t=State.expired.length,r=State.size-1;r>=0;--r)if(r!==State.activeIndex){var a=Story.get(State.history[r].title);a&&a.tags.includes("bookmark")&&jQuery(document.createElement("li")).append(jQuery(document.createElement("a")).ariaClick({one:!0},function(e){return function(){return jQuery(document).one("tw:dialogclosed",function(){return Engine.goTo(e)})}}(r)).addClass("ui-close").text(L10n.get("jumptoTurn")+" "+(t+r+1)+": "+a.description())).appendTo(e)}e.hasChildNodes()||jQuery(e).append("<li><a><em>"+L10n.get("jumptoUnavailable")+"</em></a></li>")}function f(){return jQuery(Dialog.setup(L10n.get("restartTitle"),"restart")).append("<p>"+L10n.get("restartPrompt")+'</p><ul class="buttons">'+('<li><button id="restart-ok">'+L10n.get(["restartOk","ok"])+"</button></li>")+('<li><button id="restart-cancel" class="ui-close">'+L10n.get(["restartCancel","cancel"])+"</button></li>")+"</ul>").find("#restart-ok").ariaClick({one:!0},function(){jQuery(document).one("tw:dialogclosed",function(){return Engine.restart()}),Dialog.close()}),!0}function g(){function e(e,t,r,a){var n=jQuery(document.createElement("button")).attr("id","saves-"+e).html(r);return t&&n.addClass(t),a?n.ariaClick(a):n.prop("disabled",!0),jQuery(document.createElement("li")).append(n)}function t(){function e(e,t,r,a,n){var i=jQuery(document.createElement("button")).attr("id","saves-"+e+"-"+a).addClass(e).html(r);return t&&i.addClass(t),n?"auto"===a?i.ariaClick({label:r+" "+L10n.get("savesLabelAuto")},function(){return n()}):i.ariaClick({label:r+" "+L10n.get("savesLabelSlot")+" "+(a+1)},function(){return n(a)}):i.prop("disabled",!0),i}var t=Save.get(),r=jQuery(document.createElement("tbody"));if(Save.autosave.ok()){var a=jQuery(document.createElement("td")),n=jQuery(document.createElement("td")),i=jQuery(document.createElement("td")),o=jQuery(document.createElement("td"));jQuery(document.createElement("b")).attr({title:L10n.get("savesLabelAuto"),"aria-label":L10n.get("savesLabelAuto")}).text("A").appendTo(a),t.autosave?(n.append(e("load","ui-close",L10n.get("savesLabelLoad"),"auto",function(){jQuery(document).one("tw:dialogclosed",function(){return Save.autosave.load()})})),jQuery(document.createElement("div")).text(t.autosave.title).appendTo(i),jQuery(document.createElement("div")).addClass("datestamp").html(t.autosave.date?L10n.get("savesSavedOn")+" "+new Date(t.autosave.date).toLocaleString():L10n.get("savesSavedOn")+" <em>"+L10n.get("savesUnknownDate")+"</em>").appendTo(i),o.append(e("delete",null,L10n.get("savesLabelDelete"),"auto",function(){Save.autosave.delete(),g(),Dialog.resize()}))):(n.append(e("load",null,L10n.get("savesLabelLoad"),"auto")),jQuery(document.createElement("em")).text(L10n.get("savesEmptySlot")).appendTo(i),i.addClass("empty"),o.append(e("delete",null,L10n.get("savesLabelDelete"),"auto"))),jQuery(document.createElement("tr")).append(a).append(n).append(i).append(o).appendTo(r)}for(var s=0,u=t.slots.length;s<u;++s){var l=jQuery(document.createElement("td")),c=jQuery(document.createElement("td")),d=jQuery(document.createElement("td")),h=jQuery(document.createElement("td"));l.append(document.createTextNode(s+1)),t.slots[s]?(c.append(e("load","ui-close",L10n.get("savesLabelLoad"),s,function(e){jQuery(document).one("tw:dialogclosed",function(){return Save.slots.load(e)})})),jQuery(document.createElement("div")).text(t.slots[s].title).appendTo(d),jQuery(document.createElement("div")).addClass("datestamp").html(t.slots[s].date?L10n.get("savesSavedOn")+" "+new Date(t.slots[s].date).toLocaleString():L10n.get("savesSavedOn")+" <em>"+L10n.get("savesUnknownDate")+"</em>").appendTo(d),h.append(e("delete",null,L10n.get("savesLabelDelete"),s,function(e){Save.slots.delete(e),g(),Dialog.resize()}))):(c.append(e("save","ui-close",L10n.get("savesLabelSave"),s,Save.slots.save)),jQuery(document.createElement("em")).text(L10n.get("savesEmptySlot")).appendTo(d),d.addClass("empty"),h.append(e("delete",null,L10n.get("savesLabelDelete"),s))),jQuery(document.createElement("tr")).append(l).append(c).append(d).append(h).appendTo(r)}return jQuery(document.createElement("table")).attr("id","saves-list").append(r)}var r=jQuery(Dialog.setup(L10n.get("savesTitle"),"saves")),a=Save.ok();if(a&&r.append(t()),a||Has.fileAPI){var n=jQuery(document.createElement("ul")).addClass("buttons").appendTo(r);return Has.fileAPI&&(n.append(e("export","ui-close",L10n.get("savesLabelExport"),function(){return Save.export()})),n.append(e("import",null,L10n.get("savesLabelImport"),function(){return r.find("#saves-import-file").trigger("click")})),jQuery(document.createElement("input")).css({display:"block",visibility:"hidden",position:"fixed",left:"-9999px",top:"-9999px",width:"1px",height:"1px"}).attr({type:"file",id:"saves-import-file",tabindex:-1,"aria-hidden":!0}).on("change",function(e){jQuery(document).one("tw:dialogclosed",function(){return Save.import(e)}),Dialog.close()}).appendTo(r)),a&&n.append(e("clear",null,L10n.get("savesLabelClear"),Save.autosave.has()||!Save.slots.isEmpty()?function(){Save.clear(),g(),Dialog.resize()}:null)),!0}return o(L10n.get("savesIncapable")),!1}function m(){var e=jQuery(Dialog.setup(L10n.get("settingsTitle"),"settings"));return Setting.forEach(function(t){if(t.type===Setting.Types.Header){var r=t.name,a=Util.slugify(r),n=jQuery(document.createElement("div")),i=jQuery(document.createElement("h2")),o=jQuery(document.createElement("p"));return n.attr("id","header-body-"+a).append(i).append(o).appendTo(e),i.attr("id","header-heading-"+a).wiki(r),void o.attr("id","header-label-"+a).wiki(t.label)}var s=t.name,u=Util.slugify(s),l=jQuery(document.createElement("div")),c=jQuery(document.createElement("label")),d=jQuery(document.createElement("div")),h=void 0;switch(l.attr("id","setting-body-"+u).append(c).append(d).appendTo(e),c.attr({id:"setting-label-"+u,for:"setting-control-"+u}).wiki(t.label),null==settings[s]&&(settings[s]=t.default),t.type){case Setting.Types.Toggle:h=jQuery(document.createElement("button")),settings[s]?h.addClass("enabled").text(L10n.get("settingsOn")):h.text(L10n.get("settingsOff")),h.ariaClick(function(){settings[s]?(jQuery(this).removeClass("enabled").text(L10n.get("settingsOff")),settings[s]=!1):(jQuery(this).addClass("enabled").text(L10n.get("settingsOn")),settings[s]=!0),Setting.save(),t.hasOwnProperty("onChange")&&t.onChange.call({name:s,value:settings[s],default:t.default})});break;case Setting.Types.List:h=jQuery(document.createElement("select"));for(var p=0,f=t.list.length;p<f;++p)jQuery(document.createElement("option")).val(p).text(t.list[p]).appendTo(h);h.val(t.list.indexOf(settings[s])).attr("tabindex",0).on("change",function(){settings[s]=t.list[Number(this.value)],Setting.save(),t.hasOwnProperty("onChange")&&t.onChange.call({name:s,value:settings[s],default:t.default,list:t.list})})}h.attr("id","setting-control-"+u).appendTo(d)}),e.append('<ul class="buttons">'+('<li><button id="settings-ok" class="ui-close">'+L10n.get(["settingsOk","ok"])+"</button></li>")+('<li><button id="settings-reset">'+L10n.get("settingsReset")+"</button></li>")+"</ul>").find("#settings-reset").ariaClick({one:!0},function(){jQuery(document).one("tw:dialogclosed",function(){Setting.reset(),window.location.reload()}),Dialog.close()}),!0}function v(){return jQuery(Dialog.setup(L10n.get("shareTitle"),"share list")).append(i("StoryShare")),!0}var y=null;return Object.freeze(Object.defineProperties({},{init:{value:e},start:{value:t},setStoryElements:{value:r},hideOutlines:{value:a},showOutlines:{value:n},assembleLinkList:{value:i},alert:{value:o},jumpto:{value:s},restart:{value:u},saves:{value:l},settings:{value:c},share:{value:d},buildAutoload:{value:h},buildJumpto:{value:p},buildRestart:{value:f},buildSaves:{value:g},buildSettings:{value:m},buildShare:{value:v},isOpen:{value:function(){return Dialog.isOpen.apply(Dialog,arguments)}},body:{value:function(){return Dialog.body()}},setup:{value:function(){return Dialog.setup.apply(Dialog,arguments)}},addClickHandler:{value:function(){return Dialog.addClickHandler.apply(Dialog,arguments)}},open:{value:function(){return Dialog.open.apply(Dialog,arguments)}},close:{value:function(){return Dialog.close.apply(Dialog,arguments)}},resize:{value:function(){return Dialog.resize()}},buildDialogAutoload:{value:h},buildDialogJumpto:{value:p},buildDialogRestart:{value:f},buildDialogSaves:{value:g},buildDialogSettings:{value:m},buildDialogShare:{value:v},buildLinkListFromPassage:{value:i}}))}(),LoadScreen=function(){function e(){jQuery(document.documentElement).removeClass("init-loading")}function t(){jQuery(document.documentElement).addClass("init-loading")}function r(){n=!0,t()}function a(){n=!1,jQuery(document).trigger("readystatechange")}var n=!1;return jQuery(document).on("readystatechange.SugarCube",function(){if(!n){var e=jQuery(document.documentElement);"complete"===document.readyState?e.hasClass("init-loading")&&(Config.loadDelay>0?setTimeout(function(){return e.removeClass("init-loading")},Math.max(Engine.minDomActionDelay,Config.loadDelay)):e.removeClass("init-loading")):e.addClass("init-loading")}}),Object.freeze(Object.defineProperties({},{hide:{value:e},show:{value:t},lock:{value:r},unlock:{value:a}}))}(),version=Object.freeze({title:"SugarCube",major:2,minor:10,patch:0,prerelease:null,build:7517,date:new Date("2016-09-20T11:19:01.558Z"),extensions:{},toString:function(){var e=this.prerelease?"-"+this.prerelease:"";return this.major+"."+this.minor+"."+this.patch+e+"+"+this.build},short:function(){var e=this.prerelease?"-"+this.prerelease:"";return this.title+" (v"+this.major+"."+this.minor+"."+this.patch+e+")"},long:function(){return this.title+" v"+this.toString()+" ("+this.date.toUTCString()+")"}}),TempState={},TempVariables={},macros={},postdisplay={},postrender={},predisplay={},prehistory={},prerender={},session=null,settings={},setup={},storage=null,browser=Browser,config=Config,has=Has,History=State,state=State,tale=Story;window.SugarCube={},jQuery(function(){try{document.normalize&&document.normalize(),Story.load(),storage=new KeyValueStore("webStorage",!0,Story.domId),session=new KeyValueStore("webStorage",!1,Story.domId),Dialog.init(),UI.init(),Story.init(),L10n.init(),session.has("rcWarn")||"cookie"!==storage.name||(session.set("rcWarn",1),window.alert(L10n.get("warningNoWebStorage"))),Save.init(),Setting.init(),Macro.init(),Engine.start(),UI.start(),window.SugarCube={Browser:Browser,Config:Config,Dialog:Dialog,DebugView:DebugView,Engine:Engine,Has:Has,L10n:L10n,Macro:Macro,Passage:Passage,Save:Save,Scripting:Scripting,Setting:Setting,SimpleAudio:SimpleAudio,State:State,Story:Story,TempVariables:TempVariables,UI:UI,Util:Util,Wikifier:Wikifier,macros:macros,session:session,settings:settings,setup:setup,storage:storage,version:version}}catch(e){return jQuery(document).off("readystatechange.SugarCube"),Alert.fatal(null,e.message,e)}})}(window,window.document,jQuery);}
	</script>
</body>
</html>
